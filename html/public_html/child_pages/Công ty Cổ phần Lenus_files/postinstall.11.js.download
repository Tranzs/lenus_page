var Ne=Object.defineProperty;var ke=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var Te=(e,t,r)=>t in e?Ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,he=(e,t)=>{for(var r in t||(t={}))Ce.call(t,r)&&Te(e,r,t[r]);if(ke)for(var r of ke(t))je.call(t,r)&&Te(e,r,t[r]);return e};var Ve=(e,t)=>{var r={};for(var a in e)Ce.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&ke)for(var a of ke(e))t.indexOf(a)<0&&je.call(e,a)&&(r[a]=e[a]);return r};(function(e){typeof define=="function"&&define.amd?define(e):e()})(function(){"use strict";(function(e){typeof exports=="object"&&typeof module!="undefined"?module.exports=e():typeof define=="function"&&define.amd?define([],e):(typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this).Localbase=e()})(function(){return function e(t,r,a){function n(s,h){if(!r[s]){if(!t[s]){var p=typeof require=="function"&&require;if(!h&&p)return p(s,!0);if(l)return l(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var y=r[s]={exports:{}};t[s][0].call(y.exports,function(g){return n(t[s][1][g]||g)},y,y.exports,e,t,r,a)}return r[s].exports}for(var l=typeof require=="function"&&require,f=0;f<a.length;f++)n(a[f]);return n}({1:[function(e,t,r){var a;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=((a=e(16))&&a.__esModule?a:{default:a}).default;r.default=n,t.exports=r.default},{16:16}],2:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(f){return n.default.call(this),a.default.error.call(this,f),"Error: ".concat(f)};var a=l(e(18)),n=l(e(3));function l(f){return f&&f.__esModule?f:{default:f}}t.exports=r.default},{18:18,3:3}],3:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){this.collectionName=null,this.orderByProperty=null,this.orderByDirection=null,this.limitBy=null,this.docSelectionCriteria=null,this.userErrors=[]},t.exports=r.default},{}],4:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){var a;return this.collectionName||this.docSelectionCriteria?this.collectionName&&!this.docSelectionCriteria?a="collection":this.collectionName&&this.docSelectionCriteria&&(a="doc"):a="db",a},t.exports=r.default},{}],5:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){for(var f=0;f<this.userErrors.length;f++)a.default.error.call(this,this.userErrors[f]);n.default.call(this)};var a=l(e(18)),n=l(e(3));function l(f){return f&&f.__esModule?f:{default:f}}t.exports=r.default},{18:18,3:3}],6:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(f,s){return n.default.call(this),a.default.log.call(this,f,s),"Success: ".concat(f," ").concat(JSON.stringify(s))};var a=l(e(18)),n=l(e(3));function l(f){return f&&f.__esModule?f:{default:f}}t.exports=r.default},{18:18,3:3}],7:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(h,p){var d,y=this;if(h?(d=h,(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k})(d)=="object"&&h instanceof Array==0||this.userErrors.push("Data passed to .add() must be an object. Not an array, string, number or boolean.")):this.userErrors.push('No data specified in add() method. You must use an object, e.g { id: 1, name: "Bill", age: 47 }'),!this.userErrors.length){var g=this.collectionName;return new Promise(function(k,A){var M;return M=p||s.generate(),y.lf[g].setItem(M,h).then(function(){k(a.default.call(y,'Document added to "'.concat(g,'" collection:'),{key:M,data:h}))}).catch(function(N){A(n.default.call(y,"Could not add Document to ".concat(g," collection.")))})})}l.default.call(this)};var a=f(e(6)),n=f(e(2)),l=f(e(5));function f(h){return h&&h.__esModule?h:{default:h}}var s=e(21);t.exports=r.default},{2:2,21:21,5:5,6:6}],8:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){var d=this;return new Promise(function(y,g){if(d.deleteDatabase=function(){var A=d.dbName;indexedDB.deleteDatabase(A),y(f.default.call(d,'Database "'.concat(A,'" deleted.')))},d.deleteCollection=function(){var A=d.dbName,M=d.collectionName;d.addToDeleteCollectionQueue=function(N){d.deleteCollectionQueue.queue.push(N),d.runDeleteCollectionQueue()},d.runDeleteCollectionQueue=function(){d.deleteCollectionQueue.running==0&&(d.deleteCollectionQueue.running=!0,d.deleteNextCollectionFromQueue())},d.deleteNextCollectionFromQueue=function(){if(d.deleteCollectionQueue.queue.length){var N=d.deleteCollectionQueue.queue[0];d.deleteCollectionQueue.queue.shift(),d.lf[N].dropInstance({name:A,storeName:N}).then(function(){d.deleteNextCollectionFromQueue(),y(f.default.call(d,'Collection "'.concat(N,'" deleted.')))}).catch(function(S){g(S.call(d,'Collection "'.concat(N,'" could not be deleted.')))})}else d.deleteCollectionQueue.running=!1},d.addToDeleteCollectionQueue(M)},d.deleteDocument=function(){var A,M=d.collectionName,N=d.docSelectionCriteria;return d.deleteDocumentByCriteria=function(){var S=[];d.lf[M].iterate(function(O,_){(0,a.default)(O,N)&&S.push(_)}).then(function(){S.length||g(s.default.call(d,'No Documents found in "'.concat(M,'" Collection with criteria ').concat(JSON.stringify(N),". No documents deleted."))),S.length>1&&n.default.warn.call(d,"Multiple documents (".concat(S.length,") with ").concat(JSON.stringify(N)," found."))}).then(function(){S.forEach(function(O,_){d.lf[M].removeItem(O).then(function(){_===S.length-1&&y(f.default.call(d,"".concat(S.length," Document").concat(S.length>1?"s":""," with ").concat(JSON.stringify(N)," deleted.")))}).catch(function(v){g(s.default.call(d,"Could not delete ".concat(S.length," Documents in ").concat(M," Collection.")))})})})},d.deleteDocumentByKey=function(){d.lf[M].getItem(N).then(function(S){S?d.lf[M].removeItem(N).then(function(){y(f.default.call(d,"Document with key ".concat(JSON.stringify(N)," deleted.")))}).catch(function(O){g(s.default.call(this,'No Document found in "'.concat(M,'" Collection with key ').concat(JSON.stringify(N),". No document was deleted.")))}):g(s.default.call(d,'No Document found in "'.concat(M,'" Collection with key ').concat(JSON.stringify(N),". No document was deleted.")))})},A=N,(typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S})(A)=="object"?d.deleteDocumentByCriteria():d.deleteDocumentByKey()},d.userErrors.length)h.default.call(d);else{var k=l.default.call(d);if(k=="db")return d.deleteDatabase();if(k=="collection")return d.deleteCollection();if(k=="doc")return d.deleteDocument()}})};var a=p(e(17)),n=p(e(18)),l=p(e(4)),f=p(e(6)),s=p(e(2)),h=p(e(5));function p(d){return d&&d.__esModule?d:{default:d}}t.exports=r.default},{17:17,18:18,2:2,4:4,5:5,6:6}],9:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){var d=this,y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{keys:!1};if(this.getCollection=function(){var k=d.collectionName,A=d.orderByProperty,M=d.orderByDirection,N=d.limitBy,S=[];return d.lf[k].iterate(function(O,_){var v;v=y.keys?{key:_,data:O}:O,S.push(v)}).then(function(){var O='Got "'.concat(k,'" collection');return A&&(O+=', ordered by "'.concat(A,'"'),y.keys?S.sort(function(_,v){return _.data[A].toString().localeCompare(v.data[A].toString())}):S.sort(function(_,v){return _[A].toString().localeCompare(v[A].toString())})),M=="desc"&&(O+=" (descending)",S.reverse()),N&&(O+=", limited to ".concat(N),S=S.splice(0,N)),O+=":",n.default.log.call(d,O,S),l.default.call(d),S})},this.getDocument=function(){var k=d.collectionName,A=d.docSelectionCriteria,M=[],N={};return d.getDocumentByCriteria=function(){return d.lf[k].iterate(function(S,O){(0,a.default)(S,A)&&M.push(S)}).then(function(){if(M.length)return N=M[0],n.default.log.call(d,"Got Document with ".concat(JSON.stringify(A),":"),N),l.default.call(d),N;n.default.error.call(d,'Could not find Document in "'.concat(k,'" collection with criteria: ').concat(JSON.stringify(A)))})},d.getDocumentByKey=function(){return d.lf[k].getItem(A).then(function(S){return(N=S)?n.default.log.call(d,"Got Document with key ".concat(JSON.stringify(A),":"),N):n.default.error.call(d,'Could not find Document in "'.concat(k,'" collection with Key: ').concat(JSON.stringify(A))),l.default.call(d),N}).catch(function(S){n.default.error.call(d,'Could not find Document in "'.concat(k,'" collection with Key: ').concat(JSON.stringify(A))),l.default.call(d)})},p(A)=="object"?d.getDocumentByCriteria():d.getDocumentByKey()},p(y)!="object"||y instanceof Array!=0?this.userErrors.push('Data passed to .get() must be an object. Not an array, string, number or boolean. The object must contain a "keys" property set to true or false, e.g. { keys: true }'):y.hasOwnProperty("keys")?typeof y.keys!="boolean"&&this.userErrors.push('Property "keys" passed into get() method must be assigned a boolean value (true or false). Not a string or integer.'):this.userErrors.push('Object passed to get() method must contain a "keys" property set to boolean true or false, e.g. { keys: true }'),this.userErrors.length)return s.default.call(this),null;var g=f.default.call(this);return g=="collection"?this.getCollection():g=="doc"?this.getDocument():void 0};var a=h(e(17)),n=h(e(18)),l=h(e(3)),f=h(e(4)),s=h(e(5));function h(d){return d&&d.__esModule?d:{default:d}}function p(d){return(p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(d)}t.exports=r.default},{17:17,18:18,3:3,4:4,5:5}],10:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(d){var y=this,g=this.collectionName,k=this.docSelectionCriteria;return new Promise(function(A,M){if(y.setDocumentByCriteria=function(){var N=[];y.lf[g].iterate(function(S,O){(0,n.default)(S,k)&&N.push({key:O,newDocument:d})}).then(function(){N.length||M(f.default.call(y,"No Documents found in ".concat(g," Collection with criteria ").concat(JSON.stringify(k),"."))),N.length>1&&a.default.warn.call(y,"Multiple documents (".concat(N.length,") with ").concat(JSON.stringify(k)," found for setting."))}).then(function(){N.forEach(function(S,O){y.lf[g].setItem(S.key,S.newDocument).then(function(_){O===N.length-1&&A(l.default.call(y,"".concat(N.length," Document").concat(N.length>1?"s":"",' in "').concat(g,'" collection with ').concat(JSON.stringify(k)," set to:"),d))}).catch(function(_){M(f.default.call(y,"Could not set ".concat(N.length," Documents in ").concat(g," Collection.")))})})})},y.setDocumentByKey=function(){y.lf[g].setItem(k,d).then(function(N){A(l.default.call(y,'Document in "'.concat(g,'" collection with key ').concat(JSON.stringify(k)," set to:"),d))}).catch(function(N){M(f.default.call(y,'Document in "'.concat(g,'" collection with key ').concat(JSON.stringify(k)," could not be set.")))})},d?p(d)=="object"&&d instanceof Array==0||y.userErrors.push("Data passed to .set() must be an object. Not an array, string, number or boolean."):y.userErrors.push('No new Document object provided to set() method. Use an object e.g. { id: 1, name: "Bill", age: 47 }'),!y.userErrors.length)return p(k)=="object"?y.setDocumentByCriteria():y.setDocumentByKey();s.default.call(y)})};var a=h(e(18)),n=h(e(17)),l=h(e(6)),f=h(e(2)),s=h(e(5));function h(d){return d&&d.__esModule?d:{default:d}}function p(d){return(p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(d)}t.exports=r.default},{17:17,18:18,2:2,5:5,6:6}],11:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(y){var g=this,k=this.collectionName,A=this.docSelectionCriteria;return new Promise(function(M,N){g.updateDocumentByCriteria=function(){var S=[];g.lf[k].iterate(function(O,_){if((0,n.default)(O,A)){var v=(0,l.default)(O,y);S.push({key:_,newDocument:v})}}).then(function(){S.length||N(s.default.call(g,"No Documents found in ".concat(k," Collection with criteria ").concat(JSON.stringify(A),"."))),S.length>1&&a.default.warn.call(g,"Multiple documents (".concat(S.length,") with ").concat(JSON.stringify(A)," found for updating."))}).then(function(){S.forEach(function(O,_){g.lf[k].setItem(O.key,O.newDocument).then(function(v){_===S.length-1&&M(f.default.call(g,"".concat(S.length," Document").concat(S.length>1?"s":"",' in "').concat(k,'" collection with ').concat(JSON.stringify(A)," updated with:"),y))}).catch(function(v){N(s.default.call(g,"Could not update ".concat(S.length," Documents in ").concat(k," Collection.")))})})})},g.updateDocumentByKey=function(){var S={};g.lf[k].getItem(A).then(function(O){S=(0,l.default)(O,y),g.lf[k].setItem(A,S),M(f.default.call(g,'Document in "'.concat(k,'" collection with key ').concat(JSON.stringify(A)," updated to:"),S))}).catch(function(O){N(s.default.call(g,'No Document found in "'.concat(k,'" collection with key ').concat(JSON.stringify(A))))})},y?d(y)=="object"&&y instanceof Array==0||g.userErrors.push("Data passed to .update() must be an object. Not an array, string, number or boolean."):g.userErrors.push('No update object provided to update() method. Use an object e.g. { name: "William" }'),g.userErrors.length?h.default.call(g):d(A)=="object"?g.updateDocumentByCriteria():g.updateDocumentByKey()})};var a=p(e(18)),n=p(e(17)),l=p(e(19)),f=p(e(6)),s=p(e(2)),h=p(e(5));function p(y){return y&&y.__esModule?y:{default:y}}function d(y){return(d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(y)}t.exports=r.default},{17:17,18:18,19:19,2:2,5:5,6:6}],12:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(a){return a?Number.isInteger(a)?this.limitBy=a:this.userErrors.push("Limit parameter in limit() method must be an integer (e.g. 3) and not a float, boolean, string or object."):this.userErrors.push("No integer specified in limit() method."),this},t.exports=r.default},{}],13:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(a,n){return a?typeof a!="string"?this.userErrors.push("First parameter in orderBy() method must be a string (a field name) e.g. 'name'"):this.orderByProperty=a:this.userErrors.push("No field name specified in orderBy() method. Use a string e.g. 'name'"),n&&(n!=="asc"&&n!=="desc"?this.userErrors.push("Second parameter in orderBy() method must be a string set to 'asc' or 'desc'."):this.orderByDirection=n),this},t.exports=r.default},{}],14:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(l){if(l){if(typeof l!="string")return this.userErrors.push("Collection name in collection() method must be a string and not an object, number or boolean."),this;this.collectionName=l;var f=this.dbName;return l in this.lf||(this.lf[l]=n.default.createInstance({driver:n.default.INDEXEDDB,name:f,storeName:l})),this}return this.userErrors.push("No collection name specified in collection() method."),this};var a,n=(a=e(20))&&a.__esModule?a:{default:a};t.exports=r.default},{20:20}],15:[function(e,t,r){function a(n){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(n)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(n){return n?typeof n!="string"&&a(n)!=="object"?this.userErrors.push("Document criteria specified in doc() method must not be a number or boolean. Use a string (with a key) or an object (with criteria) e.g. { id: 1 }"):this.docSelectionCriteria=n:this.userErrors.push("No document criteria specified in doc() method. Use a string (with a key) or an object (with criteria) e.g. { id: 1 }"),this},t.exports=r.default},{}],16:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=g(e(14)),n=g(e(15)),l=g(e(13)),f=g(e(12)),s=g(e(9)),h=g(e(7)),p=g(e(11)),d=g(e(10)),y=g(e(8));function g(k){return k&&k.__esModule?k:{default:k}}r.default=function k(A){(function(M,N){if(!(M instanceof N))throw new TypeError("Cannot call a class as a function")})(this,k),this.dbName=A,this.lf={},this.collectionName=null,this.orderByProperty=null,this.orderByDirection=null,this.limitBy=null,this.docSelectionCriteria=null,this.deleteCollectionQueue={queue:[],running:!1},this.config={debug:!0},this.userErrors=[],this.collection=a.default.bind(this),this.doc=n.default.bind(this),this.orderBy=l.default.bind(this),this.limit=f.default.bind(this),this.get=s.default.bind(this),this.add=h.default.bind(this),this.update=p.default.bind(this),this.set=d.default.bind(this),this.delete=y.default.bind(this)},t.exports=r.default},{10:10,11:11,12:12,13:13,14:14,15:15,7:7,8:8,9:9}],17:[function(e,t,r){function a(n){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(n)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function n(l,f){return Object.keys(f).every(function(s){return a(f[s])=="object"?n(l[s],f[s]):f[s]===l[s]})},t.exports=r.default},{}],18:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a={baseStyle:`
    padding: 2px 5px;
    background-color: #124F5C;
    border-radius: 4px;
    color: white; 
  `,colors:{log:"#124F5C",error:"#ed2939",warn:"#f39c12"},log:function(n,l){},error:function(n,l){},warn:function(n,l){}};r.default=a,t.exports=r.default},{}],19:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(a){for(var n=1;n<arguments.length;n++)for(var l in arguments[n]){var f=arguments[n][l];a[l]=f}return a},t.exports=r.default},{}],20:[function(e,t,r){(function(a){(function(n){typeof r=="object"&&t!==void 0?t.exports=n():(typeof window!="undefined"?window:a!==void 0?a:typeof self!="undefined"?self:this).localforage=n()})(function(){return function n(l,f,s){function h(y,g){if(!f[y]){if(!l[y]){var k=typeof e=="function"&&e;if(!g&&k)return k(y,!0);if(p)return p(y,!0);var A=new Error("Cannot find module '"+y+"'");throw A.code="MODULE_NOT_FOUND",A}var M=f[y]={exports:{}};l[y][0].call(M.exports,function(N){return h(l[y][1][N]||N)},M,M.exports,n,l,f,s)}return f[y].exports}for(var p=typeof e=="function"&&e,d=0;d<s.length;d++)h(s[d]);return h}({1:[function(n,l,f){(function(s){var h,p,d=s.MutationObserver||s.WebKitMutationObserver;if(d){var y=0,g=new d(N),k=s.document.createTextNode("");g.observe(k,{characterData:!0}),h=function(){k.data=y=++y%2}}else if(s.setImmediate||s.MessageChannel===void 0)h="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var S=s.document.createElement("script");S.onreadystatechange=function(){N(),S.onreadystatechange=null,S.parentNode.removeChild(S),S=null},s.document.documentElement.appendChild(S)}:function(){setTimeout(N,0)};else{var A=new s.MessageChannel;A.port1.onmessage=N,h=function(){A.port2.postMessage(0)}}var M=[];function N(){var S,O;p=!0;for(var _=M.length;_;){for(O=M,M=[],S=-1;++S<_;)O[S]();_=M.length}p=!1}l.exports=function(S){M.push(S)!==1||p||h()}}).call(this,a!==void 0?a:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(n,l,f){var s=n(1);function h(){}var p={},d=["REJECTED"],y=["FULFILLED"],g=["PENDING"];function k(_){if(typeof _!="function")throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,_!==h&&S(this,_)}function A(_,v,C){this.promise=_,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}function M(_,v,C){s(function(){var F;try{F=v(C)}catch(P){return p.reject(_,P)}F===_?p.reject(_,new TypeError("Cannot resolve promise with itself")):p.resolve(_,F)})}function N(_){var v=_&&_.then;if(_&&(typeof _=="object"||typeof _=="function")&&typeof v=="function")return function(){v.apply(_,arguments)}}function S(_,v){var C=!1;function F(U){C||(C=!0,p.reject(_,U))}function P(U){C||(C=!0,p.resolve(_,U))}var R=O(function(){v(P,F)});R.status==="error"&&F(R.value)}function O(_,v){var C={};try{C.value=_(v),C.status="success"}catch(F){C.status="error",C.value=F}return C}l.exports=k,k.prototype.catch=function(_){return this.then(null,_)},k.prototype.then=function(_,v){if(typeof _!="function"&&this.state===y||typeof v!="function"&&this.state===d)return this;var C=new this.constructor(h);return this.state!==g?M(C,this.state===y?_:v,this.outcome):this.queue.push(new A(C,_,v)),C},A.prototype.callFulfilled=function(_){p.resolve(this.promise,_)},A.prototype.otherCallFulfilled=function(_){M(this.promise,this.onFulfilled,_)},A.prototype.callRejected=function(_){p.reject(this.promise,_)},A.prototype.otherCallRejected=function(_){M(this.promise,this.onRejected,_)},p.resolve=function(_,v){var C=O(N,v);if(C.status==="error")return p.reject(_,C.value);var F=C.value;if(F)S(_,F);else{_.state=y,_.outcome=v;for(var P=-1,R=_.queue.length;++P<R;)_.queue[P].callFulfilled(v)}return _},p.reject=function(_,v){_.state=d,_.outcome=v;for(var C=-1,F=_.queue.length;++C<F;)_.queue[C].callRejected(v);return _},k.resolve=function(_){return _ instanceof this?_:p.resolve(new this(h),_)},k.reject=function(_){var v=new this(h);return p.reject(v,_)},k.all=function(_){var v=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=_.length,F=!1;if(!C)return this.resolve([]);for(var P=new Array(C),R=0,U=-1,Y=new this(h);++U<C;)ee(_[U],U);return Y;function ee(G,ce){v.resolve(G).then(function(W){P[ce]=W,++R!==C||F||(F=!0,p.resolve(Y,P))},function(W){F||(F=!0,p.reject(Y,W))})}},k.race=function(_){if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=_.length,C=!1;if(!v)return this.resolve([]);for(var F,P=-1,R=new this(h);++P<v;)F=_[P],this.resolve(F).then(function(U){C||(C=!0,p.resolve(R,U))},function(U){C||(C=!0,p.reject(R,U))});return R}},{1:1}],3:[function(n,l,f){(function(s){typeof s.Promise!="function"&&(s.Promise=n(2))}).call(this,a!==void 0?a:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(n,l,f){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},h=function(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch{return}}();function p(m,b){m=m||[],b=b||{};try{return new Blob(m,b)}catch(j){if(j.name!=="TypeError")throw j;for(var w=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder),D=0;D<m.length;D+=1)w.append(m[D]);return w.getBlob(b.type)}}typeof Promise=="undefined"&&n(3);var d=Promise;function y(m,b){b&&m.then(function(w){b(null,w)},function(w){b(w)})}function g(m,b,w){typeof b=="function"&&m.then(b),typeof w=="function"&&m.catch(w)}function k(m){return typeof m!="string"&&(console.warn(m+" used as a key, but it is not a string."),m=String(m)),m}function A(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var M=void 0,N={},S=Object.prototype.toString;function O(m){var b=N[m.name],w={};w.promise=new d(function(D,j){w.resolve=D,w.reject=j}),b.deferredOperations.push(w),b.dbReady?b.dbReady=b.dbReady.then(function(){return w.promise}):b.dbReady=w.promise}function _(m){var b=N[m.name].deferredOperations.pop();if(b)return b.resolve(),b.promise}function v(m,b){var w=N[m.name].deferredOperations.pop();if(w)return w.reject(b),w.promise}function C(m,b){return new d(function(w,D){if(N[m.name]=N[m.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},m.db){if(!b)return w(m.db);O(m),m.db.close()}var j=[m.name];b&&j.push(m.version);var V=h.open.apply(h,j);b&&(V.onupgradeneeded=function(q){var L=V.result;try{L.createObjectStore(m.storeName),q.oldVersion<=1&&L.createObjectStore("local-forage-detect-blob-support")}catch(E){if(E.name!=="ConstraintError")throw E;console.warn('The database "'+m.name+'" has been upgraded from version '+q.oldVersion+" to version "+q.newVersion+', but the storage "'+m.storeName+'" already exists.')}}),V.onerror=function(q){q.preventDefault(),D(V.error)},V.onsuccess=function(){w(V.result),_(m)}})}function F(m){return C(m,!1)}function P(m){return C(m,!0)}function R(m,b){if(!m.db)return!0;var w=!m.db.objectStoreNames.contains(m.storeName),D=m.version<m.db.version,j=m.version>m.db.version;if(D&&(m.version!==b&&console.warn('The database "'+m.name+`" can't be downgraded from version `+m.db.version+" to version "+m.version+"."),m.version=m.db.version),j||w){if(w){var V=m.db.version+1;V>m.version&&(m.version=V)}return!0}return!1}function U(m){return p([function(b){for(var w=b.length,D=new ArrayBuffer(w),j=new Uint8Array(D),V=0;V<w;V++)j[V]=b.charCodeAt(V);return D}(atob(m.data))],{type:m.type})}function Y(m){return m&&m.__local_forage_encoded_blob}function ee(m){var b=this,w=b._initReady().then(function(){var D=N[b._dbInfo.name];if(D&&D.dbReady)return D.dbReady});return g(w,m,m),w}function G(m,b,w,D){D===void 0&&(D=1);try{var j=m.db.transaction(m.storeName,b);w(null,j)}catch(V){if(D>0&&(!m.db||V.name==="InvalidStateError"||V.name==="NotFoundError"))return d.resolve().then(function(){if(!m.db||V.name==="NotFoundError"&&!m.db.objectStoreNames.contains(m.storeName)&&m.version<=m.db.version)return m.db&&(m.version=m.db.version+1),P(m)}).then(function(){return function(q){O(q);for(var L=N[q.name],E=L.forages,$=0;$<E.length;$++){var X=E[$];X._dbInfo.db&&(X._dbInfo.db.close(),X._dbInfo.db=null)}return q.db=null,F(q).then(function(J){return q.db=J,R(q)?P(q):J}).then(function(J){q.db=L.db=J;for(var Z=0;Z<E.length;Z++)E[Z]._dbInfo.db=J}).catch(function(J){throw v(q,J),J})}(m).then(function(){G(m,b,w,D-1)})}).catch(w);w(V)}}var ce={_driver:"asyncStorage",_initStorage:function(m){var b=this,w={db:null};if(m)for(var D in m)w[D]=m[D];var j=N[w.name];j||(j={forages:[],db:null,dbReady:null,deferredOperations:[]},N[w.name]=j),j.forages.push(b),b._initReady||(b._initReady=b.ready,b.ready=ee);var V=[];function q(){return d.resolve()}for(var L=0;L<j.forages.length;L++){var E=j.forages[L];E!==b&&V.push(E._initReady().catch(q))}var $=j.forages.slice(0);return d.all(V).then(function(){return w.db=j.db,F(w)}).then(function(X){return w.db=X,R(w,b._defaultConfig.version)?P(w):X}).then(function(X){w.db=j.db=X,b._dbInfo=w;for(var J=0;J<$.length;J++){var Z=$[J];Z!==b&&(Z._dbInfo.db=w.db,Z._dbInfo.version=w.version)}})},_support:function(){try{if(!h||!h.open)return!1;var m=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),b=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!m||b)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch{return!1}}(),iterate:function(m,b){var w=this,D=new d(function(j,V){w.ready().then(function(){G(w._dbInfo,"readonly",function(q,L){if(q)return V(q);try{var E=L.objectStore(w._dbInfo.storeName).openCursor(),$=1;E.onsuccess=function(){var X=E.result;if(X){var J=X.value;Y(J)&&(J=U(J));var Z=m(J,X.key,$++);Z!==void 0?j(Z):X.continue()}else j()},E.onerror=function(){V(E.error)}}catch(X){V(X)}})}).catch(V)});return y(D,b),D},getItem:function(m,b){var w=this;m=k(m);var D=new d(function(j,V){w.ready().then(function(){G(w._dbInfo,"readonly",function(q,L){if(q)return V(q);try{var E=L.objectStore(w._dbInfo.storeName).get(m);E.onsuccess=function(){var $=E.result;$===void 0&&($=null),Y($)&&($=U($)),j($)},E.onerror=function(){V(E.error)}}catch($){V($)}})}).catch(V)});return y(D,b),D},setItem:function(m,b,w){var D=this;m=k(m);var j=new d(function(V,q){var L;D.ready().then(function(){return L=D._dbInfo,S.call(b)==="[object Blob]"?function(E){return typeof M=="boolean"?d.resolve(M):function($){return new d(function(X){var J=$.transaction("local-forage-detect-blob-support","readwrite"),Z=p([""]);J.objectStore("local-forage-detect-blob-support").put(Z,"key"),J.onabort=function(oe){oe.preventDefault(),oe.stopPropagation(),X(!1)},J.oncomplete=function(){var oe=navigator.userAgent.match(/Chrome\/(\d+)/),me=navigator.userAgent.match(/Edge\//);X(me||!oe||parseInt(oe[1],10)>=43)}}).catch(function(){return!1})}(E).then(function($){return M=$})}(L.db).then(function(E){return E?b:($=b,new d(function(X,J){var Z=new FileReader;Z.onerror=J,Z.onloadend=function(oe){var me=btoa(oe.target.result||"");X({__local_forage_encoded_blob:!0,data:me,type:$.type})},Z.readAsBinaryString($)}));var $}):b}).then(function(E){G(D._dbInfo,"readwrite",function($,X){if($)return q($);try{var J=X.objectStore(D._dbInfo.storeName);E===null&&(E=void 0);var Z=J.put(E,m);X.oncomplete=function(){E===void 0&&(E=null),V(E)},X.onabort=X.onerror=function(){var oe=Z.error?Z.error:Z.transaction.error;q(oe)}}catch(oe){q(oe)}})}).catch(q)});return y(j,w),j},removeItem:function(m,b){var w=this;m=k(m);var D=new d(function(j,V){w.ready().then(function(){G(w._dbInfo,"readwrite",function(q,L){if(q)return V(q);try{var E=L.objectStore(w._dbInfo.storeName).delete(m);L.oncomplete=function(){j()},L.onerror=function(){V(E.error)},L.onabort=function(){var $=E.error?E.error:E.transaction.error;V($)}}catch($){V($)}})}).catch(V)});return y(D,b),D},clear:function(m){var b=this,w=new d(function(D,j){b.ready().then(function(){G(b._dbInfo,"readwrite",function(V,q){if(V)return j(V);try{var L=q.objectStore(b._dbInfo.storeName).clear();q.oncomplete=function(){D()},q.onabort=q.onerror=function(){var E=L.error?L.error:L.transaction.error;j(E)}}catch(E){j(E)}})}).catch(j)});return y(w,m),w},length:function(m){var b=this,w=new d(function(D,j){b.ready().then(function(){G(b._dbInfo,"readonly",function(V,q){if(V)return j(V);try{var L=q.objectStore(b._dbInfo.storeName).count();L.onsuccess=function(){D(L.result)},L.onerror=function(){j(L.error)}}catch(E){j(E)}})}).catch(j)});return y(w,m),w},key:function(m,b){var w=this,D=new d(function(j,V){m<0?j(null):w.ready().then(function(){G(w._dbInfo,"readonly",function(q,L){if(q)return V(q);try{var E=L.objectStore(w._dbInfo.storeName),$=!1,X=E.openKeyCursor();X.onsuccess=function(){var J=X.result;J?m===0||$?j(J.key):($=!0,J.advance(m)):j(null)},X.onerror=function(){V(X.error)}}catch(J){V(J)}})}).catch(V)});return y(D,b),D},keys:function(m){var b=this,w=new d(function(D,j){b.ready().then(function(){G(b._dbInfo,"readonly",function(V,q){if(V)return j(V);try{var L=q.objectStore(b._dbInfo.storeName).openKeyCursor(),E=[];L.onsuccess=function(){var $=L.result;$?(E.push($.key),$.continue()):D(E)},L.onerror=function(){j(L.error)}}catch($){j($)}})}).catch(j)});return y(w,m),w},dropInstance:function(m,b){b=A.apply(this,arguments);var w,D=this.config();if((m=typeof m!="function"&&m||{}).name||(m.name=m.name||D.name,m.storeName=m.storeName||D.storeName),m.name){var j=m.name===D.name&&this._dbInfo.db?d.resolve(this._dbInfo.db):F(m).then(function(V){var q=N[m.name],L=q.forages;q.db=V;for(var E=0;E<L.length;E++)L[E]._dbInfo.db=V;return V});w=m.storeName?j.then(function(V){if(V.objectStoreNames.contains(m.storeName)){var q=V.version+1;O(m);var L=N[m.name],E=L.forages;V.close();for(var $=0;$<E.length;$++){var X=E[$];X._dbInfo.db=null,X._dbInfo.version=q}return new d(function(J,Z){var oe=h.open(m.name,q);oe.onerror=function(me){oe.result.close(),Z(me)},oe.onupgradeneeded=function(){oe.result.deleteObjectStore(m.storeName)},oe.onsuccess=function(){var me=oe.result;me.close(),J(me)}}).then(function(J){L.db=J;for(var Z=0;Z<E.length;Z++){var oe=E[Z];oe._dbInfo.db=J,_(oe._dbInfo)}}).catch(function(J){throw(v(m,J)||d.resolve()).catch(function(){}),J})}}):j.then(function(V){O(m);var q=N[m.name],L=q.forages;V.close();for(var E=0;E<L.length;E++)L[E]._dbInfo.db=null;return new d(function($,X){var J=h.deleteDatabase(m.name);J.onerror=J.onblocked=function(Z){var oe=J.result;oe&&oe.close(),X(Z)},J.onsuccess=function(){var Z=J.result;Z&&Z.close(),$(Z)}}).then(function($){q.db=$;for(var X=0;X<L.length;X++)_(L[X]._dbInfo)}).catch(function($){throw(v(m,$)||d.resolve()).catch(function(){}),$})})}else w=d.reject("Invalid arguments");return y(w,b),w}},W="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",se=/^~~local_forage_type~([^~]+)~/,ge=9,z=ge+4,K=Object.prototype.toString;function le(m){var b,w,D,j,V,q=.75*m.length,L=m.length,E=0;m[m.length-1]==="="&&(q--,m[m.length-2]==="="&&q--);var $=new ArrayBuffer(q),X=new Uint8Array($);for(b=0;b<L;b+=4)w=W.indexOf(m[b]),D=W.indexOf(m[b+1]),j=W.indexOf(m[b+2]),V=W.indexOf(m[b+3]),X[E++]=w<<2|D>>4,X[E++]=(15&D)<<4|j>>2,X[E++]=(3&j)<<6|63&V;return $}function ie(m){var b,w=new Uint8Array(m),D="";for(b=0;b<w.length;b+=3)D+=W[w[b]>>2],D+=W[(3&w[b])<<4|w[b+1]>>4],D+=W[(15&w[b+1])<<2|w[b+2]>>6],D+=W[63&w[b+2]];return w.length%3==2?D=D.substring(0,D.length-1)+"=":w.length%3==1&&(D=D.substring(0,D.length-2)+"=="),D}var re={serialize:function(m,b){var w="";if(m&&(w=K.call(m)),m&&(w==="[object ArrayBuffer]"||m.buffer&&K.call(m.buffer)==="[object ArrayBuffer]")){var D,j="__lfsc__:";m instanceof ArrayBuffer?(D=m,j+="arbf"):(D=m.buffer,w==="[object Int8Array]"?j+="si08":w==="[object Uint8Array]"?j+="ui08":w==="[object Uint8ClampedArray]"?j+="uic8":w==="[object Int16Array]"?j+="si16":w==="[object Uint16Array]"?j+="ur16":w==="[object Int32Array]"?j+="si32":w==="[object Uint32Array]"?j+="ui32":w==="[object Float32Array]"?j+="fl32":w==="[object Float64Array]"?j+="fl64":b(new Error("Failed to get type for BinaryArray"))),b(j+ie(D))}else if(w==="[object Blob]"){var V=new FileReader;V.onload=function(){var q="~~local_forage_type~"+m.type+"~"+ie(this.result);b("__lfsc__:blob"+q)},V.readAsArrayBuffer(m)}else try{b(JSON.stringify(m))}catch(q){console.error("Couldn't convert value into a JSON string: ",m),b(null,q)}},deserialize:function(m){if(m.substring(0,ge)!=="__lfsc__:")return JSON.parse(m);var b,w=m.substring(z),D=m.substring(ge,z);if(D==="blob"&&se.test(w)){var j=w.match(se);b=j[1],w=w.substring(j[0].length)}var V=le(w);switch(D){case"arbf":return V;case"blob":return p([V],{type:b});case"si08":return new Int8Array(V);case"ui08":return new Uint8Array(V);case"uic8":return new Uint8ClampedArray(V);case"si16":return new Int16Array(V);case"ur16":return new Uint16Array(V);case"si32":return new Int32Array(V);case"ui32":return new Uint32Array(V);case"fl32":return new Float32Array(V);case"fl64":return new Float64Array(V);default:throw new Error("Unkown type: "+D)}},stringToBuffer:le,bufferToString:ie};function H(m,b,w,D){m.executeSql("CREATE TABLE IF NOT EXISTS "+b.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],w,D)}function ae(m,b,w,D,j,V){m.executeSql(w,D,j,function(q,L){L.code===L.SYNTAX_ERR?q.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[b.storeName],function(E,$){$.rows.length?V(E,L):H(E,b,function(){E.executeSql(w,D,j,V)},V)},V):V(q,L)},V)}var pe={_driver:"webSQLStorage",_initStorage:function(m){var b=this,w={db:null};if(m)for(var D in m)w[D]=typeof m[D]!="string"?m[D].toString():m[D];var j=new d(function(V,q){try{w.db=openDatabase(w.name,String(w.version),w.description,w.size)}catch(L){return q(L)}w.db.transaction(function(L){H(L,w,function(){b._dbInfo=w,V()},function(E,$){q($)})},q)});return w.serializer=re,j},_support:typeof openDatabase=="function",iterate:function(m,b){var w=this,D=new d(function(j,V){w.ready().then(function(){var q=w._dbInfo;q.db.transaction(function(L){ae(L,q,"SELECT * FROM "+q.storeName,[],function(E,$){for(var X=$.rows,J=X.length,Z=0;Z<J;Z++){var oe=X.item(Z),me=oe.value;if(me&&(me=q.serializer.deserialize(me)),(me=m(me,oe.key,Z+1))!==void 0)return void j(me)}j()},function(E,$){V($)})})}).catch(V)});return y(D,b),D},getItem:function(m,b){var w=this;m=k(m);var D=new d(function(j,V){w.ready().then(function(){var q=w._dbInfo;q.db.transaction(function(L){ae(L,q,"SELECT * FROM "+q.storeName+" WHERE key = ? LIMIT 1",[m],function(E,$){var X=$.rows.length?$.rows.item(0).value:null;X&&(X=q.serializer.deserialize(X)),j(X)},function(E,$){V($)})})}).catch(V)});return y(D,b),D},setItem:function(m,b,w){return function D(j,V,q,L){var E=this;j=k(j);var $=new d(function(X,J){E.ready().then(function(){V===void 0&&(V=null);var Z=V,oe=E._dbInfo;oe.serializer.serialize(V,function(me,ve){ve?J(ve):oe.db.transaction(function(we){ae(we,oe,"INSERT OR REPLACE INTO "+oe.storeName+" (key, value) VALUES (?, ?)",[j,me],function(){X(Z)},function(xe,Se){J(Se)})},function(we){if(we.code===we.QUOTA_ERR){if(L>0)return void X(D.apply(E,[j,Z,q,L-1]));J(we)}})})}).catch(J)});return y($,q),$}.apply(this,[m,b,w,1])},removeItem:function(m,b){var w=this;m=k(m);var D=new d(function(j,V){w.ready().then(function(){var q=w._dbInfo;q.db.transaction(function(L){ae(L,q,"DELETE FROM "+q.storeName+" WHERE key = ?",[m],function(){j()},function(E,$){V($)})})}).catch(V)});return y(D,b),D},clear:function(m){var b=this,w=new d(function(D,j){b.ready().then(function(){var V=b._dbInfo;V.db.transaction(function(q){ae(q,V,"DELETE FROM "+V.storeName,[],function(){D()},function(L,E){j(E)})})}).catch(j)});return y(w,m),w},length:function(m){var b=this,w=new d(function(D,j){b.ready().then(function(){var V=b._dbInfo;V.db.transaction(function(q){ae(q,V,"SELECT COUNT(key) as c FROM "+V.storeName,[],function(L,E){var $=E.rows.item(0).c;D($)},function(L,E){j(E)})})}).catch(j)});return y(w,m),w},key:function(m,b){var w=this,D=new d(function(j,V){w.ready().then(function(){var q=w._dbInfo;q.db.transaction(function(L){ae(L,q,"SELECT key FROM "+q.storeName+" WHERE id = ? LIMIT 1",[m+1],function(E,$){var X=$.rows.length?$.rows.item(0).key:null;j(X)},function(E,$){V($)})})}).catch(V)});return y(D,b),D},keys:function(m){var b=this,w=new d(function(D,j){b.ready().then(function(){var V=b._dbInfo;V.db.transaction(function(q){ae(q,V,"SELECT key FROM "+V.storeName,[],function(L,E){for(var $=[],X=0;X<E.rows.length;X++)$.push(E.rows.item(X).key);D($)},function(L,E){j(E)})})}).catch(j)});return y(w,m),w},dropInstance:function(m,b){b=A.apply(this,arguments);var w=this.config();(m=typeof m!="function"&&m||{}).name||(m.name=m.name||w.name,m.storeName=m.storeName||w.storeName);var D,j=this;return y(D=m.name?new d(function(V){var q;q=m.name===w.name?j._dbInfo.db:openDatabase(m.name,"","",0),m.storeName?V({db:q,storeNames:[m.storeName]}):V(function(L){return new d(function(E,$){L.transaction(function(X){X.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(J,Z){for(var oe=[],me=0;me<Z.rows.length;me++)oe.push(Z.rows.item(me).name);E({db:L,storeNames:oe})},function(J,Z){$(Z)})},function(X){$(X)})})}(q))}).then(function(V){return new d(function(q,L){V.db.transaction(function(E){function $(oe){return new d(function(me,ve){E.executeSql("DROP TABLE IF EXISTS "+oe,[],function(){me()},function(we,xe){ve(xe)})})}for(var X=[],J=0,Z=V.storeNames.length;J<Z;J++)X.push($(V.storeNames[J]));d.all(X).then(function(){q()}).catch(function(oe){L(oe)})},function(E){L(E)})})}):d.reject("Invalid arguments"),b),D}};function o(m,b){var w=m.name+"/";return m.storeName!==b.storeName&&(w+=m.storeName+"/"),w}var u={_driver:"localStorageWrapper",_initStorage:function(m){var b={};if(m)for(var w in m)b[w]=m[w];return b.keyPrefix=o(m,this._defaultConfig),!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch{return!0}}()||localStorage.length>0?(this._dbInfo=b,b.serializer=re,d.resolve()):d.reject()},_support:function(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function(m,b){var w=this,D=w.ready().then(function(){for(var j=w._dbInfo,V=j.keyPrefix,q=V.length,L=localStorage.length,E=1,$=0;$<L;$++){var X=localStorage.key($);if(X.indexOf(V)===0){var J=localStorage.getItem(X);if(J&&(J=j.serializer.deserialize(J)),(J=m(J,X.substring(q),E++))!==void 0)return J}}});return y(D,b),D},getItem:function(m,b){var w=this;m=k(m);var D=w.ready().then(function(){var j=w._dbInfo,V=localStorage.getItem(j.keyPrefix+m);return V&&(V=j.serializer.deserialize(V)),V});return y(D,b),D},setItem:function(m,b,w){var D=this;m=k(m);var j=D.ready().then(function(){b===void 0&&(b=null);var V=b;return new d(function(q,L){var E=D._dbInfo;E.serializer.serialize(b,function($,X){if(X)L(X);else try{localStorage.setItem(E.keyPrefix+m,$),q(V)}catch(J){J.name!=="QuotaExceededError"&&J.name!=="NS_ERROR_DOM_QUOTA_REACHED"||L(J),L(J)}})})});return y(j,w),j},removeItem:function(m,b){var w=this;m=k(m);var D=w.ready().then(function(){var j=w._dbInfo;localStorage.removeItem(j.keyPrefix+m)});return y(D,b),D},clear:function(m){var b=this,w=b.ready().then(function(){for(var D=b._dbInfo.keyPrefix,j=localStorage.length-1;j>=0;j--){var V=localStorage.key(j);V.indexOf(D)===0&&localStorage.removeItem(V)}});return y(w,m),w},length:function(m){var b=this.keys().then(function(w){return w.length});return y(b,m),b},key:function(m,b){var w=this,D=w.ready().then(function(){var j,V=w._dbInfo;try{j=localStorage.key(m)}catch{j=null}return j&&(j=j.substring(V.keyPrefix.length)),j});return y(D,b),D},keys:function(m){var b=this,w=b.ready().then(function(){for(var D=b._dbInfo,j=localStorage.length,V=[],q=0;q<j;q++){var L=localStorage.key(q);L.indexOf(D.keyPrefix)===0&&V.push(L.substring(D.keyPrefix.length))}return V});return y(w,m),w},dropInstance:function(m,b){if(b=A.apply(this,arguments),!(m=typeof m!="function"&&m||{}).name){var w=this.config();m.name=m.name||w.name,m.storeName=m.storeName||w.storeName}var D,j=this;return y(D=m.name?new d(function(V){m.storeName?V(o(m,j._defaultConfig)):V(m.name+"/")}).then(function(V){for(var q=localStorage.length-1;q>=0;q--){var L=localStorage.key(q);L.indexOf(V)===0&&localStorage.removeItem(L)}}):d.reject("Invalid arguments"),b),D}},c=function(m,b){for(var w,D,j=m.length,V=0;V<j;){if((w=m[V])===(D=b)||typeof w=="number"&&typeof D=="number"&&isNaN(w)&&isNaN(D))return!0;V++}return!1},T=Array.isArray||function(m){return Object.prototype.toString.call(m)==="[object Array]"},I={},B={},Q={INDEXEDDB:ce,WEBSQL:pe,LOCALSTORAGE:u},ne=[Q.INDEXEDDB._driver,Q.WEBSQL._driver,Q.LOCALSTORAGE._driver],de=["dropInstance"],fe=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(de),ue={description:"",driver:ne.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function be(m,b){m[b]=function(){var w=arguments;return m.ready().then(function(){return m[b].apply(m,w)})}}function ye(){for(var m=1;m<arguments.length;m++){var b=arguments[m];if(b)for(var w in b)b.hasOwnProperty(w)&&(T(b[w])?arguments[0][w]=b[w].slice():arguments[0][w]=b[w])}return arguments[0]}var _e=new(function(){function m(b){for(var w in function(V,q){if(!(V instanceof q))throw new TypeError("Cannot call a class as a function")}(this,m),Q)if(Q.hasOwnProperty(w)){var D=Q[w],j=D._driver;this[w]=j,I[j]||this.defineDriver(D)}this._defaultConfig=ye({},ue),this._config=ye({},this._defaultConfig,b),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return m.prototype.config=function(b){if((b===void 0?"undefined":s(b))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var w in b){if(w==="storeName"&&(b[w]=b[w].replace(/\W/g,"_")),w==="version"&&typeof b[w]!="number")return new Error("Database version must be a number.");this._config[w]=b[w]}return!("driver"in b&&b.driver)||this.setDriver(this._config.driver)}return typeof b=="string"?this._config[b]:this._config},m.prototype.defineDriver=function(b,w,D){var j=new d(function(V,q){try{var L=b._driver,E=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!b._driver)return void q(E);for(var $=fe.concat("_initStorage"),X=0,J=$.length;X<J;X++){var Z=$[X];if((!c(de,Z)||b[Z])&&typeof b[Z]!="function")return void q(E)}(function(){for(var me=function(Se){return function(){var Oe=new Error("Method "+Se+" is not implemented by the current driver"),Ae=d.reject(Oe);return y(Ae,arguments[arguments.length-1]),Ae}},ve=0,we=de.length;ve<we;ve++){var xe=de[ve];b[xe]||(b[xe]=me(xe))}})();var oe=function(me){I[L]&&console.info("Redefining LocalForage driver: "+L),I[L]=b,B[L]=me,V()};"_support"in b?b._support&&typeof b._support=="function"?b._support().then(oe,q):oe(!!b._support):oe(!0)}catch(me){q(me)}});return g(j,w,D),j},m.prototype.driver=function(){return this._driver||null},m.prototype.getDriver=function(b,w,D){var j=I[b]?d.resolve(I[b]):d.reject(new Error("Driver not found."));return g(j,w,D),j},m.prototype.getSerializer=function(b){var w=d.resolve(re);return g(w,b),w},m.prototype.ready=function(b){var w=this,D=w._driverSet.then(function(){return w._ready===null&&(w._ready=w._initDriver()),w._ready});return g(D,b,b),D},m.prototype.setDriver=function(b,w,D){var j=this;T(b)||(b=[b]);var V=this._getSupportedDrivers(b);function q(){j._config.driver=j.driver()}function L($){return j._extend($),q(),j._ready=j._initStorage(j._config),j._ready}var E=this._driverSet!==null?this._driverSet.catch(function(){return d.resolve()}):d.resolve();return this._driverSet=E.then(function(){var $=V[0];return j._dbInfo=null,j._ready=null,j.getDriver($).then(function(X){j._driver=X._driver,q(),j._wrapLibraryMethodsWithReady(),j._initDriver=function(J){return function(){var Z=0;return function oe(){for(;Z<J.length;){var me=J[Z];return Z++,j._dbInfo=null,j._ready=null,j.getDriver(me).then(L).catch(oe)}q();var ve=new Error("No available storage method found.");return j._driverSet=d.reject(ve),j._driverSet}()}}(V)})}).catch(function(){q();var $=new Error("No available storage method found.");return j._driverSet=d.reject($),j._driverSet}),g(this._driverSet,w,D),this._driverSet},m.prototype.supports=function(b){return!!B[b]},m.prototype._extend=function(b){ye(this,b)},m.prototype._getSupportedDrivers=function(b){for(var w=[],D=0,j=b.length;D<j;D++){var V=b[D];this.supports(V)&&w.push(V)}return w},m.prototype._wrapLibraryMethodsWithReady=function(){for(var b=0,w=fe.length;b<w;b++)be(this,fe[b])},m.prototype.createInstance=function(b){return new m(b)},m}());l.exports=_e},{3:3}]},{},[4])(4)})}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],21:[function(e,t,r){(function(a){var n=e(22);t.exports={generate:function(){var l=n.v1();return l.substr(14,4)+l.substr(9,4)+l.substr(0,8)+l.substr(19,4)+l.substr(24,l.length)},toBinary16:function(l){return new a(l,"hex")},fromBinary16:function(l){return l.toString("hex")}}}).call(this,e(28).Buffer)},{22:22,28:28}],22:[function(e,t,r){var a=e(25),n=e(26),l=n;l.v1=a,l.v4=n,t.exports=l},{25:25,26:26}],23:[function(e,t,r){for(var a=[],n=0;n<256;++n)a[n]=(n+256).toString(16).substr(1);t.exports=function(l,f){var s=f||0,h=a;return[h[l[s++]],h[l[s++]],h[l[s++]],h[l[s++]],"-",h[l[s++]],h[l[s++]],"-",h[l[s++]],h[l[s++]],"-",h[l[s++]],h[l[s++]],"-",h[l[s++]],h[l[s++]],h[l[s++]],h[l[s++]],h[l[s++]],h[l[s++]]].join("")}},{}],24:[function(e,t,r){var a=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(a){var n=new Uint8Array(16);t.exports=function(){return a(n),n}}else{var l=new Array(16);t.exports=function(){for(var f,s=0;s<16;s++)(3&s)==0&&(f=4294967296*Math.random()),l[s]=f>>>((3&s)<<3)&255;return l}}},{}],25:[function(e,t,r){var a,n,l=e(24),f=e(23),s=0,h=0;t.exports=function(p,d,y){var g=d&&y||0,k=d||[],A=(p=p||{}).node||a,M=p.clockseq!==void 0?p.clockseq:n;if(A==null||M==null){var N=l();A==null&&(A=a=[1|N[0],N[1],N[2],N[3],N[4],N[5]]),M==null&&(M=n=16383&(N[6]<<8|N[7]))}var S=p.msecs!==void 0?p.msecs:new Date().getTime(),O=p.nsecs!==void 0?p.nsecs:h+1,_=S-s+(O-h)/1e4;if(_<0&&p.clockseq===void 0&&(M=M+1&16383),(_<0||S>s)&&p.nsecs===void 0&&(O=0),O>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=S,h=O,n=M;var v=(1e4*(268435455&(S+=122192928e5))+O)%4294967296;k[g++]=v>>>24&255,k[g++]=v>>>16&255,k[g++]=v>>>8&255,k[g++]=255&v;var C=S/4294967296*1e4&268435455;k[g++]=C>>>8&255,k[g++]=255&C,k[g++]=C>>>24&15|16,k[g++]=C>>>16&255,k[g++]=M>>>8|128,k[g++]=255&M;for(var F=0;F<6;++F)k[g+F]=A[F];return d||f(k)}},{23:23,24:24}],26:[function(e,t,r){var a=e(24),n=e(23);t.exports=function(l,f,s){var h=f&&s||0;typeof l=="string"&&(f=l==="binary"?new Array(16):null,l=null);var p=(l=l||{}).random||(l.rng||a)();if(p[6]=15&p[6]|64,p[8]=63&p[8]|128,f)for(var d=0;d<16;++d)f[h+d]=p[d];return f||n(p)}},{23:23,24:24}],27:[function(e,t,r){r.byteLength=function(y){var g=p(y),k=g[0],A=g[1];return 3*(k+A)/4-A},r.toByteArray=function(y){var g,k,A=p(y),M=A[0],N=A[1],S=new l(function(v,C,F){return 3*(C+F)/4-F}(0,M,N)),O=0,_=N>0?M-4:M;for(k=0;k<_;k+=4)g=n[y.charCodeAt(k)]<<18|n[y.charCodeAt(k+1)]<<12|n[y.charCodeAt(k+2)]<<6|n[y.charCodeAt(k+3)],S[O++]=g>>16&255,S[O++]=g>>8&255,S[O++]=255&g;return N===2&&(g=n[y.charCodeAt(k)]<<2|n[y.charCodeAt(k+1)]>>4,S[O++]=255&g),N===1&&(g=n[y.charCodeAt(k)]<<10|n[y.charCodeAt(k+1)]<<4|n[y.charCodeAt(k+2)]>>2,S[O++]=g>>8&255,S[O++]=255&g),S},r.fromByteArray=function(y){for(var g,k=y.length,A=k%3,M=[],N=0,S=k-A;N<S;N+=16383)M.push(d(y,N,N+16383>S?S:N+16383));return A===1?(g=y[k-1],M.push(a[g>>2]+a[g<<4&63]+"==")):A===2&&(g=(y[k-2]<<8)+y[k-1],M.push(a[g>>10]+a[g>>4&63]+a[g<<2&63]+"=")),M.join("")};for(var a=[],n=[],l=typeof Uint8Array!="undefined"?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,h=f.length;s<h;++s)a[s]=f[s],n[f.charCodeAt(s)]=s;function p(y){var g=y.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=y.indexOf("=");return k===-1&&(k=g),[k,k===g?0:4-k%4]}function d(y,g,k){for(var A,M,N=[],S=g;S<k;S+=3)A=(y[S]<<16&16711680)+(y[S+1]<<8&65280)+(255&y[S+2]),N.push(a[(M=A)>>18&63]+a[M>>12&63]+a[M>>6&63]+a[63&M]);return N.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},{}],28:[function(e,t,r){(function(s){var n=e(27),l=e(29);r.Buffer=s,r.SlowBuffer=function(o){return+o!=o&&(o=0),s.alloc(+o)},r.INSPECT_MAX_BYTES=50;function f(o){if(o>2147483647)throw new RangeError('The value "'+o+'" is invalid for option "size"');var u=new Uint8Array(o);return u.__proto__=s.prototype,u}function s(o,u,c){if(typeof o=="number"){if(typeof u=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(o)}return h(o,u,c)}function h(o,u,c){if(typeof o=="string")return function(B,Q){if(typeof Q=="string"&&Q!==""||(Q="utf8"),!s.isEncoding(Q))throw new TypeError("Unknown encoding: "+Q);var ne=0|k(B,Q),de=f(ne),fe=de.write(B,Q);return fe!==ne&&(de=de.slice(0,fe)),de}(o,u);if(ArrayBuffer.isView(o))return y(o);if(o==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o);if(ae(o,ArrayBuffer)||o&&ae(o.buffer,ArrayBuffer))return function(B,Q,ne){if(Q<0||B.byteLength<Q)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<Q+(ne||0))throw new RangeError('"length" is outside of buffer bounds');var de;return(de=Q===void 0&&ne===void 0?new Uint8Array(B):ne===void 0?new Uint8Array(B,Q):new Uint8Array(B,Q,ne)).__proto__=s.prototype,de}(o,u,c);if(typeof o=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var T=o.valueOf&&o.valueOf();if(T!=null&&T!==o)return s.from(T,u,c);var I=function(B){if(s.isBuffer(B)){var Q=0|g(B.length),ne=f(Q);return ne.length===0||B.copy(ne,0,0,Q),ne}return B.length!==void 0?typeof B.length!="number"||pe(B.length)?f(0):y(B):B.type==="Buffer"&&Array.isArray(B.data)?y(B.data):void 0}(o);if(I)return I;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof o[Symbol.toPrimitive]=="function")return s.from(o[Symbol.toPrimitive]("string"),u,c);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof o)}function p(o){if(typeof o!="number")throw new TypeError('"size" argument must be of type number');if(o<0)throw new RangeError('The value "'+o+'" is invalid for option "size"')}function d(o){return p(o),f(o<0?0:0|g(o))}function y(o){for(var u=o.length<0?0:0|g(o.length),c=f(u),T=0;T<u;T+=1)c[T]=255&o[T];return c}function g(o){if(o>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|o}function k(o,u){if(s.isBuffer(o))return o.length;if(ArrayBuffer.isView(o)||ae(o,ArrayBuffer))return o.byteLength;if(typeof o!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof o);var c=o.length,T=arguments.length>2&&arguments[2]===!0;if(!T&&c===0)return 0;for(var I=!1;;)switch(u){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return ie(o).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return re(o).length;default:if(I)return T?-1:ie(o).length;u=(""+u).toLowerCase(),I=!0}}function A(o,u,c){var T=o[u];o[u]=o[c],o[c]=T}function M(o,u,c,T,I){if(o.length===0)return-1;if(typeof c=="string"?(T=c,c=0):c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),pe(c=+c)&&(c=I?0:o.length-1),c<0&&(c=o.length+c),c>=o.length){if(I)return-1;c=o.length-1}else if(c<0){if(!I)return-1;c=0}if(typeof u=="string"&&(u=s.from(u,T)),s.isBuffer(u))return u.length===0?-1:N(o,u,c,T,I);if(typeof u=="number")return u&=255,typeof Uint8Array.prototype.indexOf=="function"?I?Uint8Array.prototype.indexOf.call(o,u,c):Uint8Array.prototype.lastIndexOf.call(o,u,c):N(o,[u],c,T,I);throw new TypeError("val must be string, number or Buffer")}function N(o,u,c,T,I){var B,Q=1,ne=o.length,de=u.length;if(T!==void 0&&((T=String(T).toLowerCase())==="ucs2"||T==="ucs-2"||T==="utf16le"||T==="utf-16le")){if(o.length<2||u.length<2)return-1;Q=2,ne/=2,de/=2,c/=2}function fe(_e,m){return Q===1?_e[m]:_e.readUInt16BE(m*Q)}if(I){var ue=-1;for(B=c;B<ne;B++)if(fe(o,B)===fe(u,ue===-1?0:B-ue)){if(ue===-1&&(ue=B),B-ue+1===de)return ue*Q}else ue!==-1&&(B-=B-ue),ue=-1}else for(c+de>ne&&(c=ne-de),B=c;B>=0;B--){for(var be=!0,ye=0;ye<de;ye++)if(fe(o,B+ye)!==fe(u,ye)){be=!1;break}if(be)return B}return-1}function S(o,u,c,T){c=Number(c)||0;var I=o.length-c;T?(T=Number(T))>I&&(T=I):T=I;var B=u.length;T>B/2&&(T=B/2);for(var Q=0;Q<T;++Q){var ne=parseInt(u.substr(2*Q,2),16);if(pe(ne))return Q;o[c+Q]=ne}return Q}function O(o,u,c,T){return H(ie(u,o.length-c),o,c,T)}function _(o,u,c,T){return H(function(I){for(var B=[],Q=0;Q<I.length;++Q)B.push(255&I.charCodeAt(Q));return B}(u),o,c,T)}function v(o,u,c,T){return _(o,u,c,T)}function C(o,u,c,T){return H(re(u),o,c,T)}function F(o,u,c,T){return H(function(I,B){for(var Q,ne,de,fe=[],ue=0;ue<I.length&&!((B-=2)<0);++ue)ne=(Q=I.charCodeAt(ue))>>8,de=Q%256,fe.push(de),fe.push(ne);return fe}(u,o.length-c),o,c,T)}function P(o,u,c){return u===0&&c===o.length?n.fromByteArray(o):n.fromByteArray(o.slice(u,c))}function R(o,u,c){c=Math.min(o.length,c);for(var T=[],I=u;I<c;){var B,Q,ne,de,fe=o[I],ue=null,be=fe>239?4:fe>223?3:fe>191?2:1;if(I+be<=c)switch(be){case 1:fe<128&&(ue=fe);break;case 2:(192&(B=o[I+1]))==128&&(de=(31&fe)<<6|63&B)>127&&(ue=de);break;case 3:B=o[I+1],Q=o[I+2],(192&B)==128&&(192&Q)==128&&(de=(15&fe)<<12|(63&B)<<6|63&Q)>2047&&(de<55296||de>57343)&&(ue=de);break;case 4:B=o[I+1],Q=o[I+2],ne=o[I+3],(192&B)==128&&(192&Q)==128&&(192&ne)==128&&(de=(15&fe)<<18|(63&B)<<12|(63&Q)<<6|63&ne)>65535&&de<1114112&&(ue=de)}ue===null?(ue=65533,be=1):ue>65535&&(ue-=65536,T.push(ue>>>10&1023|55296),ue=56320|1023&ue),T.push(ue),I+=be}return function(ye){var _e=ye.length;if(_e<=U)return String.fromCharCode.apply(String,ye);for(var m="",b=0;b<_e;)m+=String.fromCharCode.apply(String,ye.slice(b,b+=U));return m}(T)}r.kMaxLength=2147483647,s.TYPED_ARRAY_SUPPORT=function(){try{var o=new Uint8Array(1);return o.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},o.foo()===42}catch{return!1}}(),s.TYPED_ARRAY_SUPPORT||typeof console=="undefined"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),typeof Symbol!="undefined"&&Symbol.species!=null&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(o,u,c){return h(o,u,c)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(o,u,c){return function(T,I,B){return p(T),T<=0?f(T):I!==void 0?typeof B=="string"?f(T).fill(I,B):f(T).fill(I):f(T)}(o,u,c)},s.allocUnsafe=function(o){return d(o)},s.allocUnsafeSlow=function(o){return d(o)},s.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==s.prototype},s.compare=function(o,u){if(ae(o,Uint8Array)&&(o=s.from(o,o.offset,o.byteLength)),ae(u,Uint8Array)&&(u=s.from(u,u.offset,u.byteLength)),!s.isBuffer(o)||!s.isBuffer(u))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===u)return 0;for(var c=o.length,T=u.length,I=0,B=Math.min(c,T);I<B;++I)if(o[I]!==u[I]){c=o[I],T=u[I];break}return c<T?-1:T<c?1:0},s.isEncoding=function(o){switch(String(o).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(o,u){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return s.alloc(0);var c;if(u===void 0)for(u=0,c=0;c<o.length;++c)u+=o[c].length;var T=s.allocUnsafe(u),I=0;for(c=0;c<o.length;++c){var B=o[c];if(ae(B,Uint8Array)&&(B=s.from(B)),!s.isBuffer(B))throw new TypeError('"list" argument must be an Array of Buffers');B.copy(T,I),I+=B.length}return T},s.byteLength=k,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var o=this.length;if(o%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var u=0;u<o;u+=2)A(this,u,u+1);return this},s.prototype.swap32=function(){var o=this.length;if(o%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var u=0;u<o;u+=4)A(this,u,u+3),A(this,u+1,u+2);return this},s.prototype.swap64=function(){var o=this.length;if(o%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var u=0;u<o;u+=8)A(this,u,u+7),A(this,u+1,u+6),A(this,u+2,u+5),A(this,u+3,u+4);return this},s.prototype.toString=function(){var o=this.length;return o===0?"":arguments.length===0?R(this,0,o):function(u,c,T){var I=!1;if((c===void 0||c<0)&&(c=0),c>this.length||((T===void 0||T>this.length)&&(T=this.length),T<=0)||(T>>>=0)<=(c>>>=0))return"";for(u||(u="utf8");;)switch(u){case"hex":return G(this,c,T);case"utf8":case"utf-8":return R(this,c,T);case"ascii":return Y(this,c,T);case"latin1":case"binary":return ee(this,c,T);case"base64":return P(this,c,T);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ce(this,c,T);default:if(I)throw new TypeError("Unknown encoding: "+u);u=(u+"").toLowerCase(),I=!0}}.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(o){if(!s.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o||s.compare(this,o)===0},s.prototype.inspect=function(){var o="",u=r.INSPECT_MAX_BYTES;return o=this.toString("hex",0,u).replace(/(.{2})/g,"$1 ").trim(),this.length>u&&(o+=" ... "),"<Buffer "+o+">"},s.prototype.compare=function(o,u,c,T,I){if(ae(o,Uint8Array)&&(o=s.from(o,o.offset,o.byteLength)),!s.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(u===void 0&&(u=0),c===void 0&&(c=o?o.length:0),T===void 0&&(T=0),I===void 0&&(I=this.length),u<0||c>o.length||T<0||I>this.length)throw new RangeError("out of range index");if(T>=I&&u>=c)return 0;if(T>=I)return-1;if(u>=c)return 1;if(this===o)return 0;for(var B=(I>>>=0)-(T>>>=0),Q=(c>>>=0)-(u>>>=0),ne=Math.min(B,Q),de=this.slice(T,I),fe=o.slice(u,c),ue=0;ue<ne;++ue)if(de[ue]!==fe[ue]){B=de[ue],Q=fe[ue];break}return B<Q?-1:Q<B?1:0},s.prototype.includes=function(o,u,c){return this.indexOf(o,u,c)!==-1},s.prototype.indexOf=function(o,u,c){return M(this,o,u,c,!0)},s.prototype.lastIndexOf=function(o,u,c){return M(this,o,u,c,!1)},s.prototype.write=function(o,u,c,T){if(u===void 0)T="utf8",c=this.length,u=0;else if(c===void 0&&typeof u=="string")T=u,c=this.length,u=0;else{if(!isFinite(u))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");u>>>=0,isFinite(c)?(c>>>=0,T===void 0&&(T="utf8")):(T=c,c=void 0)}var I=this.length-u;if((c===void 0||c>I)&&(c=I),o.length>0&&(c<0||u<0)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");T||(T="utf8");for(var B=!1;;)switch(T){case"hex":return S(this,o,u,c);case"utf8":case"utf-8":return O(this,o,u,c);case"ascii":return _(this,o,u,c);case"latin1":case"binary":return v(this,o,u,c);case"base64":return C(this,o,u,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,o,u,c);default:if(B)throw new TypeError("Unknown encoding: "+T);T=(""+T).toLowerCase(),B=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var U=4096;function Y(o,u,c){var T="";c=Math.min(o.length,c);for(var I=u;I<c;++I)T+=String.fromCharCode(127&o[I]);return T}function ee(o,u,c){var T="";c=Math.min(o.length,c);for(var I=u;I<c;++I)T+=String.fromCharCode(o[I]);return T}function G(o,u,c){var T,I=o.length;(!u||u<0)&&(u=0),(!c||c<0||c>I)&&(c=I);for(var B="",Q=u;Q<c;++Q)B+=(T=o[Q])<16?"0"+T.toString(16):T.toString(16);return B}function ce(o,u,c){for(var T=o.slice(u,c),I="",B=0;B<T.length;B+=2)I+=String.fromCharCode(T[B]+256*T[B+1]);return I}function W(o,u,c){if(o%1!=0||o<0)throw new RangeError("offset is not uint");if(o+u>c)throw new RangeError("Trying to access beyond buffer length")}function se(o,u,c,T,I,B){if(!s.isBuffer(o))throw new TypeError('"buffer" argument must be a Buffer instance');if(u>I||u<B)throw new RangeError('"value" argument is out of bounds');if(c+T>o.length)throw new RangeError("Index out of range")}function ge(o,u,c,T,I,B){if(c+T>o.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function z(o,u,c,T,I){return u=+u,c>>>=0,I||ge(o,0,c,4),l.write(o,u,c,T,23,4),c+4}function K(o,u,c,T,I){return u=+u,c>>>=0,I||ge(o,0,c,8),l.write(o,u,c,T,52,8),c+8}s.prototype.slice=function(o,u){var c=this.length;(o=~~o)<0?(o+=c)<0&&(o=0):o>c&&(o=c),(u=u===void 0?c:~~u)<0?(u+=c)<0&&(u=0):u>c&&(u=c),u<o&&(u=o);var T=this.subarray(o,u);return T.__proto__=s.prototype,T},s.prototype.readUIntLE=function(o,u,c){o>>>=0,u>>>=0,c||W(o,u,this.length);for(var T=this[o],I=1,B=0;++B<u&&(I*=256);)T+=this[o+B]*I;return T},s.prototype.readUIntBE=function(o,u,c){o>>>=0,u>>>=0,c||W(o,u,this.length);for(var T=this[o+--u],I=1;u>0&&(I*=256);)T+=this[o+--u]*I;return T},s.prototype.readUInt8=function(o,u){return o>>>=0,u||W(o,1,this.length),this[o]},s.prototype.readUInt16LE=function(o,u){return o>>>=0,u||W(o,2,this.length),this[o]|this[o+1]<<8},s.prototype.readUInt16BE=function(o,u){return o>>>=0,u||W(o,2,this.length),this[o]<<8|this[o+1]},s.prototype.readUInt32LE=function(o,u){return o>>>=0,u||W(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+16777216*this[o+3]},s.prototype.readUInt32BE=function(o,u){return o>>>=0,u||W(o,4,this.length),16777216*this[o]+(this[o+1]<<16|this[o+2]<<8|this[o+3])},s.prototype.readIntLE=function(o,u,c){o>>>=0,u>>>=0,c||W(o,u,this.length);for(var T=this[o],I=1,B=0;++B<u&&(I*=256);)T+=this[o+B]*I;return T>=(I*=128)&&(T-=Math.pow(2,8*u)),T},s.prototype.readIntBE=function(o,u,c){o>>>=0,u>>>=0,c||W(o,u,this.length);for(var T=u,I=1,B=this[o+--T];T>0&&(I*=256);)B+=this[o+--T]*I;return B>=(I*=128)&&(B-=Math.pow(2,8*u)),B},s.prototype.readInt8=function(o,u){return o>>>=0,u||W(o,1,this.length),128&this[o]?-1*(255-this[o]+1):this[o]},s.prototype.readInt16LE=function(o,u){o>>>=0,u||W(o,2,this.length);var c=this[o]|this[o+1]<<8;return 32768&c?4294901760|c:c},s.prototype.readInt16BE=function(o,u){o>>>=0,u||W(o,2,this.length);var c=this[o+1]|this[o]<<8;return 32768&c?4294901760|c:c},s.prototype.readInt32LE=function(o,u){return o>>>=0,u||W(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24},s.prototype.readInt32BE=function(o,u){return o>>>=0,u||W(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]},s.prototype.readFloatLE=function(o,u){return o>>>=0,u||W(o,4,this.length),l.read(this,o,!0,23,4)},s.prototype.readFloatBE=function(o,u){return o>>>=0,u||W(o,4,this.length),l.read(this,o,!1,23,4)},s.prototype.readDoubleLE=function(o,u){return o>>>=0,u||W(o,8,this.length),l.read(this,o,!0,52,8)},s.prototype.readDoubleBE=function(o,u){return o>>>=0,u||W(o,8,this.length),l.read(this,o,!1,52,8)},s.prototype.writeUIntLE=function(o,u,c,T){o=+o,u>>>=0,c>>>=0,T||se(this,o,u,c,Math.pow(2,8*c)-1,0);var I=1,B=0;for(this[u]=255&o;++B<c&&(I*=256);)this[u+B]=o/I&255;return u+c},s.prototype.writeUIntBE=function(o,u,c,T){o=+o,u>>>=0,c>>>=0,T||se(this,o,u,c,Math.pow(2,8*c)-1,0);var I=c-1,B=1;for(this[u+I]=255&o;--I>=0&&(B*=256);)this[u+I]=o/B&255;return u+c},s.prototype.writeUInt8=function(o,u,c){return o=+o,u>>>=0,c||se(this,o,u,1,255,0),this[u]=255&o,u+1},s.prototype.writeUInt16LE=function(o,u,c){return o=+o,u>>>=0,c||se(this,o,u,2,65535,0),this[u]=255&o,this[u+1]=o>>>8,u+2},s.prototype.writeUInt16BE=function(o,u,c){return o=+o,u>>>=0,c||se(this,o,u,2,65535,0),this[u]=o>>>8,this[u+1]=255&o,u+2},s.prototype.writeUInt32LE=function(o,u,c){return o=+o,u>>>=0,c||se(this,o,u,4,4294967295,0),this[u+3]=o>>>24,this[u+2]=o>>>16,this[u+1]=o>>>8,this[u]=255&o,u+4},s.prototype.writeUInt32BE=function(o,u,c){return o=+o,u>>>=0,c||se(this,o,u,4,4294967295,0),this[u]=o>>>24,this[u+1]=o>>>16,this[u+2]=o>>>8,this[u+3]=255&o,u+4},s.prototype.writeIntLE=function(o,u,c,T){if(o=+o,u>>>=0,!T){var I=Math.pow(2,8*c-1);se(this,o,u,c,I-1,-I)}var B=0,Q=1,ne=0;for(this[u]=255&o;++B<c&&(Q*=256);)o<0&&ne===0&&this[u+B-1]!==0&&(ne=1),this[u+B]=(o/Q>>0)-ne&255;return u+c},s.prototype.writeIntBE=function(o,u,c,T){if(o=+o,u>>>=0,!T){var I=Math.pow(2,8*c-1);se(this,o,u,c,I-1,-I)}var B=c-1,Q=1,ne=0;for(this[u+B]=255&o;--B>=0&&(Q*=256);)o<0&&ne===0&&this[u+B+1]!==0&&(ne=1),this[u+B]=(o/Q>>0)-ne&255;return u+c},s.prototype.writeInt8=function(o,u,c){return o=+o,u>>>=0,c||se(this,o,u,1,127,-128),o<0&&(o=255+o+1),this[u]=255&o,u+1},s.prototype.writeInt16LE=function(o,u,c){return o=+o,u>>>=0,c||se(this,o,u,2,32767,-32768),this[u]=255&o,this[u+1]=o>>>8,u+2},s.prototype.writeInt16BE=function(o,u,c){return o=+o,u>>>=0,c||se(this,o,u,2,32767,-32768),this[u]=o>>>8,this[u+1]=255&o,u+2},s.prototype.writeInt32LE=function(o,u,c){return o=+o,u>>>=0,c||se(this,o,u,4,2147483647,-2147483648),this[u]=255&o,this[u+1]=o>>>8,this[u+2]=o>>>16,this[u+3]=o>>>24,u+4},s.prototype.writeInt32BE=function(o,u,c){return o=+o,u>>>=0,c||se(this,o,u,4,2147483647,-2147483648),o<0&&(o=4294967295+o+1),this[u]=o>>>24,this[u+1]=o>>>16,this[u+2]=o>>>8,this[u+3]=255&o,u+4},s.prototype.writeFloatLE=function(o,u,c){return z(this,o,u,!0,c)},s.prototype.writeFloatBE=function(o,u,c){return z(this,o,u,!1,c)},s.prototype.writeDoubleLE=function(o,u,c){return K(this,o,u,!0,c)},s.prototype.writeDoubleBE=function(o,u,c){return K(this,o,u,!1,c)},s.prototype.copy=function(o,u,c,T){if(!s.isBuffer(o))throw new TypeError("argument should be a Buffer");if(c||(c=0),T||T===0||(T=this.length),u>=o.length&&(u=o.length),u||(u=0),T>0&&T<c&&(T=c),T===c||o.length===0||this.length===0)return 0;if(u<0)throw new RangeError("targetStart out of bounds");if(c<0||c>=this.length)throw new RangeError("Index out of range");if(T<0)throw new RangeError("sourceEnd out of bounds");T>this.length&&(T=this.length),o.length-u<T-c&&(T=o.length-u+c);var I=T-c;if(this===o&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(u,c,T);else if(this===o&&c<u&&u<T)for(var B=I-1;B>=0;--B)o[B+u]=this[B+c];else Uint8Array.prototype.set.call(o,this.subarray(c,T),u);return I},s.prototype.fill=function(o,u,c,T){if(typeof o=="string"){if(typeof u=="string"?(T=u,u=0,c=this.length):typeof c=="string"&&(T=c,c=this.length),T!==void 0&&typeof T!="string")throw new TypeError("encoding must be a string");if(typeof T=="string"&&!s.isEncoding(T))throw new TypeError("Unknown encoding: "+T);if(o.length===1){var I=o.charCodeAt(0);(T==="utf8"&&I<128||T==="latin1")&&(o=I)}}else typeof o=="number"&&(o&=255);if(u<0||this.length<u||this.length<c)throw new RangeError("Out of range index");if(c<=u)return this;var B;if(u>>>=0,c=c===void 0?this.length:c>>>0,o||(o=0),typeof o=="number")for(B=u;B<c;++B)this[B]=o;else{var Q=s.isBuffer(o)?o:s.from(o,T),ne=Q.length;if(ne===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(B=0;B<c-u;++B)this[B+u]=Q[B%ne]}return this};var le=/[^+\/0-9A-Za-z-_]/g;function ie(o,u){var c;u=u||1/0;for(var T=o.length,I=null,B=[],Q=0;Q<T;++Q){if((c=o.charCodeAt(Q))>55295&&c<57344){if(!I){if(c>56319){(u-=3)>-1&&B.push(239,191,189);continue}if(Q+1===T){(u-=3)>-1&&B.push(239,191,189);continue}I=c;continue}if(c<56320){(u-=3)>-1&&B.push(239,191,189),I=c;continue}c=65536+(I-55296<<10|c-56320)}else I&&(u-=3)>-1&&B.push(239,191,189);if(I=null,c<128){if((u-=1)<0)break;B.push(c)}else if(c<2048){if((u-=2)<0)break;B.push(c>>6|192,63&c|128)}else if(c<65536){if((u-=3)<0)break;B.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(c<1114112))throw new Error("Invalid code point");if((u-=4)<0)break;B.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return B}function re(o){return n.toByteArray(function(u){if((u=(u=u.split("=")[0]).trim().replace(le,"")).length<2)return"";for(;u.length%4!=0;)u+="=";return u}(o))}function H(o,u,c,T){for(var I=0;I<T&&!(I+c>=u.length||I>=o.length);++I)u[I+c]=o[I];return I}function ae(o,u){return o instanceof u||o!=null&&o.constructor!=null&&o.constructor.name!=null&&o.constructor.name===u.name}function pe(o){return o!=o}}).call(this,e(28).Buffer)},{27:27,28:28,29:29}],29:[function(e,t,r){r.read=function(a,n,l,f,s){var h,p,d=8*s-f-1,y=(1<<d)-1,g=y>>1,k=-7,A=l?s-1:0,M=l?-1:1,N=a[n+A];for(A+=M,h=N&(1<<-k)-1,N>>=-k,k+=d;k>0;h=256*h+a[n+A],A+=M,k-=8);for(p=h&(1<<-k)-1,h>>=-k,k+=f;k>0;p=256*p+a[n+A],A+=M,k-=8);if(h===0)h=1-g;else{if(h===y)return p?NaN:1/0*(N?-1:1);p+=Math.pow(2,f),h-=g}return(N?-1:1)*p*Math.pow(2,h-f)},r.write=function(a,n,l,f,s,h){var p,d,y,g=8*h-s-1,k=(1<<g)-1,A=k>>1,M=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=f?0:h-1,S=f?1:-1,O=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(d=isNaN(n)?1:0,p=k):(p=Math.floor(Math.log(n)/Math.LN2),n*(y=Math.pow(2,-p))<1&&(p--,y*=2),(n+=p+A>=1?M/y:M*Math.pow(2,1-A))*y>=2&&(p++,y/=2),p+A>=k?(d=0,p=k):p+A>=1?(d=(n*y-1)*Math.pow(2,s),p+=A):(d=n*Math.pow(2,A-1)*Math.pow(2,s),p=0));s>=8;a[l+N]=255&d,N+=S,d/=256,s-=8);for(p=p<<s|d,g+=s;g>0;a[l+N]=255&p,N+=S,p/=256,g-=8);a[l+N-S]|=128*O}},{}]},{},[1])(1)});/*!
 * maska v1.4.2
 * (c) 2019-2021 Alexander Shabunevich
 * Released under the MIT License.
 */(function(e,t){typeof exports=="object"&&typeof module!="undefined"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):t((e=typeof globalThis!="undefined"?globalThis:e||self).Maska={})})(globalThis,function(e){function t(S,O){if(!(S instanceof O))throw new TypeError("Cannot call a class as a function")}function r(S,O){for(var _=0;_<O.length;_++){var v=O[_];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(S,v.key,v)}}function a(S,O,_){return O in S?Object.defineProperty(S,O,{value:_,enumerable:!0,configurable:!0,writable:!0}):S[O]=_,S}function n(S,O){var _=Object.keys(S);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(S);O&&(v=v.filter(function(C){return Object.getOwnPropertyDescriptor(S,C).enumerable})),_.push.apply(_,v)}return _}function l(S){for(var O=1;O<arguments.length;O++){var _=arguments[O]!=null?arguments[O]:{};O%2?n(Object(_),!0).forEach(function(v){a(S,v,_[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(S,Object.getOwnPropertyDescriptors(_)):n(Object(_)).forEach(function(v){Object.defineProperty(S,v,Object.getOwnPropertyDescriptor(_,v))})}return S}function f(S,O,_){var v=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return s(O).length>1?h(O)(S,O,_,v):p(S,O,_,v)}function s(S){try{return JSON.parse(S)}catch{return[S]}}function h(S){var O=s(S).sort(function(v,C){return v.length-C.length});return function(v,C,F){var P=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],R=O.map(function(ee){return p(v,ee,F,!1)}),U=R.pop();for(var Y in O)if(_(U,O[Y],F))return p(v,O[Y],F,P);return""};function _(v,C,F){for(var P in F)F[P].escape&&(C=C.replace(new RegExp(P+".{1}","g"),""));return C.split("").filter(function(R){return F[R]&&F[R].pattern}).length>=v.length}}function p(S,O,_){for(var v=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],C=0,F=0,P="",R="";C<O.length&&F<S.length;){var U=O[C],Y=S[F],ee=_[U];if(ee&&ee.pattern)ee.pattern.test(Y)&&(P+=d(Y,ee),C++,v&&O[C]&&(_[O[C]]?_[O[C]]&&_[O[C]].escape&&(P+=O[C+1],C+=2):(P+=O[C],C++))),F++;else if(ee&&ee.repeat){var G=_[O[C-1]];G&&!G.pattern.test(Y)?C++:C--}else ee&&ee.escape&&(U=O[++C]),v&&(P+=U),Y===U&&F++,C++}for(;v&&C<O.length;){var ce=O[C];if(_[ce]){R="";break}R+=ce,C++}return P+R}function d(S,O){return O.transform&&(S=O.transform(S)),O.uppercase?S.toLocaleUpperCase():O.lowercase?S.toLocaleLowerCase():S}var y={"#":{pattern:/[0-9]/},X:{pattern:/[0-9a-zA-Z]/},S:{pattern:/[a-zA-Z]/},A:{pattern:/[a-zA-Z]/,uppercase:!0},a:{pattern:/[a-zA-Z]/,lowercase:!0},"!":{escape:!0},"*":{repeat:!0}};function g(S){return S instanceof HTMLInputElement?S:S.querySelector("input")||S}function k(S){return Object.prototype.toString.call(S)==="[object String]"}var A=function(){function S(v){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t(this,S),!v)throw new Error("Maska: no element for mask");if(C.tokens)for(var F in C.tokens)C.tokens[F]=l({},C.tokens[F]),C.tokens[F].pattern&&k(C.tokens[F].pattern)&&(C.tokens[F].pattern=new RegExp(C.tokens[F].pattern));this._opts={mask:C.mask,tokens:l(l({},y),C.tokens)},this._el=k(v)?document.querySelectorAll(v):v.length?v:[v],this.init()}var O,_;return O=S,(_=[{key:"init",value:function(){for(var v=this,C=0;C<this._el.length;C++){var F=g(this._el[C]);!this._opts.mask||F.dataset.mask&&F.dataset.mask===this._opts.mask||(F.dataset.mask=this._opts.mask),this.updateValue(F),F.dataset.maskInited||(F.dataset.maskInited=!0,F.addEventListener("input",function(P){return v.updateValue(P.target,P)}),F.addEventListener("beforeinput",function(P){return v.beforeInput(P)}))}}},{key:"destroy",value:function(){for(var v=this,C=0;C<this._el.length;C++){var F=g(this._el[C]);F.removeEventListener("input",function(P){return v.updateValue(P.target,P)}),F.removeEventListener("beforeinput",function(P){return v.beforeInput(P)}),delete F.dataset.mask,delete F.dataset.maskInited}}},{key:"updateValue",value:function(v,C){var F=v.type.match(/^number$/i)&&v.validity.badInput;if(!v.value&&!F||!v.dataset.mask)return v.dataset.maskRawValue="",void this.dispatch("maska",v,C);var P=v.selectionEnd,R=v.value,U=R[P-1];v.dataset.maskRawValue=f(v.value,v.dataset.mask,this._opts.tokens,!1),v.value=f(v.value,v.dataset.mask,this._opts.tokens),C&&C.inputType==="insertText"&&P===R.length&&(P=v.value.length),function(Y,ee,G){for(;ee&&ee<Y.value.length&&Y.value.charAt(ee-1)!==G;)ee++;(Y.type?Y.type.match(/^(text|search|password|tel|url)$/i):!Y.type)&&Y===document.activeElement&&(Y.setSelectionRange(ee,ee),setTimeout(function(){Y.setSelectionRange(ee,ee)},0))}(v,P,U),this.dispatch("maska",v,C),v.value!==R&&this.dispatch("input",v,C)}},{key:"beforeInput",value:function(v){v.target.type.match(/^number$/i)&&v.data&&isNaN(v.target.value+v.data)&&v.preventDefault()}},{key:"dispatch",value:function(v,C,F){C.dispatchEvent(function(P){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,U=document.createEvent("Event");return U.initEvent(P,!0,!0),R&&(U.inputType=R),U}(v,F&&F.inputType||null))}}])&&r(O.prototype,_),S}();function M(S,O){if(O.value)return O.value&&function(_){return!(k(_.value)&&_.value===_.oldValue||Array.isArray(_.value)&&JSON.stringify(_.value)===JSON.stringify(_.oldValue)||_.value&&_.value.mask&&_.oldValue&&_.oldValue.mask&&_.value.mask===_.oldValue.mask)}(O)?new A(S,function(_){var v={};return _.mask?(v.mask=Array.isArray(_.mask)?JSON.stringify(_.mask):_.mask,v.tokens=_.tokens?l({},_.tokens):{}):v.mask=Array.isArray(_)?JSON.stringify(_):_,v}(O.value)):void 0}function N(S){S.directive("maska",M)}typeof window!="undefined"&&window.Vue&&window.Vue.use&&window.Vue.use(N),e.create=function(S,O){return new A(S,O)},e.default=N,e.install=N,e.mask=f,e.maska=M,e.tokens=y,Object.defineProperty(e,"__esModule",{value:!0})});var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(e,t){for(var r=new u16(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];for(var n=new u32(r[30]),a=1;a<30;++a)for(var l=r[a];l<r[a+1];++l)n[l]=l-r[a]<<5|a;return[r,n]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28;for(var _b=freb(fdeb,0),fd=_b[0],revfd=_b[1],rev=new u16(32768),i=0;i<32768;++i){var x=(i&43690)>>>1|(i&21845)<<1;x=(x&52428)>>>2|(x&13107)<<2,x=(x&61680)>>>4|(x&3855)<<4,rev[i]=((x&65280)>>>8|(x&255)<<8)>>>1}for(var hMap=function(e,t,r){for(var a=e.length,n=0,l=new u16(t);n<a;++n)e[n]&&++l[e[n]-1];var f=new u16(t);for(n=0;n<t;++n)f[n]=f[n-1]+l[n-1]<<1;var s;if(r){s=new u16(1<<t);var h=15-t;for(n=0;n<a;++n)if(e[n])for(var p=n<<4|e[n],d=t-e[n],y=f[e[n]-1]++<<d,g=y|(1<<d)-1;y<=g;++y)s[rev[y]>>>h]=p}else for(s=new u16(a),n=0;n<a;++n)e[n]&&(s[n]=rev[f[e[n]-1]++]>>>15-e[n]);return s},flt=new u8(288),i=0;i<144;++i)flt[i]=8;for(var i=144;i<256;++i)flt[i]=9;for(var i=256;i<280;++i)flt[i]=7;for(var i=280;i<288;++i)flt[i]=8;for(var fdt=new u8(32),i=0;i<32;++i)fdt[i]=5;var flm=hMap(flt,9,0),flrm=hMap(flt,9,1),fdm=hMap(fdt,5,0),fdrm=hMap(fdt,5,1),max=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},bits=function(e,t,r){var a=t/8|0;return(e[a]|e[a+1]<<8)>>(t&7)&r},bits16=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},shft=function(e){return(e+7)/8|0},slc=function(e,t,r){(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length);var a=new(e.BYTES_PER_ELEMENT==2?u16:e.BYTES_PER_ELEMENT==4?u32:u8)(r-t);return a.set(e.subarray(t,r)),a},ec=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],err=function(e,t,r){var a=new Error(t||ec[e]);if(a.code=e,Error.captureStackTrace&&Error.captureStackTrace(a,err),!r)throw a;return a},inflt=function(e,t,r){var a=e.length;if(!a||r&&r.f&&!r.l)return t||new u8(0);var n=!t||r,l=!r||r.i;r||(r={}),t||(t=new u8(a*3));var f=function(u){var c=t.length;if(u>c){var T=new u8(Math.max(c*2,u));T.set(t),t=T}},s=r.f||0,h=r.p||0,p=r.b||0,d=r.l,y=r.d,g=r.m,k=r.n,A=a*8;do{if(!d){s=bits(e,h,1);var M=bits(e,h+1,3);if(h+=3,M)if(M==1)d=flrm,y=fdrm,g=9,k=5;else if(M==2){var _=bits(e,h,31)+257,v=bits(e,h+10,15)+4,C=_+bits(e,h+5,31)+1;h+=14;for(var F=new u8(C),P=new u8(19),R=0;R<v;++R)P[clim[R]]=bits(e,h+R*3,7);h+=v*3;for(var U=max(P),Y=(1<<U)-1,ee=hMap(P,U,1),R=0;R<C;){var G=ee[bits(e,h,Y)];h+=G&15;var N=G>>>4;if(N<16)F[R++]=N;else{var ce=0,W=0;for(N==16?(W=3+bits(e,h,3),h+=2,ce=F[R-1]):N==17?(W=3+bits(e,h,7),h+=3):N==18&&(W=11+bits(e,h,127),h+=7);W--;)F[R++]=ce}}var se=F.subarray(0,_),ge=F.subarray(_);g=max(se),k=max(ge),d=hMap(se,g,1),y=hMap(ge,k,1)}else err(1);else{var N=shft(h)+4,S=e[N-4]|e[N-3]<<8,O=N+S;if(O>a){l&&err(0);break}n&&f(p+S),t.set(e.subarray(N,O),p),r.b=p+=S,r.p=h=O*8,r.f=s;continue}if(h>A){l&&err(0);break}}n&&f(p+131072);for(var z=(1<<g)-1,K=(1<<k)-1,le=h;;le=h){var ce=d[bits16(e,h)&z],ie=ce>>>4;if(h+=ce&15,h>A){l&&err(0);break}if(ce||err(2),ie<256)t[p++]=ie;else if(ie==256){le=h,d=null;break}else{var re=ie-254;if(ie>264){var R=ie-257,H=fleb[R];re=bits(e,h,(1<<H)-1)+fl[R],h+=H}var ae=y[bits16(e,h)&K],pe=ae>>>4;ae||err(3),h+=ae&15;var ge=fd[pe];if(pe>3){var H=fdeb[pe];ge+=bits16(e,h)&(1<<H)-1,h+=H}if(h>A){l&&err(0);break}n&&f(p+131072);for(var o=p+re;p<o;p+=4)t[p]=t[p-ge],t[p+1]=t[p+1-ge],t[p+2]=t[p+2-ge],t[p+3]=t[p+3-ge];p=o}}r.l=d,r.p=le,r.b=p,r.f=s,d&&(s=1,r.m=g,r.d=y,r.n=k)}while(!s);return p==t.length?t:slc(t,0,p)},wbits=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>>8},wbits16=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>>8,e[a+2]|=r>>>16},hTree=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var n=r.length,l=r.slice();if(!n)return[et,0];if(n==1){var f=new u8(r[0].s+1);return f[r[0].s]=1,[f,1]}r.sort(function(C,F){return C.f-F.f}),r.push({s:-1,f:25001});var s=r[0],h=r[1],p=0,d=1,y=2;for(r[0]={s:-1,f:s.f+h.f,l:s,r:h};d!=n-1;)s=r[r[p].f<r[y].f?p++:y++],h=r[p!=d&&r[p].f<r[y].f?p++:y++],r[d++]={s:-1,f:s.f+h.f,l:s,r:h};for(var g=l[0].s,a=1;a<n;++a)l[a].s>g&&(g=l[a].s);var k=new u16(g+1),A=ln(r[d-1],k,0);if(A>t){var a=0,M=0,N=A-t,S=1<<N;for(l.sort(function(F,P){return k[P.s]-k[F.s]||F.f-P.f});a<n;++a){var O=l[a].s;if(k[O]>t)M+=S-(1<<A-k[O]),k[O]=t;else break}for(M>>>=N;M>0;){var _=l[a].s;k[_]<t?M-=1<<t-k[_]++-1:++a}for(;a>=0&&M;--a){var v=l[a].s;k[v]==t&&(--k[v],++M)}A=t}return[new u8(k),A]},ln=function(e,t,r){return e.s==-1?Math.max(ln(e.l,t,r+1),ln(e.r,t,r+1)):t[e.s]=r},lc=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new u16(++t),a=0,n=e[0],l=1,f=function(h){r[a++]=h},s=1;s<=t;++s)if(e[s]==n&&s!=t)++l;else{if(!n&&l>2){for(;l>138;l-=138)f(32754);l>2&&(f(l>10?l-11<<5|28690:l-3<<5|12305),l=0)}else if(l>3){for(f(n),--l;l>6;l-=6)f(8304);l>2&&(f(l-3<<5|8208),l=0)}for(;l--;)f(n);l=1,n=e[s]}return[r.subarray(0,a),t]},clen=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},wfblk=function(e,t,r){var a=r.length,n=shft(t+2);e[n]=a&255,e[n+1]=a>>>8,e[n+2]=e[n]^255,e[n+3]=e[n+1]^255;for(var l=0;l<a;++l)e[n+l+4]=r[l];return(n+4+a)*8},wblk=function(e,t,r,a,n,l,f,s,h,p,d){wbits(t,d++,r),++n[256];for(var y=hTree(n,15),g=y[0],k=y[1],A=hTree(l,15),M=A[0],N=A[1],S=lc(g),O=S[0],_=S[1],v=lc(M),C=v[0],F=v[1],P=new u16(19),R=0;R<O.length;++R)P[O[R]&31]++;for(var R=0;R<C.length;++R)P[C[R]&31]++;for(var U=hTree(P,7),Y=U[0],ee=U[1],G=19;G>4&&!Y[clim[G-1]];--G);var ce=p+5<<3,W=clen(n,flt)+clen(l,fdt)+f,se=clen(n,g)+clen(l,M)+f+14+3*G+clen(P,Y)+(2*P[16]+3*P[17]+7*P[18]);if(ce<=W&&ce<=se)return wfblk(t,d,e.subarray(h,h+p));var ge,z,K,le;if(wbits(t,d,1+(se<W)),d+=2,se<W){ge=hMap(g,k,0),z=g,K=hMap(M,N,0),le=M;var ie=hMap(Y,ee,0);wbits(t,d,_-257),wbits(t,d+5,F-1),wbits(t,d+10,G-4),d+=14;for(var R=0;R<G;++R)wbits(t,d+3*R,Y[clim[R]]);d+=3*G;for(var re=[O,C],H=0;H<2;++H)for(var ae=re[H],R=0;R<ae.length;++R){var pe=ae[R]&31;wbits(t,d,ie[pe]),d+=Y[pe],pe>15&&(wbits(t,d,ae[R]>>>5&127),d+=ae[R]>>>12)}}else ge=flm,z=flt,K=fdm,le=fdt;for(var R=0;R<s;++R)if(a[R]>255){var pe=a[R]>>>18&31;wbits16(t,d,ge[pe+257]),d+=z[pe+257],pe>7&&(wbits(t,d,a[R]>>>23&31),d+=fleb[pe]);var o=a[R]&31;wbits16(t,d,K[o]),d+=le[o],o>3&&(wbits16(t,d,a[R]>>>5&8191),d+=fdeb[o])}else wbits16(t,d,ge[a[R]]),d+=z[a[R]];return wbits16(t,d,ge[256]),d+z[256]},deo=new u32([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),et=new u8(0),dflt=function(e,t,r,a,n,l){var f=e.length,s=new u8(a+f+5*(1+Math.ceil(f/7e3))+n),h=s.subarray(a,s.length-n),p=0;if(!t||f<8)for(var d=0;d<=f;d+=65535){var y=d+65535;y>=f&&(h[p>>3]=l),p=wfblk(h,p+1,e.subarray(d,y))}else{for(var g=deo[t-1],k=g>>>13,A=g&8191,M=(1<<r)-1,N=new u16(32768),S=new u16(M+1),O=Math.ceil(r/3),_=2*O,v=function(fe){return(e[fe]^e[fe+1]<<O^e[fe+2]<<_)&M},C=new u32(25e3),F=new u16(288),P=new u16(32),R=0,U=0,d=0,Y=0,ee=0,G=0;d<f;++d){var ce=v(d),W=d&32767,se=S[ce];if(N[W]=se,S[ce]=W,ee<=d){var ge=f-d;if((R>7e3||Y>24576)&&ge>423){p=wblk(e,h,0,C,F,P,U,Y,G,d-G,p),Y=R=U=0,G=d;for(var z=0;z<286;++z)F[z]=0;for(var z=0;z<30;++z)P[z]=0}var K=2,le=0,ie=A,re=W-se&32767;if(ge>2&&ce==v(d-re))for(var H=Math.min(k,ge)-1,ae=Math.min(32767,d),pe=Math.min(258,ge);re<=ae&&--ie&&W!=se;){if(e[d+K]==e[d+K-re]){for(var o=0;o<pe&&e[d+o]==e[d+o-re];++o);if(o>K){if(K=o,le=re,o>H)break;for(var u=Math.min(re,o-2),c=0,z=0;z<u;++z){var T=d-re+z+32768&32767,I=N[T],B=T-I+32768&32767;B>c&&(c=B,se=T)}}}W=se,se=N[W],re+=W-se+32768&32767}if(le){C[Y++]=268435456|revfl[K]<<18|revfd[le];var Q=revfl[K]&31,ne=revfd[le]&31;U+=fleb[Q]+fdeb[ne],++F[257+Q],++P[ne],ee=d+K,++R}else C[Y++]=e[d],++F[e[d]]}}p=wblk(e,h,l,C,F,P,U,Y,G,d-G,p),!l&&p&7&&(p=wfblk(h,p+1,et))}return slc(s,0,a+shft(p)+n)},crct=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var r=t,a=9;--a;)r=(r&1&&-306674912)^r>>>1;e[t]=r}return e}(),crc=function(){var e=-1;return{p:function(t){for(var r=e,a=0;a<t.length;++a)r=crct[r&255^t[a]]^r>>>8;e=r},d:function(){return~e}}},dopt=function(e,t,r,a,n){return dflt(e,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):12+t.mem,r,a,!n)},wbytes=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},gzh=function(e,t){var r=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:t.level==9?2:0,e[9]=3,t.mtime!=0&&wbytes(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),r){e[3]=8;for(var a=0;a<=r.length;++a)e[a+10]=r.charCodeAt(a)}},gzs=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&err(6,"invalid gzip data");var t=e[3],r=10;t&4&&(r+=e[10]|(e[11]<<8)+2);for(var a=(t>>3&1)+(t>>4&1);a>0;a-=!e[r++]);return r+(t&2)},gzl=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},gzhl=function(e){return 10+(e.filename&&e.filename.length+1||0)},zlv=function(e){((e[0]&15)!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)&&err(6,"invalid zlib data"),e[1]&32&&err(6,"invalid zlib data: preset dictionaries not supported")};function inflateSync(e,t){return inflt(e,t)}function gzipSync(e,t){t||(t={});var r=crc(),a=e.length;r.p(e);var n=dopt(e,t,gzhl(t),8),l=n.length;return gzh(n,t),wbytes(n,l-8,r.d()),wbytes(n,l-4,a),n}function gunzipSync(e,t){return inflt(e.subarray(gzs(e),-8),t||new u8(gzl(e)))}function unzlibSync(e,t){return inflt((zlv(e),e.subarray(2,-4)),t)}function decompressSync(e,t){return e[0]==31&&e[1]==139&&e[2]==8?gunzipSync(e,t):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?inflateSync(e,t):unzlibSync(e,t)}var te=typeof TextEncoder!="undefined"&&new TextEncoder,td=typeof TextDecoder!="undefined"&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch(e){}var dutf8=function(e){for(var t="",r=0;;){var a=e[r++],n=(a>127)+(a>223)+(a>239);if(r+n>e.length)return[t,slc(e,r-1)];n?n==3?(a=((a&15)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,t+=String.fromCharCode(55296|a>>10,56320|a&1023)):n&1?t+=String.fromCharCode((a&31)<<6|e[r++]&63):t+=String.fromCharCode((a&15)<<12|(e[r++]&63)<<6|e[r++]&63):t+=String.fromCharCode(a)}};function strToU8(e,t){if(t){for(var r=new u8(e.length),a=0;a<e.length;++a)r[a]=e.charCodeAt(a);return r}if(te)return te.encode(e);for(var n=e.length,l=new u8(e.length+(e.length>>1)),f=0,s=function(d){l[f++]=d},a=0;a<n;++a){if(f+5>l.length){var h=new u8(f+8+(n-a<<1));h.set(l),l=h}var p=e.charCodeAt(a);p<128||t?s(p):p<2048?(s(192|p>>6),s(128|p&63)):p>55295&&p<57344?(p=65536+(p&1023<<10)|e.charCodeAt(++a)&1023,s(240|p>>18),s(128|p>>12&63),s(128|p>>6&63),s(128|p&63)):(s(224|p>>12),s(128|p>>6&63),s(128|p&63))}return slc(l,0,f)}function strFromU8(e,t){if(t){for(var r="",a=0;a<e.length;a+=16384)r+=String.fromCharCode.apply(null,e.subarray(a,a+16384));return r}else{if(td)return td.decode(e);var n=dutf8(e),l=n[0],f=n[1];return f.length&&err(8),l}}function sleep(e){return new Promise(t=>setTimeout(t,e))}window.db=new Localbase("vuejx_app");async function saveToIndexedDB(e,t){await window.db.collection(e).doc(t.id).update(t).catch(()=>{window.db.collection(e).add(t,t.id).catch(r=>{console.log("errorerrorerror",e,r)})})}async function userById(e){let t=null;var r=`query add($token: String, $db: String, $collection: String, $id: String, $keys: JSON) {
        userById: userById(token: $token, db: $db, collection: $collection, id: $id, keys: $keys)
    }`;return await window.Vue.$axios.post("/vuejx/",{query:r,variables:{token:localStorage.getItem("token"),db:localStorage.getItem("db"),collection:e.collection,id:e.id,keys:e.keys}}).then(a=>{t=a.data.data.userById}).catch(a=>{t={}}),t}async function userUpdateMany(e){let t=null;var r=`mutation add($token: String, $db: String, $collection: String, $body: JSON, $filter: JSON, $sort: JSON, $skip: Int, $limit: Int, $actionCode: String) {
        userUpdateMany: userUpdateMany(token: $token, db: $db, collection: $collection, body: $body, filter: $filter, sort: $sort, skip: $skip, limit: $limit, actionCode: $actionCode)
      }`;return await window.Vue.$axios.post("/vuejx/",{query:r,variables:{token:localStorage.getItem("token"),db:localStorage.getItem("db"),collection:e.collection,body:e.body,filter:e.filter,sort:e.sort,skip:e.skip,limit:e.limit,actionCode:e.actionCode}}).then(a=>{t=a.data.data.userUpdateMany}).catch(a=>{t={}}),t}async function userOne(e){let t=null;var r=`query add($token: String, $db: String, $collection: String, $filter: JSON, $skip: Int, $sort: JSON, $keys: JSON) {
        userOne: userOne(token: $token, db: $db, collection: $collection, filter: $filter, skip: $skip, sort: $sort, keys: $keys)
      }`;return await window.Vue.$axios.post("/vuejx/",{query:r,variables:{token:localStorage.getItem("token"),db:localStorage.getItem("db"),collection:e.collection,filter:e.filter,skip:e.skip,sort:e.sort,keys:e.keys}}).then(a=>{t=a.data.data.userOne}).catch(a=>{t={}}),t}async function processData(e){window.Vue.loadingBar.start();let t=null,r=null;return e&&e.body._id&&typeof e.body._id=="string"&&(r=`mutation add($token: String, $db: String, $collection: String, $body: JSON, $actionCode: String) {
            queryAction: userUpdateById(token: $token, db: $db, collection: $collection, body: $body, actionCode: $actionCode)
        }`),r||(r=`mutation add($token: String, $db: String, $collection: String, $body: JSON, $actionCode: String) {
            queryAction: userCreate(token: $token, db: $db, collection: $collection, body: $body, actionCode: $actionCode)
        }`),await window.Vue.$axios.post("/vuejx/",{query:r,variables:{token:localStorage.getItem("token"),db:localStorage.getItem("db"),collection:e.collection,body:e.body,actionCode:e.actionCode?e.actionCode:"NEW"}}).then(a=>{t=a.data.data.queryAction,window.Vue.toastr.success("Y\xEAu c\u1EA7u c\u1EE7a b\u1EA1n \u0111\u01B0\u1EE3c th\u1EF1c hi\u1EC7n th\xE0nh c\xF4ng."),window.Vue.loadingBar.finish()}).catch(a=>{window.Vue.toastr.error("Y\xEAu c\u1EA7u c\u1EE7a b\u1EA1n \u0111\u01B0\u1EE3c th\u1EF1c hi\u1EC7n th\u1EA5t b\u1EA1i."),window.Vue.loadingBar.error(),t=null}),t}async function htmlToPdf(e){window.Vue.loadingBar.start(),window.Vue.$axios.post("/vuejx/docx/topdf",e,{responseType:"arraybuffer",headers:{Authorization:"Bearer "+localStorage.getItem("token"),token:localStorage.getItem("token"),"Content-Type":"application/json",Accept:"application/octet-stream"}}).then(t=>{window.Vue.loadingBar.finish();const r=new Blob([t.data],{type:"application/octet-stream"});var a=document.createElement("a");a.href=window.URL.createObjectURL(r),a.download=e.dataId,document.body.appendChild(a),a.click(),document.body.removeChild(a)}).catch(t=>{window.Vue.loadingBar.error(),console.log(t)})}async function xlsxtemplate(e){window.Vue.loadingBar.start(),window.Vue.$axios.post("/vuejx/docx/generateexcel",e,{responseType:"arraybuffer",headers:{Authorization:"Bearer "+localStorage.getItem("token"),token:localStorage.getItem("token"),"Content-Type":"application/json",Accept:"application/octet-stream"}}).then(t=>{window.Vue.loadingBar.finish();const r=new Blob([t.data],{type:"application/octet-stream"});var a=document.createElement("a");a.href=window.URL.createObjectURL(r),a.download=e.dataId&&e.dataId.endsWith(".pdf")?e.dataId:e.collection+".xlsx",document.body.appendChild(a),a.click(),document.body.removeChild(a)}).catch(t=>{window.Vue.loadingBar.error(),console.log(t)})}async function docxtemplate(e){window.Vue.loadingBar.start(),window.Vue.$axios.post("/vuejx/docx/generate",e,{responseType:"arraybuffer",headers:{Authorization:"Bearer "+localStorage.getItem("token"),token:localStorage.getItem("token"),"Content-Type":"application/json",Accept:"application/octet-stream"}}).then(t=>{window.Vue.loadingBar.finish();const r=new Blob([t.data],{type:"application/octet-stream"});var a=document.createElement("a");a.href=window.URL.createObjectURL(r),a.download=e.dataId+".docx",document.body.appendChild(a),a.click(),document.body.removeChild(a)}).catch(t=>{window.Vue.loadingBar.error(),console.log(t)})}async function graphqlQuery(e,t){let r=null;return await window.Vue.$axios.post("/vuejx/",{query:e,variables:t}).then(a=>{r=a.data.data}).catch(a=>{r=null}),r}async function search(e,t,r,a,n,l,f,s,h,p,d,y){let g=[],k=[],A=[],M="",N=1,S={dataResults:[],totalRecord:0,pages:1,page:1,sortBack:[],sortNext:[],size:15,bodyQuery:null};const O=window.Vue.router.currentRoute.value;for(let v in a)if((O.query[a[v].key]||O.query[a[v].key+"_from"]||O.query[a[v].key+"_to"])&&p){let C={};if(Array.isArray(O.query[a[v].key])){let F={bool:{should:[],must:[]}};for(let P of O.query[a[v].key]){let R={},U={bool:{must:[]}};if(a[v].dataType==="boolean")R[a[v].key]=String(P)==="0"?"false":"true",a[v].multiple===!0?a[v].key.endsWith(".raw")?Object.keys(R).length>0&&F.bool.must.push({match_phrase_prefix:R}):Object.keys(R).length>0&&F.bool.must.push({match:R}):a[v].key.endsWith(".raw")?Object.keys(R).length>0&&F.bool.should.push({match_phrase_prefix:R}):Object.keys(R).length>0&&F.bool.should.push({match:R});else{a[v].key.endsWith(".raw")?(R[a[v].key]=P!=="NULL"?P:"",Object.keys(R).length>0&&U.bool.must.push({match_phrase_prefix:R})):a[v].key.endsWith(".keyword")?(R[a[v].key]=P!=="NULL"?P:"",Object.keys(R).length>0&&U.bool.must.push({match:R})):(R[a[v].key]=P!=="NULL"?P:"",Object.keys(R).length>0&&U.bool.must.push({match:R}));let Y=P.split(" ");for(const ee of Y){let G={};G[a[v].key]=String(ee).toLocaleLowerCase(),G[a[v].key]&&String(G[a[v].key]).indexOf("/")!=-1&&(G[a[v].key]=String(G[a[v].key]).substring(0,String(G[a[v].key]).indexOf("/"))),Object.keys(G).length>0&&U.bool.must.push({prefix:G})}Object.keys(U).length>0&&(a[v].multiple===!0?F.bool.must.push(U):F.bool.should.push(U))}}g.push(F)}else{let F={bool:{must_not:[],must:[],should:[]}};if(a[v].relation!=="range"&&a[v].relation!=="date"&&a[v].relation!=="date_range")if(a[v].dataType==="boolean")C[a[v].key]=String(O.query[a[v].key])==="0"?"false":"true",a[v].key.endsWith(".raw")?Object.keys(C).length>0&&g.push({match_phrase_prefix:C}):Object.keys(C).length>0&&g.push({match:C});else{if(a[v].key.endsWith(".raw")){C[a[v].key]=O.query[a[v].key]!=="NULL"?O.query[a[v].key]:"",Object.keys(C).length>0&&F.bool.must.push({match_phrase_prefix:C});let P=O.query[a[v].key].split(" ");for(const R of P){let U={};if(U[a[v].key]=String(R).toLocaleLowerCase(),U[a[v].key]&&String(U[a[v].key]).indexOf("/")!=-1&&(U[a[v].key]=String(U[a[v].key]).substring(0,String(U[a[v].key]).indexOf("/"))),Object.keys(U).length>0){if(String(R).toLocaleLowerCase().indexOf(".")!==-1||String(R).toLocaleLowerCase().indexOf("-")!==-1||String(R).toLocaleLowerCase().indexOf("\u2013")!==-1||String(R).toLocaleLowerCase().indexOf(",")!==-1||String(R).toLocaleLowerCase().indexOf("(")!==-1||String(R).toLocaleLowerCase().indexOf("/")!==-1)break;F.bool.must.push({prefix:U})}}}else C[a[v].key]=O.query[a[v].key]!=="NULL"?O.query[a[v].key]:"",O.query[a[v].key]==="NULL"?F.bool.should=[{bool:{must_not:{exists:{field:a[v].key}}}},{match:C}]:Object.keys(C).length>0&&F.bool.must.push({match:C});g.push(F)}else if(a[v].relation==="range"){const P=parseInt(O.query[a[v].key+"_from"]);let R={};if(R[a[v].key]={gte:P},O.query[a[v].key+"_to"]){const U=parseInt(O.query[a[v].key+"_to"]);R[a[v].key].lt=U}g.push({range:R})}else if(a[v].relation==="date"){const P=new Date(parseInt(O.query[a[v].key]));let R=P.getFullYear(),U=P.getMonth()+1;U=U<10?"0"+U:U;let Y=P.getDate()<10?"0"+P.getDate():P.getDate(),ee={};ee[a[v].key]={time_zone:"+07:00",gte:R+"-"+U+"-"+Y,lte:R+"-"+U+"-"+Y},g.push({range:ee})}else if(a[v].relation==="date_range"){const P=new Date(parseInt(O.query[a[v].key+"_from"]));let R=P.getFullYear(),U=P.getMonth()+1;U=U<10?"0"+U:U;let Y=P.getDate()<10?"0"+P.getDate():P.getDate(),ee={};if(ee[a[v].key]={time_zone:"+07:00",gte:R+"-"+U+"-"+Y},O.query[a[v].key+"_to"]){const G=new Date(parseInt(O.query[a[v].key+"_to"]));let ce=G.getFullYear(),W=G.getMonth()+1;W=W<10?"0"+W:W;let se=G.getDate()<10?"0"+G.getDate():G.getDate();ee[a[v].key].lte=ce+"-"+W+"-"+se}g.push({range:ee})}}}if(O.query.keywords&&p){let v={bool:{should:[]}};for(let C in r){let F={bool:{must:[]}},P=String(O.query.keywords).toLocaleLowerCase().replace(/,/g," ").replace(/\./g," ").replace(/-/g," ").replace(/–/g," ").replace(/:/g," ").replace(/\//g," ").replace(/  /g," ").split(" ");if(r[C].endsWith(".raw")){let R={};R[r[C]]=String(O.query.keywords).toLocaleLowerCase(),Object.keys(R).length>0&&F.bool.must.push({match_phrase_prefix:R});for(const U of P){let Y={};if(Y[r[C]]=String(U).toLocaleLowerCase(),Y[r[C]]&&String(Y[r[C]]).indexOf("/")!=-1&&(Y[r[C]]=String(Y[r[C]]).substring(0,String(Y[r[C]]).indexOf("/"))),Object.keys(Y).length>0){if(String(U).toLocaleLowerCase().indexOf(".")!==-1||String(U).toLocaleLowerCase().indexOf("-")!==-1||String(U).toLocaleLowerCase().indexOf("\u2013")!==-1||String(U).toLocaleLowerCase().indexOf(",")!==-1||String(U).toLocaleLowerCase().indexOf("(")!==-1||String(U).toLocaleLowerCase().indexOf("/")!==-1)break;F.bool.must.push({prefix:Y})}}}else if(r[C].endsWith(".keyword")){let R={};R[r[C]]=String(O.query.keywords).toLocaleLowerCase(),Object.keys(R).length>0&&F.bool.must.push({match:R})}else if(r[C]==="shortName"||r[C]==="MaMuc"){let R={};R[r[C]]=String(O.query.keywords),Object.keys(R).length>0&&F.bool.must.push({match:R})}else for(let R of P){let U={};R!==""&&(U[r[C]]=R,Object.keys(U).length>0&&F.bool.must.push({match:U}))}v.bool.should.push(F)}g.push(v)}let _={size:h,query:{bool:{filter:{match:{site:localStorage.getItem("site")}},must:[]}}};if(_.highlight={pre_tags:["<es_em>"],post_tags:["</es_em>"],fields:{"*":{}}},l!==null&&(_._source={includes:l}),f!==null?_.sort=JSON.parse(JSON.stringify(f)):_.sort=[],s?_.query.bool.must.push(s):_.query.bool.must.push({match:{storage:"regular"}}),n)for(const v of n)_.query.bool.must.push(v);if(g!==void 0)for(const v of g)_.query.bool.must.push(v);if(y)typeof y.sortNext=="string"&&y.sortNext?k=JSON.parse(decodeURIComponent(y.sortNext)):k=y.sortNext?y.sortNext:[],typeof y.sortBack=="string"&&y.sortBack?A=JSON.parse(decodeURIComponent(y.sortBack)):A=y.sortBack?y.sortBack:[],M=y.paggingType,y.sizeLast&&(d=y.sizeLast),h=y.size,S.size=h,N=y.page,S.page=N;else{const v=new URLSearchParams(window.location.href);v.get("_s_n")&&(k=JSON.parse(decodeURIComponent(v.get("_s_n")))),v.get("_s_b")&&(A=JSON.parse(decodeURIComponent(v.get("_s_b")))),v.get("_pagging")&&(M=v.get("_pagging")),v.get("_rows")&&p&&(h=v.get("_rows"),S.size=h),v.get("_sizeLast")&&(d=v.get("_sizeLast")),v.get("_page")&&p&&(N=v.get("_page"),S.page=N)}if(_.from=0,_.size=h,M==="next"&&N!=1){if(Array.isArray(k)&&k.length>0){_.search_after=k,delete _.from,_.sort=[];let v=!1;d&&d!=h&&(_.size=d);for(let C of f)if(typeof C=="object"){let F={};F[Object.keys(C)[0]]=C[Object.keys(C)[0]],_.sort.push(F),Object.keys(C)[0]==="id.keyword"&&(v=!0)}v||_.sort.push({"id.keyword":"asc"})}}else if(M==="prev"&&N!=1){if(Array.isArray(A)&&A.length>0){_.search_after=A,delete _.from,_.sort=[];let v=!1;for(let C of f)if(typeof C=="object"){let F={};C[Object.keys(C)[0]]==="asc"?F[Object.keys(C)[0]]="desc":F[Object.keys(C)[0]]="asc",_.sort.push(F),Object.keys(C)[0]==="id.keyword"&&(v=!0)}v||_.sort.push({"id.keyword":"desc"})}}else if(M==="last"&&N!=1){_.size=d,delete _.from,_.sort=[];let v=!1;for(let C of f)if(typeof C=="object"){let F={};C[Object.keys(C)[0]]==="asc"?F[Object.keys(C)[0]]="desc":F[Object.keys(C)[0]]="asc",_.sort.push(F),Object.keys(C)[0]==="id.keyword"&&(v=!0)}v||_.sort.push({"id.keyword":"desc"})}else if(M==="first"){delete _.from,_.sort=[];let v=!1;for(let C of f)if(typeof C=="object"){let F={};F[Object.keys(C)[0]]=C[Object.keys(C)[0]],_.sort.push(F),Object.keys(C)[0]==="id.keyword"&&(v=!0)}v||_.sort.push({"id.keyword":"asc"})}else _.sort.push({"id.keyword":"asc"});return S.bodyQuery=_,e.$emit("body_query",_),await window.VueJX.dispatch("vuejx_manager/graphqlQuery",{query:`
            query search($token: String, $body: JSON, $db: String, $collection: String) {
                results: search(token: $token, body: $body, db: $db, collection: $collection )
            }
        `,variables:{body:_,db:localStorage.getItem("db"),collection:t}}).then(async v=>{let C=[];if(v.results!==null&&v.results!==void 0&&(C=v.results.hits.hits,S.totalRecord=v.results.hits.total.value,typeof S.totalRecord=="object"&&(S.totalRecord=S.totalRecord.count),e.$emit("init_total",S.totalRecord)),(M==="prev"||M==="last")&&N!=1?(!window.Vue&&!window.Vue.reverse&&await window.sleep(500),S.dataResults=window.Vue.reverse(C)):S.dataResults=C,S.dataResults.length>0&&(S.sortBack=S.dataResults[0].sort,S.sortNext=S.dataResults[S.dataResults.length-1].sort),S.totalRecord>h){let F=Math.floor(S.totalRecord/h);S.totalRecord%h>0&&(F=F+1),S.pages=F}else N=1,S.pages=1;e.$emit("init",S.dataResults)}).catch(v=>{e.$emit("init",[]),S.dataResults=[]}),S}async function aggsData(e,t,r,a,n,l,f,s,h,p,d,y,g,k,A,M,N,S){let O={},_=window.Vue.router.currentRoute.value,v=!1,C=localStorage.getItem("site");_.query.hasOwnProperty("adv_filter")&&String(_.query.adv_filter)==="true"&&(v=!0);let F=[],P=[],R=[];(_.query[r.keyAggs]===void 0||_.query[r.keyAggs]===null||_.query[r.keyAggs]==="")&&(P=[],R=[]);for(let z in p)if(r.keyAggs==p[z].key&&p[z].key==_.query._state_aggs)console.log('re_calculator[key]["key"]',r.keyAggs,p[z].key,_.query._state_aggs);else if(_.query[p[z].key]&&y)if(Array.isArray(_.query[p[z].key])){let K={bool:{should:[],must:[]}};for(let le of _.query[p[z].key]){let ie={};p[z].relation==="eq"&&p[z].keyType==="multiple"?p[z].dataType==="boolean"?(ie[p[z].key]=String(le)==="0"?"false":"true",p[z].key.endsWith(".raw")?K.bool.must.push({match_phrase_prefix:ie}):K.bool.must.push({match:ie})):(ie[p[z].key]=le!=="NULL"?le:"",p[z].key.endsWith(".raw")?K.bool.must.push({match_phrase_prefix:ie}):K.bool.must.push({match:ie})):p[z].relation==="eq"&&p[z].keyType!=="multiple"&&(p[z].dataType==="boolean"?(ie[p[z].key]=String(le)==="0"?"false":"true",p[z].key.endsWith(".raw")?K.bool.should.push({match_phrase_prefix:ie}):K.bool.should.push({match:ie})):(ie[p[z].key]=le!=="NULL"?le:"",p[z].key.endsWith(".raw")?K.bool.should.push({match_phrase_prefix:ie}):K.bool.should.push({match:ie})))}F.push(K)}else{let K={};if(p[z].relation!=="range")p[z].dataType==="boolean"?(K[p[z].key]=String(_.query[p[z].key])==="0"?"false":"true",p[z].key.endsWith(".raw")?F.push({match_phrase_prefix:K}):F.push({match:K})):(K[p[z].key]=_.query[p[z].key]!=="NULL"?_.query[p[z].key]:"",p[z].key.endsWith(".raw")?F.push({match_phrase_prefix:K}):F.push({match:K}));else if(p[z].relation==="range"){let le="";if(_.query[p[z].key].indexOf("-")>0){let[ie,re]=_.query[p[z].key].split("-"),H="{";ie!=="*"&&(H=H+'"gte":'+ie),re!=="*"&&(ie!=="*"&&(H=H+", "),H=H+'"lt":'+re),H=H+" }",le=`
                            {
                                "range": {
                                    "`+p[z].key+'": '+H+`
                                }
                            }
                        `}F.push(JSON.parse(le))}}if(_.query.keywords!==void 0&&_.query.keywords!==""&&y){let z={bool:{should:[]}};for(let K in d){let le={bool:{must:[]}};if(d[K].endsWith(".raw")){let ie={};ie[d[K]]=String(_.query.keywords).toLocaleLowerCase().replace(/,/g," ").replace(/\./g," ").replace(/-/g," ").replace(/–/g," ").replace(/:/g," ").replace(/\//g," ").replace(/  /g," "),le.bool.must.push({match_phrase_prefix:ie})}else{let ie=String(_.query.keywords).toLocaleLowerCase().replace(/,/g," ").replace(/\./g," ").replace(/-/g," ").replace(/–/g," ").replace(/:/g," ").replace(/\//g," ").replace(/  /g," ").split(" ");for(let re of ie){let H={};re!==""&&(H[d[K]]=re,le.bool.must.push({match:H}))}}z.bool.should.push(le)}F.push(z)}let U=[{_count:{order:"desc"}}];r._termAggs&&(U=[]),r.order&&(U=r.order);let Y=n*a-a;Y<0&&(Y=0);let ee={size:0,query:{bool:{filter:{match:{site:C}},must:[]}},aggs:{report:{filter:{bool:{must_not:s,must:[],filter:{match:{site:C}}}},aggs:{aggregations:{terms:{size:1e4,field:r.keyAggs},aggs:{aggs_sort:{bucket_sort:{sort:U,size:a,from:Y}},top_el_hits:{top_hits:{_source:{includes:[r.keyAggs,r.keyAggs.replace(l,f),r.keyAggs.replace(l,"type")]},size:1}}}}}}}};if(t==="range"){let z=[];for(const K of M)z.push({from:K.from,to:K.to});ee.aggs.report.aggs={report:{range:{field:r.keyAggs,ranges:z}}}}else if(t==="fulltext"){let z=1,K={_count:"desc"};r.min_doc_count&&(z=r.min_doc_count),r.order&&(K=r.order),ee.aggs.report.aggs={aggregations:{terms:{size:r.sizeAggs,field:r.keyAggs,min_doc_count:z,order:K}}}}else if(t==="custom")ee.aggs=S;else{if(Array.isArray(r.includes))for(let z of r.includes)ee.aggs.report.aggs.aggregations.aggs.top_el_hits.top_hits._source.includes.push(z);r._termAggs&&(ee.aggs.report.aggs.aggregations.terms.order={_term:r._termAggs?r._termAggs:"asc"})}if(h!==null){let z=!0;for(const K of h)K.match!==void 0&&K.match!==null&&K.match.hasOwnProperty("storage")&&(z=!1),ee.query.bool.must.push(K);z&&ee.query.bool.must.push({match:{storage:"regular"}})}else ee.query.bool.must.push({match:{storage:"regular"}});if(F!=null&&F.length>0)for(const z of F)(v||z.hasOwnProperty("bool")||z.hasOwnProperty("match")&&!z.match.hasOwnProperty(r.keyAggs)||z.hasOwnProperty("match_phrase_prefix")&&!z.match_phrase_prefix.hasOwnProperty(r.keyAggs))&&ee.query.bool.must.push(z);let G=[],ce="";k?(P=[],R=[]):P=[];const W=_.query[r.keyAggs];let se={},ge={};return await window.Vue.$root.dispatch("vuejx_manager/graphqlQuery",{query:`
                query search($token: String, $bodyAggs: JSON, $dbAggs: String, $collectionAggs: String, $publicData: String) {
                    aggs: aggs(token: $token, body: $bodyAggs, db: $dbAggs, collection: $collectionAggs, publicData: $publicData )
                }
            `,variables:{bodyAggs:ee,dbAggs:localStorage.getItem("db"),collectionAggs:r.collectionAggs,publicData:g}}).then(async z=>{ce="";let K=-1,le={};if(t==="fulltext"){let ie=z.aggs.aggregations.report.doc_count;O.showPaggingSizeTotal=ie,n*r.sizeAggs>=ie||r.sizeAggs>=ie?A=0:A=1,G=[];for(const re of z.aggs.aggregations.report.aggregations.buckets){let H=re.key;if(N&&N.ignore_prefix)if(String(N.ignore_prefix).indexOf(",")!=-1){const ae=String(N.ignore_prefix).split(",");for(const pe of ae)H=String(H).replace(pe,"")}else H=String(H).replace(N.ignore_prefix,"");else N&&(H=N[re.key]);if(H||(H="NULL"),G.push({code:re.key?re.key:"NULL",name:String(H).trim(),y:re.doc_count,counter:re.key?re.doc_count:""}),K=K+1,Array.isArray(W)){for(const ae of W)if(String(re.key?re.key:"NULL")===String(ae)){k?P.push(K):P=[K];break}}else String(re.key?re.key:"NULL")===String(W)&&(k?P.push(K):P=[K])}R=P}else if(t==="range"){for(const H of z.aggs.aggregations.report.report.buckets)le[H.from+"-"+H.to]=H.doc_count>0?H.doc_count:"";G=[];let ie=_.query[r.keyAggs+"_from"],re=_.query[r.keyAggs+"_to"];for(const H of M)G.push({code:H.from+"-"+H.to,name:String(H[f]).trim(),counter:le[H.from+"-"+H.to]!==void 0?le[H.from+"-"+H.to]:0,y:le[H.from+"-"+H.to]!==void 0?le[H.from+"-"+H.to]:0}),K=K+1,String(H.from+"-"+H.to)===ie+"-"+re&&(k?P.push(K):P=[K]);R=P}else if(t==="custom")O.aggs=z.aggs;else{for(const ie of z.aggs.aggregations.report.aggregations.buckets){let re="",H=ie.key;if(ie.top_el_hits&&ie.top_el_hits.hits.hits){for(const ae of ie.top_el_hits.hits.hits)if(k)if(String(r.keyAggs).indexOf(".")!==-1){const pe=r.keyAggs.split(".")[0];if(Array.isArray(ae._source[pe])){for(let o of ae._source[pe])if(o._source[l]==H){re=o._source[f],ce=o._source.type;break}}else if(window.Vue.objectView(ae,"_source."+r.keyAggs,"")==H){re=window.Vue.objectView(ae,"_source."+r.keyAggs.replace(l,f),""),ce=window.Vue.objectView(ae,"_source."+r.keyAggs.replace(l,"type"),"");break}}else{const pe=r.keyAggs;if(Array.isArray(ae._source[pe])){for(let o of ae._source[pe])if(o._source[l]==H){re=o._source[f],ce=o._source.type;break}}else if(window.Vue.objectView(ae,"_source."+r.keyAggs,"")==H){re=window.Vue.objectView(ae,"_source."+r.keyAggs.replace(l,f),""),ce=window.Vue.objectView(ae,"_source."+r.keyAggs.replace(l,"type"),"");break}}else if(window.Vue.objectView(ae,"_source."+r.keyAggs,"")==H){re=window.Vue.objectView(ae,"_source."+r.keyAggs.replace(l,f),""),ce=window.Vue.objectView(ae,"_source."+r.keyAggs.replace(l,"type"),"");break}}if(N&&N.ignore_prefix)if(String(N.ignore_prefix).indexOf(",")!=-1){const ae=String(N.ignore_prefix).split(",");for(const pe of ae)re=String(re).replace(pe,"")}else re=String(re).replace(N.ignore_prefix,"");else N&&(re=N[re]);if(G.push({code:H,name:String(re).trim(),counter:ie.doc_count}),ge[H]=ie.doc_count,K=K+1,Array.isArray(W)){for(const ae of W)if(String(H)===String(ae)){k?P.push(K):P=[K];break}}else String(H)===String(W)&&(k?P.push(K):P=[K])}R=P}}).catch(z=>{if(G=[],t==="range")for(const K of M)G.push({code:K.from+"-"+K.to,name:K[f],counter:"",y:""})}),a>G.length?A=0:A=1,G.length===0?O.pageCount=n-1:O.pageCount=n,O.pageCountNext=A,O.items=G,O.selectedMenuXXX=P,O.activeArray=R,O.collectionDM=ce,O.ignore=se,e.$emit("counterObject",ge),e.$emit("result",G),O}var VueJXHeader={props:{collection:{type:String,default:()=>""},id:{type:String,default:()=>""},db:{type:String,default:()=>""},groupid:{type:String,default:()=>""},teleport:{type:String,default:()=>"default_nav"}},methods:{toPage(e){if(this.page=e.shortName,e.targetURL)e.targetMode==1?window.open(e.targetURL,"_blank"):window.location.href=e.targetURL;else{const t=window.Vue.router.currentRoute.value;window.Vue.redirect(null,!0,"/"+t.params.visibility+"/"+localStorage.getItem("site")+"/"+e.shortName,!0)}},doLogout(){try{localStorage.setItem("token",""),localStorage.setItem("user",""),localStorage.setItem("isAuthenticated",!1),window.location.href="/#/login"}catch{window.location.href="/#/login"}},toLogin(){window.location.href="/#/login"},toGroupPage(e){window.db.collection("screens").doc(e+"Nav").get().then(async t=>{t&&Array.isArray(t.page)&&t.page.length>0?window.location.href="/#/"+e+"/"+window.Vue.router.currentRoute.value.params.site+"/"+Object.values(t.page[0])[0].shortName:window.location.href="/#/"+e+"/"+window.Vue.router.currentRoute.value.params.site})},async pullNewPages(e){let t=this;e&&await window.db.collection("screens").doc(e).get().then(async r=>{if(r){t.pages=r.page;let a=!1;this.user&&Array.isArray(this.user.role)&&this.user.role.length>0&&this.user.role.indexOf("admin")!=-1&&(a=!0);for(let n of t.pages){let l=Object.keys(n)[0],f=Object.values(n)[0];if(t.perchkx(a,n,f,l),Array.isArray(f.sub___pages)&&f.sub___pages.length>0)for(let s of f.sub___pages)f=s._source,l=s._source.shortName,t.perchkx(a,s._source,f,l)}}else await window.sleep(50),await t.pullNewPages()})},perchkx(e,t,r,a){if(!e&&t&&t[a])if(r.openAccess=="2")t[a].perView=!0;else if(r.openAccess=="1"&&this.user)t[a].perView=!0;else if(r.openAccess=="0"&&this.user&&Array.isArray(r.accessRoles)&&r.accessRoles.length>0){let n=!1;for(const l of r.accessRoles)if(Array.isArray(this.user.role)&&this.user.role.length>0&&this.user.role.indexOf(l.shortName)!=-1)if(l.permission=="4"){n=!1;break}else{n=!0;break}t[a].perView=n}else this.user&&Array.isArray(this.user.role)&&this.user.role.length>0&&this.user.role.indexOf("admin")!=-1?t[a].perView=!0:t[a].perView=!1;else if(t&&t[a])if(r.openAccess=="0"&&this.user&&Array.isArray(r.accessRoles)&&r.accessRoles.length>0){let n=!1,l=!1;for(const f of r.accessRoles)if(Array.isArray(this.user.role)&&this.user.role.length>0&&this.user.role.indexOf(f.shortName)!=-1)if(l=!1,f.permission=="5"){n=!1;break}else{n=!0;break}else l=!0;l?t[a].perView=!0:t[a].perView=n}else t[a].perView=!0},async doChangePassAction(){let e=this;await window.Vue.$axios.post("/security/guest/processAccountPassword",{passwordNew:e.passwordNew,passwordNewConfirm:e.passwordConfirm,token:localStorage.getItem("token")},{headers:{db:localStorage.getItem("db"),"Content-Type":"application/json; charset=utf-8",Accept:"application/json, text/plain, */*"}}).then(t=>{e.changePass=!1}).catch(t=>{alert("\u0110\u1ED5i m\u1EADt kh\u1EA9u th\u1EA5t b\u1EA1i.")})}},watch:{$route:async function(e,t){let r=this;localStorage.getItem("user")&&(r.user=JSON.parse(localStorage.getItem("user"))),r.page=e.params.page,(e.params.visibility==="group"||e.params.visibility==="web")&&e.params.visibility!=t.params.visibility&&(console.log("watchwatchwatchNAV"),r.renderPage=!1,r.pages=[],await r.pullNewPages(e.params.visibility+"Nav"),r.renderPage=!0)}},mounted:function(){let e=this;e.renderPage=!1;let t=window.Vue.router.currentRoute.value.params.visibility;e.page=window.Vue.router.currentRoute.value.params.page,localStorage.getItem("user")&&(e.user=JSON.parse(localStorage.getItem("user"))),e.$nextTick(function(){setTimeout(async()=>{(t==="web"||t==="group")&&await e.pullNewPages(t+"Nav"),e.renderPage=!0},0)})},data:()=>({renderPage:!1,pages:[],defaultPage:"",defaultPageGroup:"",user:null,page:"",password:"",passwordNew:"",passwordConfirm:"",changePass:!1}),template:`
    <div class="vuejx__header">
        <slot name="header_top">
            <div :id="teleport"></div>
        </slot>
        
        <template v-if="renderPage">
            <Teleport :to="'#' + teleport">
                <div>
                    <div class="hd__screen">
                        <div class="top-bar">
                            <slot name="header_nav">
                                <div class="left" tabindex="0">

                                    <template v-for="(item, index) in pages">

                                        <div v-bind:key="index" class="item" tabindex="0" :class="{ active: page ? page.startsWith(Object.values(item)[0].shortName) || String(Object.values(item)[0].activePage).indexOf(page + ',') !== -1 : false, 'mr-2': Object.values(item)[0].sub___pages && Object.values(item)[0].sub___pages.length > 0 }"
                                            v-if="item && Object.values(item) && Object.values(item)[0] && Object.values(item)[0].perView"
                                        >
                                            <button aria-label="btn" class="label" @click.stop="toPage(Object.values(item)[0])"> {{ Object.values(item)[0].title }} <i v-if="Object.values(item)[0].sub___pages && Object.values(item)[0].sub___pages.length > 0" class="mdi mdi-chevron-double-down" style="margin-top: -2px;"></i> </button>
                                            <div class="dropdown" v-if="Object.values(item)[0].sub___pages && Object.values(item)[0].sub___pages.length > 0"> <div v-for="(sub, indexSub) in Object.values(item)[0].sub___pages" v-bind:key="indexSub"> <button aria-label="btn" class="dropdown-child" @click.stop="toPage(sub['_source'])"> {{ sub._source?.title }} </button> </div> </div>
                                        </div>
                                        
                                    </template>
                                    
                                </div>
                            </slot>
                            <slot name="header_login">
                                <div class="left" tabindex="0">
                                    <div class="item">
                                        <button aria-label="btn" class="label" v-if="user"> <i class="mdi mdi-account-circle" /> <span>{{ user?.title }}</span> </button>
                                        <button aria-label="btn" class="label" @click="toLogin" v-else> <i class="mdi mdi-power-settings-new" /> <span>\u0110\u0103ng nh\u1EADp</span> </button>
                                        <div class="dropdown" v-if="user">
                                            <div @click="toGroupPage('web')"> <button aria-label="btn" class="dropdown-child">Trang khai th\xE1c</button> </div>
                                            <div> <div class="divider"></div> </div>
                                            <div @click="toGroupPage('group')"> <button aria-label="btn" class="dropdown-child">Trang qu\u1EA3n tr\u1ECB</button> </div>
                                            <div> <div class="divider"></div> </div>
                                            <div @click="changePass = !changePass"> <button aria-label="btn" class="dropdown-child">\u0110\u1ED5i m\u1EADt kh\u1EA9u</button> </div>
                                            <div> <div class="divider"></div> </div>
                                            <div @click="doLogout"> <button aria-label="btn" class="dropdown-child">\u0110\u0103ng xu\u1EA5t</button> </div>
                                        </div>
                                    </div>
                                </div>
                            </slot>
                        </div>
                    </div>
                    <div class="fixed z-10 inset-0 overflow-y-auto" style="z-index: 9999;" v-if="changePass">
                        <div
                            class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"
                        >
                            <div class="fixed inset-0 transition-opacity">
                            <div class="absolute inset-0 bg-gray-100 opacity-75"></div>
                            </div>

                            <span class="hidden sm:inline-block sm:align-middle sm:h-screen"></span>
                            <div
                                class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle w-1/4"
                                role="dialog"
                                aria-modal="true"
                                aria-labelledby="modal-headline"
                                style="z-index: 9999;"
                            >
                            <div class="bg-white px-4 py-2 border-b">
                                <div class="sm:flex sm:items-start">
                                <div class="text-center sm:mt-0 sm:text-left">
                                    <h3
                                    class="text-lg leading-6 font-semibold text-gray-900"
                                    id="modal-headline"
                                    >
                                    \u0110\u1ED5i m\xE2t kh\u1EA9u
                                    </h3>
                                </div>
                                </div>
                            </div>
                            <div class="p-4">
                                <div>
                                <div class="block font-semibold leading-normal truncate">
                                    M\u1EADt kh\u1EA9u m\u1EDBi
                                    <span
                                    class="required__class"
                                    >*</span>
                                </div>
                                <input
                                    v-model="passwordNew"
                                    class="p-2 focus:outline-none focus:cursor-text w-full border border-gray-200 bg-gray-200 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
                                    type="password"
                                    placeholder="M\u1EADt kh\u1EA9u m\u1EDBi"
                                />
                                </div>
                                <div>
                                <div class="block font-semibold leading-normal truncate">
                                    X\xE1c nh\u1EADn m\u1EADt kh\u1EA9u
                                    <span
                                    class="required__class"
                                    >*</span>
                                </div>
                                <input
                                    v-model="passwordConfirm"
                                    class="p-2 focus:outline-none focus:cursor-text w-full border border-gray-200 bg-gray-200 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
                                    type="password"
                                    placeholder="M\u1EADt kh\u1EA9u m\u1EDBi"
                                />
                                </div>

                            </div>
                            <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                                <span class="flex w-full rounded-md shadow-sm sm:ml-3 sm:w-auto">
                                <button @click="doChangePassAction"
                                    type="button"
                                    class="inline-flex justify-center w-full rounded-md border border-transparent px-4 py-2 bg-red-600 text-base leading-6 font-medium text-white shadow-sm hover:bg-red-500 focus:outline-none focus:border-red-700 focus:shadow-outline-red transition ease-in-out duration-150 sm:text-sm sm:leading-5"
                                >
                                    X\xE1c nh\u1EADn
                                </button>
                                </span>
                                <span
                                class="mt-3 flex w-full rounded-md shadow-sm sm:mt-0 sm:w-auto"
                                >
                                <button @click="changePass = !changePass"
                                    type="button"
                                    class="inline-flex justify-center w-full rounded-md border border-gray-300 px-4 py-2 bg-white text-base leading-6 font-medium text-gray-700 shadow-sm hover:text-gray-500 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue transition ease-in-out duration-150 sm:text-sm sm:leading-5"
                                >
                                    Quay l\u1EA1i
                                </button>
                                </span>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>
            </Teleport>
        </template>
    </div>
    `},VueJXHeaderSimple={props:{collection:{type:String,default:()=>""},id:{type:String,default:()=>""},db:{type:String,default:()=>""},groupid:{type:String,default:()=>""}},methods:{toPage(e){if(this.page=e.shortName,e.targetURL)e.targetMode==1?window.open(e.targetURL,"_blank"):window.location.href=e.targetURL;else{const t=window.Vue.router.currentRoute.value;window.Vue.redirect(null,!0,"/"+t.params.visibility+"/"+localStorage.getItem("site")+"/"+e.shortName,!0)}},doLogout(){try{window.saveToIndexedDB("screens",{page:[],id:"groupNav"}),window.saveToIndexedDB("screens",{page:[],id:"webNav"}),localStorage.setItem("token",""),localStorage.setItem("user",""),localStorage.setItem("isAuthenticated",!1),window.location.href="/#/login"}catch{window.location.href="/#/login"}},toLogin(){window.location.href="/#/login"},toGroupPage(e){window.db.collection("screens").doc(e+"Nav").get().then(async t=>{t&&Array.isArray(t.page)&&t.page.length>0?window.location.href="/#/"+e+"/"+window.Vue.router.currentRoute.value.params.site+"/"+Object.values(t.page[0])[0].shortName:window.location.href="/#/"+e+"/"+window.Vue.router.currentRoute.value.params.site})},async pullNewPages(e){let t=this;e&&await window.db.collection("screens").doc(e).get().then(async r=>{r?(t.pages=r.page,t.renderPage=!0):(await window.sleep(50),await t.pullNewPages())})}},watch:{$route:async function(e,t){let r=this;r.renderPage=!1,(e.params.visibility==="group"||e.params.visibility==="web")&&e.params.visibility!=t.params.visibility&&(r.pages=[],await r.pullNewPages(e.params.visibility+"Nav")),localStorage.getItem("user")&&(r.user=JSON.parse(localStorage.getItem("user")))}},mounted:function(){let e=this;e.renderPage=!1;let t=window.Vue.router.currentRoute.value.params.visibility;e.page=window.Vue.router.currentRoute.value.params.page,e.$nextTick(function(){setTimeout(async()=>{(t==="web"||t==="group")&&await e.pullNewPages(t+"Nav"),localStorage.getItem("user")&&(e.user=JSON.parse(localStorage.getItem("user")))},0)})},data:()=>({renderPage:!1,pages:[],defaultPage:"",defaultPageGroup:"",user:null,page:""}),template:`
    <div class="vuejx__header" :key="pages">
        <slot name="header_top"></slot>
        <div class="hd__screen">
            <div class="top-bar">
                <slot name="header_nav">
                    <div class="left" tabindex="0">
                        <div v-for="(item, index) in pages" v-bind:key="index" class="item" tabindex="0" :class="{ active: page ? page.startsWith(Object.values(item)[0].shortName) || String(Object.values(item)[0].activePage).indexOf(page + ',') !== -1 : false }">
                            <button aria-label="btn" class="label" @click.stop="toPage(Object.values(item)[0])"> {{ Object.values(item)[0].title }} </button>
                            <div class="dropdown" v-if="Object.values(item)[0].sub___pages && Object.values(item)[0].sub___pages.length > 0"> <div v-for="(sub, indexSub) in Object.values(item)[0].sub___pages" v-bind:key="indexSub"> <button aria-label="btn" class="dropdown-child" @click.stop="toPage(sub['_source'])"> {{ sub._source?.title }} </button> </div> </div>
                        </div>
                    </div>
                </slot>
                <slot name="header_login">
                    <div class="left" tabindex="0">
                        <div class="item">
                            <button aria-label="btn" class="label" v-if="user"> <i class="mdi mdi-account-circle" /> <span>{{ user?.title }}</span> </button>
                            <button aria-label="btn" class="label" @click="toLogin" v-else> <i class="mdi mdi-power-settings-new" /> <span>\u0110\u0103ng nh\u1EADp</span> </button>
                            <div class="dropdown" v-if="user">
                                <div @click="toGroupPage('web')"> <button aria-label="btn" class="dropdown-child">Trang khai th\xE1c</button> </div>
                                <div> <div class="divider"></div> </div>
                                <div @click="toGroupPage('group')"> <button aria-label="btn" class="dropdown-child">Trang qu\u1EA3n tr\u1ECB</button> </div>
                                <div> <div class="divider"></div> </div>
                                <div @click="doLogout"> <button aria-label="btn" class="dropdown-child">\u0110\u0103ng xu\u1EA5t</button> </div>
                            </div>
                        </div>
                    </div>
                </slot>
            </div>
        </div>
    </div>
    `},Table={props:{storage:{type:Object,default:()=>null},employee__table:{type:Boolean,default:!1},idtable:{type:String,default:"table__to__export"},db:{type:String,default:()=>localStorage.getItem("db")},collection:{type:String,default:()=>""},site:{type:String,default:()=>""},includes:{type:Array,default:()=>[]},sort:{type:Array,default:()=>[]},pagesize:{type:Number,default:()=>15},paging:{type:Boolean,default:()=>!0},condition:{type:Array,default:()=>[]},queryFilter:{type:Array,default:()=>[]},keywords:{type:Array,default:()=>[]},queryParam:{type:Boolean,default:()=>!0},empty:{type:Boolean,default:()=>!1},skeleton:{type:Object,default:()=>({th:[],td:[]})}},methods:{async init(){let e=this;e.renderData=!1,e.rows=e.pagesize,e.paging||(e.rows=e.pagesize,e.page=1);const t=await window.VueJX.search(e,e.collection,e.keywords,e.queryFilter,e.condition,e.includes,e.sort,e.storage,e.rows,e.queryParam,e.sizeLast);e.dataResults=t.dataResults,e.pages=t.pages,e.page=t.page,e.totalRecord=t.totalRecord,e.sortNext=t.sortNext,e.sortBack=t.sortBack,e.rows=t.size,e.renderData=!0},dateView(e,t,r,a){return window.Vue.dateView(e,t,r,a)},objectView(e,t,r){return window.Vue.objectView(e,t,r)},toDetail(e){window.Vue.redirect([{key:"_id",value:e||"NULL"}],!1,this.detailPage)},async paggingData(e){let t=this,r=e,a=[];t.sizeLast=t.rows;const n=new URLSearchParams(window.location.href);if(e==="next"?(t.page=parseInt(t.page)+1,t.page>=t.pages&&(t.page=t.pages),Array.isArray(t.sortNext)&&t.sortNext.length>0&&(t.sortBack=t.sortNext)):e==="prev"?(t.page=parseInt(t.page)-1,n.get("_s_b")&&(t.sortNext=JSON.parse(decodeURIComponent(n.get("_s_b"))))):e==="first"?t.page=1:e==="last"&&(t.page=t.pages,t.sizeLast=t.totalRecord-t.rows*(t.page-1)),a.push({key:"t",value:new Date().getTime()}),t.page<=1?(t.page=1,r="first",a.push({key:"_s_n",value:""}),a.push({key:"_s_b",value:""})):t.page<=t.pages&&(Array.isArray(t.sortNext)&&t.sortNext.length>0&&a.push({key:"_s_n",value:encodeURIComponent(JSON.stringify(t.sortNext))}),Array.isArray(t.sortBack)&&t.sortBack.length>0&&a.push({key:"_s_b",value:encodeURIComponent(JSON.stringify(t.sortBack))})),a.push({key:"_pagging",value:r}),a.push({key:"_rows",value:t.rows}),e==="rows"?(a.push({key:"_page",value:1}),a.push({key:"_rows",value:t.rows})):a.push({key:"_page",value:t.page}),typeof window.history.pushState!="undefined"){let l="/#"+window.Vue.router.currentRoute.value.path+"?t="+new Date().getTime();for(const s of a)s.key!="t"&&(l+="&"+s.key+"="+s.value);const f=window.Vue.router.currentRoute.value.query;for(const s in f)["_page","t","_s_n","_s_b"].indexOf(s)==-1&&(l+="&"+s+"="+f[s]);window.history.pushState({},"",l),await t.init()}else window.Vue.redirect(a)}},watch:{$route:async function(e,t){let r=window.VueJX.page();if(t.params.page==r){let a=this;a.renderData=!1,await a.init(),a.renderData=!0}}},mounted:function(){let e=this;e.$nextTick(function(){e.renderData=!1,setTimeout(async()=>{await e.init(),e.renderData=!0},0)})},data:()=>({renderData:!1,site:localStorage.getItem("site"),rows:15,sizeLast:15,dataResults:[],page:1,pages:1,totalRecord:0,sortBack:[],sortNext:[],paggingType:""}),template:`
    <div class="vuejx__table overflow-hidden">
        <table v-if="!renderData" class="w-full"> <thead class="w-full"> <slot name="thead"></slot> </thead> <tbody class="w-full p-4"> <tr> <td colspan="100"> <p class="loading___table"> Ch\u1EDD trong gi\xE2y l\xE1t ... </p> </td> </tr> </tbody> </table>
        <table :id="idtable" v-else class="w-full"> <thead class="w-full"> <slot name="thead"></slot> </thead> <tbody class="w-full"> <slot name="tbody" v-bind:page="rows" v-bind:data="dataResults"></slot> </tbody> </table>
        <header v-if="renderData && paging" class="bg-white flex items-center py-1 pr-4"><div class="flex"><button class="font-semibold text-blue-700 px-2 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1"  @click="paggingData('first')"  aria-label="first"> <i class="mdi" :class="{'mdi-chevron-double-left': !loadingAction}"></i> </button><button class="font-semibold text-blue-700 pl-0 pr-2 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1" @click="paggingData('prev')" aria-label="back" > <i class="mdi" :class="{'mdi-chevron-left': !loadingAction}"></i> </button><button class="text-blue-700 px-2 py-2 leading-none focus:outline-none hover:text-primary btn__pagging" tabindex="-1" > Trang {{ page }} / {{ pages }} </button><button v-if="page < pages" class="font-semibold text-blue-700 pl-2 pr-0 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1" @click="paggingData('next')" aria-label="next" > <i class="mdi" :class="{'mdi-chevron-right': !loadingAction}"></i> </button><button v-if="page < pages" class="font-semibold text-blue-700 px-2 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1" @click="paggingData('last')" aria-label="last"><i class="mdi" :class="{'mdi-chevron-double-right': !loadingAction}"></i> </button><button class="focus:outline-none btn__pagging_info" tabindex="-1"> <div> <h4 class="font-semibold"> <span>T\u1ED5ng s\u1ED1 b\u1EA3n ghi: </span> <span class='text-blue-700'>{{totalRecord}}</span> </h4> </div> </button></div> <div class="ml-auto"> <span>Hi\u1EC3n th\u1ECB</span> <input style="width: 60px" class="text-center appearance-none bg-gray-200 text-blue-700 border border-gray-200 rounded py-1 px-1 focus:outline-none focus:bg-white focus:border-gray-400 ml-2" v-model="rows" @change="paggingData('rows')" type="text" aria-label="total" /></div></header>
    </div>
    `},tableViewKhcn={props:{table_config:{type:Array,default:()=>[]},data:{type:Object,default:()=>({})},dataResults:{type:Array,default:()=>[]},title:{type:String,default:()=>""},mode:{type:String,default:()=>"vertical"},groupBy:{type:String,default:()=>""},groupByKeyArray:{type:String,default:()=>""},footer_header:{type:Boolean,default:()=>!1}},methods:{objectView(e,t,r){return window.Vue.objectView(e,t,r)},dateView(e,t,r,a){return window.Vue.dateView(e,t,r,a)},isNotEmpty(){return this.data&&!window.dotize.dotize.isEmptyObj(this.data)?!0:!!this.data},isArrayData(item,key){try{const data=item;let result=eval("data."+key);if(Array.isArray(result))return result}catch(e){return[]}},menuTab(e){this.indexTab=e},processView(e){let t=this,r=!1;if(t.groupBy&&t.groupByKeyArray){for(const a of t.isArrayData(e,t.groupBy))if(t.tabs[t.indexTab]==t.objectView(a,t.groupByKeyArray)){r=!1;break}}else t.groupBy&&!t.groupByKeyArray&&(r=t.tabs[t.indexTab]!=t.objectView(e,t.groupBy));return r}},mounted:function(){let e=this;e.$nextTick(function(){if(this.data&&Array.isArray(this.data)){if(e.tabs=[],e.indexTab=0,e.groupBy)if(e.groupByKeyArray)for(const t of e.data)for(const r of e.isArrayData(t,e.groupBy))e.tabs.push(e.objectView(r,e.groupByKeyArray));else for(const t of e.data)e.tabs.push(e.objectView(t,e.groupBy));e.tabs=[...new Set(e.tabs)],e.emptyData=e.data.length>0}else if(this.data&&!Array.isArray(this.data)){e.emptyData=!1;for(const t of this.table_config)if(this.objectView(this.data,t.value)){e.emptyData=!0;break}}})},data:()=>({emptyData:!1,tabs:[],indexTab:0}),template:`
    <div class="vuejx__table bg-white border border-gray-400">
        <div class="font-bold text-blue-700 border-b border-gray-400 table___view__heading" v-if="title">{{ title }}</div>
        <div class="flex p-1 border-b border-gray-400" v-if="tabs.length > 0">
            <template v-for="(item, index) in tabs">
                <button v-bind:="index" aria-label="btn" tabindex="-1"
                    @click="menuTab(index)"
                    v-bind:class="[{ 'border-r-0': index < tabs.length - 1, 'bg-blue-100 text-green-800': index == indexTab }, 'text-xs bg-white px-3 py-2 font-semibold text-gray-700 leading-none focus:outline-none border hover:bg-blue-100 hover:text-blue-500 header___btn_menu']"
                >
                    {{ item }}
                </button>
            </template>
        </div>
        <table v-if="mode !== 'vertical' && emptyData" :id="idtable" class="border-b w-full bg-white table___view_mode table___view_mode_simple" v-bind:style="{'border-bottom': (dataResults && dataResults.length == 0) ? 'unset' : ''}">
            <thead class="full">
                <slot name="thead_title"> </slot>
                <slot name="thead"> <tr><th v-for="(item, index) of table_config" v-bind:key="index" :width="item.width" :class="item.class" style="border-top: 0 !important;"> {{ item.title }} </th> </tr> </slot>
            </thead>
            <tbody class="border-b w-full bg-white"> <slot name="tbody" v-bind:data="data"> <slot name="tbody_title"></slot>
                    <template v-for="(item, index) in data">
                        <tr v-bind:key="index" :class="{'hidden': processView(item) }">
                            <td v-for="(itemCf, indexx) of table_config" v-bind:key="indexx" :width="itemCf.width">
                                <slot :name="'cell_' + itemCf.value" v-bind:celldata="item">
                                    <span> {{ itemCf.date ? dateView(item, itemCf.value) : objectView(item, itemCf.value) }} </span>
                                </slot>
                            </td>
                        </tr>
                        <slot :name="'footer_data'" v-bind:celldata="item"></slot>
                        <tr  class="sub__table_title" v-if="footer_header"><td colspan="100" class="font-bold border-b border-gray-400 table___view__heading text-blue-700">{{title}}</td></tr>
                        <tr class="sub__table_info" v-if="footer_header"><td v-for="(item, index) of table_config" v-bind:key="index" :width="item.width" :class="item.class"> {{ item.title }} </td> </tr>
                    </template>
                </slot>
            </tbody>
        </table>
        <table v-else-if="emptyData" :id="idtable" class="border-b w-full bg-white table___view_mode" v-bind:style="{'border-bottom': (dataResults && dataResults.length == 0) ? 'unset' : ''}">
            <tbody class="border-b w-full bg-white" v-if="Array.isArray(data)" v-for="(itemData, indexData) in data" v-bind:key="indexData">
                <template v-for="(item, index) in table_config">
                    <tr v-bind:key="index" v-if="objectView(itemData, item.value)"
                        :class="{'hidden': processView(itemData) }"
                    >
                        <td :width="25" class="font-semibold" v-if="data.length > 1" v-bind:style="{'border-top': indexData > 0 && index == 0 ? '1px solid #cbd5e0 !important' : ''}">
                            {{ index == 0 ? indexData + 1 : '' }}
                        </td>
                        <td :width="item.width ? item.width : 200" class="font-semibold" v-bind:style="{'border-top': indexData > 0 && index == 0 ? '1px solid #cbd5e0 !important' : ''}">
                            {{ item.title }}
                        </td>
                        <td v-bind:style="{'border-top': indexData > 0 && index == 0 ? '1px solid #cbd5e0 !important' : ''}">
                            <slot :name="'cell_' + item.value" v-bind:celldata="itemData">
                                <span v-html="item.date ? dateView(itemData, item.value) : objectView(itemData, item.value)"></span> <template v-if="item.prefix">{{ item.prefix }}</template>
                            </slot>
                        </td>
                    </tr>
                </template>
                <slot :name="'footer_data'" v-bind:celldata="itemData"></slot>
            </tbody>
            <tbody class="border-b w-full bg-white" v-else>
                <template v-for="(item, index) in table_config">
                    <tr v-bind:key="index" v-if="objectView(data, item.value)">
                        <td :width="item.width ? item.width : 200" class="font-semibold">
                            {{ item.title }}
                        </td>
                        <td>
                            <slot :name="'cell_' + item.value" v-bind:celldata="data">
                                <span v-html="item.date ? dateView(data, item.value) : objectView(data, item.value)"></span> <template v-if="item.prefix">{{ item.prefix }}</template>
                            </slot>
                        </td>
                    </tr>
                </template>
            </tbody>
        </table>
        <div class="p-2" v-else-if="!emptyData">
            Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u
        </div>
    </div>
    `},tableSimpleKhcn={props:{table_class:{type:String,default:"border-b w-full bg-white"},table_view:{type:String,default:""},custom_table:{type:Boolean,default:()=>!1},remove:{type:Boolean,default:()=>!1},crud:{type:Boolean,default:()=>!1},import_data:{type:Boolean,default:()=>!1},export_data:{type:Boolean,default:()=>!1},export_data_label:{type:String,default:()=>"Export"},noHeader:{type:Boolean,default:()=>!1},noRouterr:{type:Boolean,default:()=>!1},storage:{type:Object,default:()=>null},widthSTT:{type:Number,default:()=>50},filter_options:{type:Array,default:()=>[]},table_config:{type:Array,default:()=>[]},title:{type:String,default:""},detailPage:{type:String,default:""},employee__table:{type:Boolean,default:!1},idtable:{type:String,default:"table__to__export"},db:{type:String,default:()=>localStorage.getItem("db")},collection:{type:String,default:()=>""},site:{type:String,default:()=>""},includes:{type:Array,default:()=>[]},sort:{type:Array,default:()=>[]},pagesize:{type:Number,default:()=>15},paging:{type:Boolean,default:()=>!0},condition:{type:Array,default:()=>[]},queryFilter:{type:Array,default:()=>[]},keywords:{type:Array,default:()=>[]},queryParam:{type:Boolean,default:()=>!0},empty:{type:Boolean,default:()=>!1},skeleton:{type:Object,default:()=>({th:[],td:[]})},exportTemplate:{type:String,default:""},exportTemplateTitle:{type:String,default:""},aggs_ext:{type:String,default:""},aggs_ext_keyAggs:{type:String,default:""},placeholderKeyowrds:{type:String,default:"T\xECm ki\u1EBFm ..."},treeParentKey:{type:String,default:"LoaiChiTieuRoot"},state_query:{type:Array,default:null},inlineFilter:{type:Boolean,default:()=>!1}},methods:{async init(e){let t=this;t.renderData=!1,t.rows=t.pagesize;let r=window.Vue.router.currentRoute.value.query,a=null;if(e){a={};for(const l of e)l.key==="_s_n"&&(a.sortNext=l.value),l.key==="_s_b"&&(a.sortBack=l.value),l.key==="_pagging"&&(a.paggingType=l.value),l.key==="_page"&&(a.page=l.value),l.key==="_sizeLast"&&(a.sizeLast=l.value>0?l.value:t.pagesize,a.size=l.value>0?l.value:t.pagesize);a.size||(a.size=t.pagesize,a.sizeLast=t.pagesize)}if(r.adv_filter?t.adv_filter=r.adv_filter:t.adv_filter=!1,t.paging||(t.rows=t.pagesize,t.page=1),t.aggReport={},t.aggs_ext_keyAggs){let l=JSON.parse(JSON.stringify(t.condition));l.splice(-1);const f=await window.VueJX.aggs(t,"danh_muc",{keyAggs:t.aggs_ext_keyAggs,dbAggs:t.db,collectionAggs:t.aggs_ext,sizeAggs:1e4},1e4,1,"_source"+t.aggs_ext_keyAggs,"_source"+t.aggs_ext_keyAggs,[],l,t.queryFilter,t.keywords,t.queryParam,"true",!0,0,null,null,null);if(f&&Array.isArray(f.items))for(let s of f.items)t.aggReport[s.code]=s.counter}t.noRouterr&&!a&&(a={page:1,paggingType:"first",size:t.pagesize,sizeLast:t.pagesize,sortBack:"",sortNext:""});const n=await window.VueJX.search(t,t.collection,t.keywords,t.queryFilter,t.condition,t.includes,t.sort,t.storage,t.rows,t.queryParam,t.sizeLast,a);t.dataResults=n.dataResults,t.pages=n.pages,t.page=n.page,t.totalRecord=n.totalRecord,t.sortNext=n.sortNext,t.sortBack=n.sortBack,t.rows=n.size,t.renderData=!0,t.bodyQuery=n.bodyQuery},dateView(e,t,r,a){return window.Vue.dateView(e,t,r,a)},objectView(e,t,r){return window.Vue.objectView(e,t,r)},toDetail(e){if(this.detailPage&&this.detailPage.indexOf("?")!=-1){let[t,r]=this.detailPage.split("?"),a=[{key:"_id",value:e||"NULL"}];if(r&&r.indexOf("&")!=-1){let n=r.split("&");for(let l of n)if(l&&l.indexOf("=")!=-1){const[f,s]=l.split("=");a.push({key:f,value:s})}else a.push({key:l,value:""})}window.Vue.redirect(a,!1,t)}else window.Vue.redirect([{key:"_id",value:e||"NULL"}],!1,this.detailPage)},async paggingData(e){let t=this,r=e,a=[];t.sizeLast=t.rows;const n=new URLSearchParams(window.location.href);if(e==="next"?(t.page=parseInt(t.page)+1,t.page>=t.pages&&(t.page=t.pages,t.sizeLast=t.totalRecord-t.rows*(t.page-1)),Array.isArray(t.sortNext)&&t.sortNext.length>0&&(t.sortBack=t.sortNext)):e==="prev"?(t.page=parseInt(t.page)-1,n.get("_s_b")&&(t.sortNext=JSON.parse(decodeURIComponent(n.get("_s_b"))))):e==="first"?t.page=1:e==="last"&&(t.page=t.pages,t.sizeLast=t.totalRecord-t.rows*(t.page-1)),a.push({key:"t",value:new Date().getTime()}),t.page<=1?(t.page=1,r="first",a.push({key:"_s_n",value:""}),a.push({key:"_s_b",value:""})):t.page<=t.pages&&(Array.isArray(t.sortNext)&&t.sortNext.length>0&&a.push({key:"_s_n",value:encodeURIComponent(JSON.stringify(t.sortNext))}),Array.isArray(t.sortBack)&&t.sortBack.length>0&&a.push({key:"_s_b",value:encodeURIComponent(JSON.stringify(t.sortBack))})),a.push({key:"_pagging",value:r}),a.push({key:"_rows",value:t.rows}),t.sizeLast!=t.rows&&a.push({key:"_sizeLast",value:t.sizeLast}),e==="rows"?(a.push({key:"_page",value:1}),a.push({key:"_rows",value:t.rows})):a.push({key:"_page",value:t.page}),t.noRouterr)t.renderData=!1,await t.init(a),t.renderData=!0;else if(typeof window.history.pushState!="undefined"){let l="/#"+window.Vue.router.currentRoute.value.path+"?t="+new Date().getTime();for(const s of a)s.key!="t"&&(l+="&"+s.key+"="+s.value);const f=window.Vue.router.currentRoute.value.query;for(const s in f)["_page","t","_s_n","_s_b"].indexOf(s)==-1&&(l+="&"+s+"="+f[s]);window.history.pushState({},"",l),await t.init()}else window.Vue.redirect(a)},async doExport(){let e=this;if(e.exportTemplate)window.Vue.$axios.post("/vuejx/docx/generateexcel",{docFileName:e.exportTemplate,site:localStorage.getItem("site"),db:localStorage.getItem("db"),collection:e.collection,bodyQuery:e.bodyQuery,dataId:e.exportTemplateTitle},{responseType:"arraybuffer",headers:{Authorization:"Bearer "+localStorage.getItem("token"),token:localStorage.getItem("token"),"Content-Type":"application/json",Accept:"application/octet-stream"}}).then(t=>{const r=new Blob([t.data],{type:"application/octet-stream"});var a=document.createElement("a");a.href=window.URL.createObjectURL(r),a.download=e.exportTemplateTitle.endsWith(".pdf")?e.exportTemplateTitle:e.exportTemplateTitle+".xlsx",document.body.appendChild(a),a.click(),document.body.removeChild(a)}).catch(t=>{console.log(t)});else{let t=e.collection+".xlsx",r=JSON.stringify({fileName:t}),a={method:"post",url:"/security/file/mongo2excel/"+e.db+"/"+e.collection+"/"+e.site,headers:{"Content-Type":"application/json",token:localStorage.getItem("token")},responseType:"blob",data:r};await window.Vue.$axios(a).then(function(n){const l=window.URL.createObjectURL(new Blob([n.data])),f=document.createElement("a");f.href=l,f.setAttribute("download",t),document.body.appendChild(f),f.click()}).catch(function(n){console.log(n)})}},async doImport(){let e=this;if(confirm("X\xE1c nh\u1EADn import d\u1EEF li\u1EC7u.")==!0){let r=new FormData,a=document.getElementById("formFile");for(const l of a.files)r.append("file",l,l.name);let n={headers:{}};n.headers["Content-Type"]="multipart/form-data",n.headers.token=localStorage.getItem("token"),n.headers.metadata=encodeURIComponent(JSON.stringify({import:e.collection})),await window.Vue.$axios.post(`/security/file/excel2mongo/${e.db}/${e.collection}/${e.site}`,r,n).then(function(l){l&&l.data?window.Vue.toastr.success("Th\xE0nh c\xF4ng."):window.Vue.toastr.error("Error.")}).catch(l=>{window.Vue.toastr.error(error)})}},openTree(e,t){this.indexTree=e._id,this.$emit("openTree",e)},async processTree(e,t,r){let a=this;if(a.keyTree=r,console.log("query",e,t,r),a.dataResultsChild[t]&&!window.dotize.dotize.isEmptyObj(a.dataResultsChild[t]))a.dataResultsChild={};else{const n=await window.VueJX.search(a,a.collection,a.keywords,a.queryFilter,e,a.includes,a.sort,a.storage,a.rows,a.queryParam,a.sizeLast);a.dataResultsChild[t]=n.dataResults}},processTreeEmbed(e){this.itemxxx[e]||(this.itemxxx[e]=!0,setTimeout(()=>{document.getElementById(e).click()},0))},pickAll(){var t;let e=this;if(e.checkAll=!e.checkAll,e.checkAll){e.ids=[];for(let r of e.dataResults)e.ids.push((t=r==null?void 0:r._source)==null?void 0:t.id)}else e.ids=[]},pickRemove(e,t){this.ids.push(e),this.ids=Array.from(new Set(this.ids)),t&&this.ids.filter(r=>r!==e)},async doRemove(){let e=this;if(prompt("Vui l\xF2ng nh\u1EADp ch\u1EEF: DELETE \u0111\u1EC3 xo\xE1 d\u1EEF li\u1EC7u","")=="DELETE"){window.Vue.loadingBar.start();let r={storage:"trash"},a="vuejx_manager/userUpdateMany";await window.Vue.$root.dispatch(a,{db:localStorage.getItem("db"),collection:e.collection,body:r,filter:{shortName:{$in:e.ids}}}).then(async n=>{n.data&&n.data.modifiedCount&&(window.Vue.toastr.success("Y\xEAu c\u1EA7u c\u1EE7a b\u1EA1n \u0111\u01B0\u1EE3c th\u1EF1c hi\u1EC7n th\xE0nh c\xF4ng."),e.renderData=!1,await window.sleep(1e3),await e.init(),e.renderData=!0,window.Vue.loadingBar.finish())}).catch(n=>{window.Vue.toastr.error("Y\xEAu c\u1EA7u c\u1EE7a b\u1EA1n \u0111\u01B0\u1EE3c th\u1EF1c hi\u1EC7n th\u1EA5t b\u1EA1i."),window.Vue.loadingBar.error()})}}},watch:{$route:async function(e,t){let r=window.VueJX.page();if(t.params.page==r){let a=this;a.renderData=!1,await a.init(),a.renderData=!0}}},mounted:function(){let e=this;e.$nextTick(function(){e.renderData=!1,setTimeout(async()=>{await e.init(),e.renderData=!0},0)})},data:()=>({itemxxx:{},renderData:!1,site:localStorage.getItem("site"),rows:15,sizeLast:15,dataResults:[],dataResultsChild:{},page:1,pages:1,totalRecord:0,sortBack:[],sortNext:[],paggingType:"",indexTree:"",keyTree:"",checkAll:!1,ids:[],adv_filter:!1,bodyQuery:null,aggReport:{}}),template:`
    <div v-if="custom_table"><slot name="custom_view" v-bind:data="dataResults"></slot></div>
    <div class="vuejx__table" v-else>
        <div class="top-content flex" v-if="!noHeader">
            <div class=" content-title bg-blue-700 text-white flex items-center uppercase font-semibold relative"> {{ title }} </div>
            <qlvt-filter :inlineFilter="inlineFilter" :state_query="state_query" :placeholderKeyowrds="placeholderKeyowrds" class=" flex-1" ref="filter" :filter_options="filter_options">
                <template v-slot:filter_button="{ submitSearch, showSearchAdvanced }">
                    <button aria-label="btn" class=" filter___timkiem font-semibold rounded-r text-white px-3 pb-1 leading-none focus:outline-none bg-blue-700 whitespace-no-wrap" tabindex="-1" @click="submitSearch($event)">T\xECm ki\u1EBFm</button>
                    <slot name="ext_btn"> 
                        <button aria-label="btn" v-if="!inlineFilter && filter_options.length > 0" class=" filter___adv font-semibold rounded border border-blue-700 text-blue-700 px-3 leading-none focus:outline-none hover:bg-blue-700 hover:text-white ml-2 whitespace-no-wrap" tabindex="-1" @click="showSearchAdvanced()">{{ adv_filter ? 'Xo\xE1 b\u1ED9 l\u1ECDc' : 'N\xE2ng cao'}}</button>
                        <button aria-label="btn" v-if="crud" class="filter___add_cms whitespace-no-wrap ml-2 font-semibold rounded border border-blue-700 bg-blue-700 text-white px-3 pb-1 leading-none focus:outline-none hover:bg-white hover:text-blue-700" tabindex="-1" @click="toDetail('')">Th\xEAm m\u1EDBi</button>
                    </slot>
                    <button v-if="import_data" aria-label="btn" class=" filter___import whitespace-no-wrap ml-2 font-semibold rounded border border-blue-700 text-blue-700 px-3 pb-1 leading-none focus:outline-none hover:bg-white hover:text-blue-700" tabindex="-1">
                        <label for="formFile">Import</label>
                        <input class="hidden" type="file" id="formFile" @change="doImport">
                    </button>
                    <button v-if="export_data" aria-label="btn" class=" filter___import whitespace-no-wrap ml-2 font-semibold rounded border border-blue-700 text-blue-700 px-3 pb-1 leading-none focus:outline-none hover:bg-white hover:text-blue-700" tabindex="-1" @click="doExport">{{ export_data_label }}</button>
                </template>
            </qlvt-filter>
        </div>
        <button aria-label="btn" v-if="ids.length > 0" @click="doRemove" class="whitespace-no-wrap mb-2 font-semibold rounded border border-red-700 text-red-700 p-2 leading-none focus:outline-none hover:bg-red-200 hover:text-gray-900 px-3" tabindex="-1">
            X\xE1c nh\u1EADn xo\xE1 {{ ids.length }} b\u1EA3n ghi.
        </button>
        <slot name="button_ext"></slot>
        <slot name="report_ext">
        <table v-if="!renderData" class="border-b w-full bg-white"> <thead class="w-full bg-white"> <slot name="thead"> <tr> <th width="50">STT</th> <th v-for="(item, index) of table_config" v-bind:key="index" :width="item.width" :class="item.class"> {{ item.title }} </th> </tr> </slot> </thead> <tbody class="w-full bg-white p-4"> <tr> <td colspan="100"> <p class="loading___table"> Ch\u1EDD trong gi\xE2y l\xE1t ... </p> </td> </tr> </tbody></table>
        <table :id="idtable" v-else :class="table_class" v-bind:style="{'border-bottom': (dataResults && dataResults.length == 0) ? 'unset' : ''}">
        <thead :class="{ 'w-full': !employee__table }">
            <slot name="thead_title"> </slot>
            <slot name="thead"> <tr> <th v-if="table_view == 'tree'" width="40"></th><th v-if="remove" width="40" @click="pickAll">
                <i class="mdi mdi-checkbox-blank-outline " v-if="!checkAll"></i>
                <i class="mdi mdi-checkbox-marked " v-else></i>
            </th> <th width="50">STT</th> <th v-for="(item, index) of table_config" v-bind:key="index" :width="item.width" :class="item.class"> {{ item.title }} </th> </tr> </slot>
        </thead>
        <tbody class="border-b w-full bg-white"> <slot name="tbody" v-bind:page="rows" v-bind:data="dataResults"> <slot name="tbody_title"></slot>
            <template v-for="(item, index) in dataResults">
                <tr v-bind:key="index">
                    <td width="40" align="center" v-if="table_view == 'tree'" class="cursor-pointer"
                        :class="{'bg-yellow-200': indexTree == item._id}"    
                    >   
                        <template v-if="item?._source?.Cha">
                            <button :id="'tree___input___' + index" @click="openTree(item, indexTree == item._id)">
                                {{ processTreeEmbed('tree___input___' + index) }}
                                <i class="mdi mdi-chevron-double-down" v-if="indexTree != item._id"></i>
                                <i class="mdi mdi-chevron-double-up" v-else></i>
                            </button>
                        </template>
                    </td>
                    <td width="40" align="center" v-if="remove" class="cursor-pointer" @click="pickRemove(item._id, ids.length > 0 && ids.indexOf(item._id) != -1)"
                        :class="{'bg-yellow-200': ids.length > 0 && ids.indexOf(item._id) != -1}"    
                    >
                        <i class="mdi mdi-checkbox-marked" v-if="ids.length > 0 && ids.indexOf(item._id) != -1"></i>
                        <i class="mdi mdi-checkbox-blank-outline" v-else></i>
                    </td>
                    <td :width="widthSTT" align="center"
                        :class="{'bg-yellow-200': indexTree == item._id}"    
                    >{{ page * rows - rows + index + 1 }} </td>
                    <td v-for="(itemCf, indexx) of table_config" v-bind:key="indexx" :width="itemCf.width" 
                        :class="[{'bg-yellow-200': indexTree == item._id, 'font-bold text-blue-700': itemCf.aggs && aggReport[objectView(item, itemCf.value)]}, itemCf.class]"    
                        @click="itemCf.action ? '' : toDetail(item._id)" >
                        <slot :name="'cell_' + indexx" v-bind:celldata="item">
                            <template v-if="itemCf.value_1 && itemCf.date ? dateView(item, itemCf.value_1) : objectView(item, itemCf.value_1)">
                                <span class="title_slot_table font-semibold" v-html="itemCf.value_title"></span>
                                <span v-if="item.hasOwnProperty('highlight') && item.highlight.hasOwnProperty(itemCf.value.replace('_source.', ''))" v-html="item.highlight[itemCf.value.replace('_source.', '')].toString()"> </span>
                                <span v-else-if="item.hasOwnProperty('highlight') && item.highlight.hasOwnProperty(itemCf.value.replace('_source.', '') + '.raw')" v-html="item.highlight[itemCf.value.replace('_source.', '') + '.raw'].toString()"> </span>
                                <span v-else-if="item.hasOwnProperty('highlight') && item.highlight.hasOwnProperty(itemCf.value.replace('_source.', '') + '.keyword')" v-html="item.highlight[itemCf.value.replace('_source.', '') + '.keyword'].toString()"> </span>
                                <span v-html="itemCf.date ? dateView(item, itemCf.value) : objectView(item, itemCf.value)" v-else></span><br/>
                                <span class="title_slot_table font-semibold" v-html="itemCf.value_title_1"></span>
                                <span v-if="item.hasOwnProperty('highlight') && item.highlight.hasOwnProperty(itemCf.value_1.replace('_source.', ''))" v-html="item.highlight[itemCf.value_1.replace('_source.', '')].toString()"> </span>
                                <span v-else-if="item.hasOwnProperty('highlight') && item.highlight.hasOwnProperty(itemCf.value_1.replace('_source.', '') + '.raw')" v-html="item.highlight[itemCf.value_1.replace('_source.', '') + '.raw'].toString()"> </span>
                                <span v-else-if="item.hasOwnProperty('highlight') && item.highlight.hasOwnProperty(itemCf.value_1.replace('_source.', '') + '.keyword')" v-html="item.highlight[itemCf.value_1.replace('_source.', '') + '.keyword'].toString()"> </span>
                                <span v-html="itemCf.date ? dateView(item, itemCf.value_1) : objectView(item, itemCf.value_1)" v-else></span>
                            </template>
                            <template v-if="itemCf.aggs">
                                {{ aggReport[objectView(item, itemCf.value)] ? aggReport[objectView(item, itemCf.value)] : 0 }}
                            </template>
                            <template v-else>
                                <span v-if="item.hasOwnProperty('highlight') && item.highlight.hasOwnProperty(itemCf.value.replace('_source.', ''))" v-html="item.highlight[itemCf.value.replace('_source.', '')].toString()"> </span>
                                <span v-else-if="item.hasOwnProperty('highlight') && item.highlight.hasOwnProperty(itemCf.value.replace('_source.', '') + '.raw')" v-html="item.highlight[itemCf.value.replace('_source.', '') + '.raw'].toString()"> </span>
                                <span v-else-if="item.hasOwnProperty('highlight') && item.highlight.hasOwnProperty(itemCf.value.replace('_source.', '') + '.keyword')" v-html="item.highlight[itemCf.value.replace('_source.', '') + '.keyword'].toString()"> </span>
                                <span v-html="itemCf.date ? dateView(item, itemCf.value) : objectView(item, itemCf.value)" v-else></span>
                            </template>
                        </slot>
                    </td>
                </tr> 
                <tr v-for="(itemChild, indexChild) in dataResultsChild[objectView(item, keyTree)]" v-bind:key="indexChild" v-if="table_view == 'tree'" >
                    <td width="40" align="center" class="cursor-pointer">
                    </td>
                    <td :width="widthSTT" align="center">{{ page * rows - rows + index + 1 }}.{{ indexChild + 1 }} </td>
                    <td v-for="(itemCf, indexx) of table_config" v-bind:key="indexx" :width="itemCf.width" :class="[{'font-bold text-blue-700': aggReport[objectView(itemChild, itemCf.value)]}, itemCf.class]" @click="itemCf.action ? '' : toDetail(itemChild._id)" >
                        <template v-if="itemCf.aggs">
                            <slot :name="'cell_' + indexx" v-bind:celldata="itemChild">
                                {{ aggReport[objectView(itemChild, itemCf.value)] ? aggReport[objectView(itemChild, itemCf.value)] : 0 }}
                            </slot>
                        </template>
                        <template v-else>
                            <slot :name="'cell_' + indexx" v-bind:celldata="itemChild">
                                <span v-if="itemChild.hasOwnProperty('highlight') && itemChild.highlight.hasOwnProperty(itemCf.value.replace('_source.', ''))" v-html="itemChild.highlight[itemCf.value.replace('_source.', '')].toString()"> </span>
                                <span v-else-if="itemChild.hasOwnProperty('highlight') && itemChild.highlight.hasOwnProperty(itemCf.value.replace('_source.', '') + '.raw')" v-html="itemChild.highlight[itemCf.value.replace('_source.', '') + '.raw'].toString()"> </span>
                                <span v-else-if="itemChild.hasOwnProperty('highlight') && itemChild.highlight.hasOwnProperty(itemCf.value.replace('_source.', '') + '.keyword')" v-html="itemChild.highlight[itemCf.value.replace('_source.', '') + '.keyword'].toString()"> </span>
                                <span v-else> {{ itemCf.date ? dateView(itemChild, itemCf.value) : objectView(itemChild, itemCf.value) }} </span>
                            </slot>
                        </template>
                    </td>
                </tr>
            </template>
            </slot>
        </tbody>
        </table>
        <header v-if="renderData && paging" class="bg-white flex items-center py-1 pr-4"><div class="flex"><button class="font-semibold text-blue-700 px-2 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1"  @click="paggingData('first')"  aria-label="first"> <i class="mdi" :class="{'mdi-chevron-double-left': !loadingAction}"></i> </button><button class="font-semibold text-blue-700 pl-0 pr-2 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1" @click="paggingData('prev')" aria-label="back" > <i class="mdi" :class="{'mdi-chevron-left': !loadingAction}"></i> </button><button class="text-blue-700 px-2 py-2 leading-none focus:outline-none hover:text-primary btn__pagging" tabindex="-1" > Trang {{ page }} / {{ pages }} </button><button v-if="page < pages" class="font-semibold text-blue-700 pl-2 pr-0 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1" @click="paggingData('next')" aria-label="next" > <i class="mdi" :class="{'mdi-chevron-right': !loadingAction}"></i> </button><button v-if="page < pages" class="font-semibold text-blue-700 px-2 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1" @click="paggingData('last')" aria-label="last"><i class="mdi" :class="{'mdi-chevron-double-right': !loadingAction}"></i> </button><button class="focus:outline-none btn__pagging_info" tabindex="-1"> <div> <h4 class="font-semibold"> <span>T\u1ED5ng s\u1ED1 b\u1EA3n ghi: </span> <span class='text-blue-700'>{{totalRecord}}</span> </h4> </div> </button></div> <div class="ml-auto"> <span>Hi\u1EC3n th\u1ECB</span> <input style="width: 60px" class="text-center appearance-none bg-gray-200 text-blue-700 border border-gray-200 rounded py-1 px-1 focus:outline-none focus:bg-white focus:border-gray-400 ml-2" v-model="rows" @change="paggingData('rows')" type="text" aria-label="total" /></div></header>
        </slot>
    </div>
    `},tableSimplePagging={props:{page:{type:Number,default:()=>1},pages:{type:Number,default:()=>1},size:{type:Number,default:()=>15},sizeLast:{type:Number,default:()=>0},totalRecord:{type:Number,default:()=>0},sortBack:{type:Array,default:()=>[]},sortNext:{type:Array,default:()=>[]}},methods:{async paggingData(e){let t=this;t.sizeLastX=t.rows,t.curPage=t.page;let r=e;r==="next"?(t.curPage=parseInt(t.page)+1,t.page>=t.pages&&(t.curPage=t.pages)):r==="prev"?t.curPage=parseInt(t.page)-1:r==="first"?t.curPage=1:r==="last"&&(t.curPage=t.pages,t.sizeLastX=t.totalRecord-t.rows*(t.curPage-1)),t.curPage<=1?(t.curPage=1,r="first"):t.page<=t.pages,t.$emit("pagging",{sizeLast:t.sizeLastX,page:t.curPage,pages:t.pages,size:t.size,totalRecord:t.totalRecord,sortBack:t.sortBack,sortNext:t.sortNext,paggingType:r})}},mounted:function(){let e=this;e.$nextTick(function(){setTimeout(async()=>{e.sizeLast==0?e.rows=e.size:e.sizeLast?e.rows=e.sizeLast:e.rows=e.size},0)})},data:()=>({sizeLastX:15,curPage:1,rows:15}),template:`
        <header class="bg-white flex items-center py-1 pr-4"><div class="flex"><button class="font-semibold text-blue-700 px-2 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1"  @click="paggingData('first')"  aria-label="first"> <i class="mdi mdi-chevron-double-left"></i> </button><button class="font-semibold text-blue-700 pl-0 pr-2 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1" @click="paggingData('prev')" aria-label="back" > <i class="mdi mdi-chevron-left"></i> </button><button class="text-blue-700 px-2 py-2 leading-none focus:outline-none hover:text-primary btn__pagging" tabindex="-1" > Trang {{ page }} / {{ pages }} </button><button v-if="page < pages" class="font-semibold text-blue-700 pl-2 pr-0 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1" @click="paggingData('next')" aria-label="next" > <i class="mdi mdi-chevron-right"></i> </button><button v-if="page < pages" class="font-semibold text-blue-700 px-2 py-2 leading-none focus:outline-none hover:text-primary" tabindex="-1" @click="paggingData('last')" aria-label="last"><i class="mdi mdi-chevron-double-right"></i> </button><button class="focus:outline-none btn__pagging_info" tabindex="-1"> <div> <h4 class="font-semibold"> <span>T\u1ED5ng s\u1ED1 b\u1EA3n ghi: </span> <span class='text-blue-700'>{{totalRecord}}</span> </h4> </div> </button></div> <div class="ml-auto"> <span>Hi\u1EC3n th\u1ECB</span> <input style="width: 60px" class="text-center appearance-none bg-gray-200 text-blue-700 border border-gray-200 rounded py-1 px-1 focus:outline-none focus:bg-white focus:border-gray-400 ml-2" v-model="rows" @change="paggingData('rows')" type="text" aria-label="total" /></div></header>
    `},tableSimpleTop={props:{storage:{type:Object,default:()=>"regular"},cardClass:{type:String,default:()=>""},redirectDetail:{type:Boolean,default:!0},viewMore:{type:String,default:()=>""},viewDetail:{type:String,default:()=>""},filter_options:{type:Array,default:()=>[]},table_config:{type:Array,default:()=>[]},itemText:{type:String,default:""},itemValue:{type:String,default:""},title:{type:String,default:""},detailPage:{type:String,default:""},employee__table:{type:Boolean,default:!1},idtable:{type:String,default:"table__to__export"},db:{type:String,default:()=>localStorage.getItem("db")},collection:{type:String,default:()=>""},site:{type:String,default:()=>""},includes:{type:Array,default:()=>[]},sort:{type:Array,default:()=>[]},pagesize:{type:Number,default:()=>5},paging:{type:Boolean,default:()=>!0},condition:{type:Array,default:()=>[]},queryFilter:{type:Array,default:()=>[]},keywords:{type:Array,default:()=>[]},queryParam:{type:Boolean,default:()=>!0},empty:{type:Boolean,default:()=>!1},skeleton:{type:Object,default:()=>({th:[],td:[]})},query:{type:Object,default:()=>null}},methods:{async init(){let e=this;const t=window.Vue.router.currentRoute.value.query;e.keywordsQ=t.keywords?t.keywords:"";const r=await window.VueJX.search(e,e.collection,e.keywords,e.queryFilter,e.condition,e.includes,e.sort,{match:{storage:e.storage}},e.pagesize,e.queryParam,e.pagesize);e.renderData=!0,e.dataResults=r.dataResults,e.$emit("dataArray",r.dataResults),e.$emit("total",r.totalRecord),e.$emit("totalData",{total:r.totalRecord,collection:e.collection})},objectView(e,t,r){return window.Vue.objectView(e,t,r)},toDetail(e){if(this.detailPage&&this.detailPage.indexOf("?")!=-1){let[t,r]=this.detailPage.split("?"),a="&t="+new Date().getTime();if(r&&r.indexOf("&")!=-1){let n=r.split("&");for(let l of n)a=a+"&"+l}else r&&(a=a+"&"+r);window.location.href=t+"?_id="+e._id+a}else this.redirectDetail?window.location.href=this.viewDetail+"?_id="+e._id:this.$emit("change_data",e)}},mounted:function(){let e=this;e.renderData=!1,e.$nextTick(function(){setTimeout(async()=>{await e.init()},0)})},data:()=>({keywordsQ:"",renderData:!1,site:localStorage.getItem("site"),rows:15,dataResults:[],page:1,pages:1,totalRecord:0,sortBack:[],sortNext:[],paggingType:""}),template:`
    <div class="vuejx__chips_filter mb-2 fix-width-numnber vuejx___header_top head">
      <header class="relative inline-block flex">
        <span class="flex items-center"> <h4 class="font-semibold pl-1 text-white cursor-default"> {{ title }}</h4> </span>
        <div v-if="viewMore" class="ml-auto"> <a :href="viewMore + '?keywords=' + keywordsQ" class="relative text-gray-600 rounded px-2 pr-4 py-2 leading-none focus:outline-none hover:text-blue-700" tabindex="-1" style="text-transform: none;"> Xem th\xEAm <i class="mdi mdi-chevron-right absolute right-0 top-0 text-md" style="margin-top: 7px;"></i> </a> </div>
      </header>
      <div class="text-justify" :class="cardClass" :key="renderData">
        <div class="flex justify-start cursor-pointer text-gray-900 hover:text-blue-700 hover:bg-gray-200 px-2 py-1 relative border-b border-gray-200" v-for="(item, index) in dataResults" v-bind:key="index" @click="toDetail(item)" ><template v-if="objectView(item, itemText)"> <i class="mdi mdi-chevron-right absolute left-0 top-0 text-sm" style="margin-top: 6px; margin-left: 8px;"></i> <slot name="tbody" v-bind:item="item"> <div class="text-sm w-full mr-5 ml-5"> {{ objectView(item, itemText) }} </div> </slot> </template></div>
      </div>
    </div>
    `},VueJXMenuAggs={props:{storage:{type:Object,default:()=>"regular"},item_conditon:{type:Array,default:()=>[]},sort:{type:Array,default:()=>[{order:"asc"}]},placeholder:{type:String,default:"T\xECm ki\u1EBFm..."},redirect_page:{type:String,default:""},database:{type:String,default:localStorage.getItem("db")},collection:{type:String,default:""},title_header:{type:String,default:""},showMenu:{type:Boolean,default:()=>!0},tree:{type:Boolean,default:!1},ignoreData:{type:Array,default:()=>[]},condition:{type:Array,default:()=>[]},conditionAggs:{type:Array,default:()=>[]},type:{type:String,default:"danh_muc"},group_by:{type:Object,default:null},group_size:{type:Number,default:100},range:{type:Array,default:[]},aggs:{type:Object,default:null},publicData:{type:String,default:"false"},single:{type:Array,default:["_s_n","_s_b","_pagging","_rows","_page","_sizeLast"]},pagging:{type:Boolean,default:!1},redirect:{type:Boolean,default:!1},noreport:{type:Boolean,default:!1},view_null:{type:Boolean,default:!1},custom_label:{type:Object,default:null},custom_label_null:{type:String,default:""},skeleton:{type:Object,default:{rows:2}},multiple:{type:Boolean,default:!1},show_empty_aggs:{type:Boolean,default:!0},keywords:{type:Array,default:[]},queryParam:{type:Boolean,default:!0},re_calculator:{type:Array,default:[]},re_calculator_key:{type:String,default:""},textKey:{type:String,default:"title"},valKey:{type:String,default:"shortName"},queryFilter:{type:Array,default:()=>[]},columns:{type:Array,default:["shortName","title","type","parent","MaMuc","MaLoai","TenMuc","TenGoi"]},filter_adv:{type:Boolean,default:!0}},methods:{async init(e,t){let r=this;if(r.renderData=!1,r.items=[],r.paggingShow=String(r.pagging)=="true",r.noreport&&r.collection){const a=await window.VueJX.search(r,r.collection,r.keywords,r.queryFilter,r.condition,r.columns,r.sort,{match:{storage:r.storage}},r.group_size,r.queryParam,r.group_size);let n=-1;const f=window.Vue.router.currentRoute.value.query[r.group_by.keyAggs];r.activeArray=[],r.selectedMenuXXX=[];for(let s of a.dataResults){if(r.items.push({code:r.objectView(s._source,r.valKey),name:r.objectView(s._source,r.textKey),counter:""}),n=n+1,Array.isArray(f)){for(const h of f)if(String(r.objectView(s._source,r.valKey))===String(h)){r.multiple?r.selectedMenuXXX.push(n):r.selectedMenuXXX=[n];break}}else String(r.objectView(s._source,r.valKey))===String(f)&&(r.multiple?r.selectedMenuXXX.push(n):r.selectedMenuXXX=[n]);r.activeArray=r.selectedMenuXXX}}else{let a=null;JSON.parse(JSON.stringify(r.conditionAggs)),r.type==="danh_muc"?a=await window.VueJX.aggs(r,r.type,r.group_by,r.group_size,r.pageCount,r.valKey,r.textKey,e,r.conditionAggs,r.re_calculator,r.keywords,r.queryParam,r.publicData,r.multiple,r.pageCountNext,r.range,r.custom_label):r.type==="range"?a=await window.VueJX.aggs(r,r.type,r.group_by,r.group_size,r.pageCount,r.valKey,r.textKey,e,r.conditionAggs,r.re_calculator,r.keywords,r.queryParam,r.publicData,r.multiple,r.pageCountNext,r.range,r.custom_label):r.type==="fulltext"&&(a=await window.VueJX.aggs(r,r.type,r.group_by,r.group_size,r.pageCount,r.valKey,r.textKey,e,r.conditionAggs,r.re_calculator,r.keywords,r.queryParam,r.publicData,r.multiple,r.pageCountNext,r.range,r.custom_label)),r.items=a&&a.items?a.items:[],r.pageCountNext=a&&a.pageCountNext?a.pageCountNext:0,r.pageCount=a&&a.pageCount?a.pageCount:0,r.selectedMenuXXX=a&&a.selectedMenuXXX?a.selectedMenuXXX:[],r.activeArray=a&&a.activeArray?a.activeArray:[],r.group_by.collection?r.collectionDM=r.group_by.collection:r.collectionDM=a&&a.collectionDM?a.collectionDM:""}r.items.length===0&&(r.pageCount=r.pageCount-1),r.renderData=!0},menuToParMutiple(e,t){let r=[{key:"typeView",value:""},{key:"_page",value:"1"}];(!window.Vue.router.currentRoute.value.query.hasOwnProperty("_filterAction")||window.Vue.router.currentRoute.value.query._filterAction!=="search")&&r.push({key:"_filterAction",value:"filter"}),this.activeArray=Array.from(new Set(this.activeArray));let a=0;for(let l of this.activeArray)l===t&&this.activeArray.splice(a,1),a=a+1;let n=window.Vue.router.currentRoute.value.query[this.group_by.keyAggs];for(const l of this.single)r.push({key:l,value:""});if(this.view_null)r.push({key:this.group_by.keyAggs,value:"NULL"});else if(this.type==="range"){let l=window.Vue.router.currentRoute.value.query[this.group_by.keyAggs+"_from"],f=window.Vue.router.currentRoute.value.query[this.group_by.keyAggs+"_to"];if(String(e.code)===String(l+"-"+f))String(e.code).split("-"),r.push({key:this.group_by.keyAggs+"_from",value:""}),r.push({key:this.group_by.keyAggs+"_to",value:""}),e.index=-1;else{const[s,h]=String(e.code).split("-");r.push({key:this.group_by.keyAggs+"_from",value:s}),r.push({key:this.group_by.keyAggs+"_to",value:h}),this.activeArray.push(t)}}else if(Array.isArray(n)){n.indexOf(String(e.code))>-1?n.splice(n.indexOf(String(e.code)),1):(r.push({key:this.group_by.keyAggs,value:String(e.code).replace(/&/g,"%26")}),this.activeArray.push(t));for(const l of n)r.push({key:this.group_by.keyAggs,value:String(l).replace(/&/g,"%26")})}else String(e.code)===String(n)?r.push({key:this.group_by.keyAggs,value:""}):(r.push({key:this.group_by.keyAggs,value:String(e.code).replace(/&/g,"%26")}),this.activeArray.push(t));this.multiple&&window.Vue.router.currentRoute.value.query[this.group_by.keyAggs]&&!Array.isArray(window.Vue.router.currentRoute.value.query[this.group_by.keyAggs])&&String(e.code)!==String(window.Vue.router.currentRoute.value.query[this.group_by.keyAggs])&&r.push({key:this.group_by.keyAggs,value:String(window.Vue.router.currentRoute.value.query[this.group_by.keyAggs]).replace(/&/g,"%26")}),r.push({key:"_state_aggs",value:this.group_by.keyAggs}),this.redirect?(r=[],window.Vue.redirect(r,!0,e.code,!0)):window.Vue.redirect(r,!0,null,!1,this.multiple)},menuToPar(e,t){this.activeArray=[];let r=[{key:"typeView",value:""},{key:"_page",value:"1"}];(!window.Vue.router.currentRoute.value.query.hasOwnProperty("_filterAction")||window.Vue.router.currentRoute.value.query._filterAction!=="search")&&r.push({key:"_filterAction",value:"filter"});let a=window.Vue.router.currentRoute.value.query[this.group_by.keyAggs];for(const n of this.single)r.push({key:n,value:""});if(this.view_null)r.push({key:this.group_by.keyAggs,value:"NULL"});else if(this.type==="range"){let n=window.Vue.router.currentRoute.value.query[this.group_by.keyAggs+"_from"],l=window.Vue.router.currentRoute.value.query[this.group_by.keyAggs+"_to"];if(String(e.code)===String(n+"-"+l))String(e.code).split("-"),r.push({key:this.group_by.keyAggs+"_from",value:""}),r.push({key:this.group_by.keyAggs+"_to",value:""}),e.index=-1;else{const[f,s]=String(e.code).split("-");r.push({key:this.group_by.keyAggs+"_from",value:f}),r.push({key:this.group_by.keyAggs+"_to",value:s}),this.activeArray.push(t)}}else String(e.code)===String(a)?(r.push({key:this.group_by.keyAggs,value:""}),e.index=-1):(r.push({key:this.group_by.keyAggs,value:String(e.code).replace(/&/g,"%26")}),this.activeArray.push(t));r.push({key:"_state_aggs",value:this.group_by.keyAggs}),this.redirect?(r=[],this.redirect_page?window.Vue.redirect(r,!0,this.redirect_page,!0):window.Vue.redirect(r,!0,e.code,!0)):this.redirect_page?window.Vue.redirect(r,!0,this.redirect_page,!1,!1):window.Vue.redirect(r,!0,null,!1,!1)},async nextAggs(){this.paggingAction=!0,this.pageCountNext!==0&&(this.pageCount=this.pageCount+1,await this.init(this.excludeXXX,!0,this.filter))},async backAggs(){this.paggingAction=!0,this.pageCount=this.pageCount-1,this.pageCount<=0&&(this.pageCount=0),await this.init(this.excludeXXXBack,!1,this.filter)},toogleMenu(){this.showMenuScope=!this.showMenuScope},toogleMenuSearch(){this.toogleSearch=!this.toogleSearch},objectView(e,t,r){return window.Vue.objectView(e,t,r)},changeData(e){let t=[{key:"typeView",value:""},{key:"_page",value:"1"}];t.push({key:this.group_by.keyAggs,value:e._source[this.valKey]}),window.Vue.redirect(t,!0)}},mounted:function(){let e=this;e.$nextTick(function(){setTimeout(async()=>{e.paggingAction=!1,await e.init([],!0)},0)})},data:()=>({paggingShow:!1,collectionDM:"",items:[],search:null,activeArray:[],open:[],tree:[],renderData:!1,showPaggingSize:0,showPaggingSizeTotal:0,selectedMenu:[-1],ignore:{},pageCount:1,pageCountNext:1,excludeXXX:[],excludeXXXBack:[],activePage:window.Vue.router.currentRoute.value.params.page,selectedMenuXXX:[],filter:[],paggingActive:!0,showMenuScope:!0,toogleSearch:!1,paggingAction:!1}),template:`
    <div class="vuejx__chips_filter mb-2">
        <header class="bg-white flex items-center px-2 border-b border-gray-200" v-if="title_header" >
        <div class="flex"> <button aria-label="btn" class="focus:outline-none" tabindex="-1"> <div> <h4 class="font-semibold text-left truncate header___aggs"> {{ title_header }} </h4> </div> </button> </div>
        <div class="ml-auto">
            <button v-if="type === 'danh_muc' && filter_adv" aria-label="menu" class=" font-semibold rounded px-0 py-2 leading-none focus:outline-none hover:text-blue-700 mr-2" tabindex="-1" @click="toogleMenuSearch" > <i class="mdi mdi-search" style="color: inherit" ></i> </button>
            <button aria-label="menu" class=" font-semibold rounded  px-0 py-2 leading-none focus:outline-none hover:text-blue-700 " tabindex="-1" @click="toogleMenu" > <i v-if="showMenuScope" class="mdi mdi-chevron-double-up" style="color: inherit" ></i> <i v-else class="mdi mdi-chevron-double-down" style="color: inherit" ></i></button>
        </div>
        </header>
        <div v-if="!renderData && showMenuScope" class="bg-white p-3 py-1"> <div v-for="tdRow in skeleton['rows']" v-bind:key="tdRow"> <span class="skeleton-box h-4 mt-1 w-3/5 inline-block"></span> <span class="skeleton-box h-4 mt-1 w-1/12 inline-block" style="float: right" ></span></div> </div>
        <div v-else v-show="showMenuScope" class="bg-white">
            <vuejx-autocomplete v-if="toogleSearch && type === 'danh_muc'" :config="{
                    placeholder: placeholder,
                    modelView: 'object',
                    chips: false, 
                    object: true, 
                    itemText: '_source.' + textKey,
                    itemValue: '_source.' + valKey,
                    link: [ { db: database, collection: collectionDM, condition: item_conditon, sort: collectionDM == 'C_TinhThanh' ? [{'TenMuc.keyword': 'asc'}] : sort } ],
                    column: columns, sort: sort
                }"
                @change_data="changeData"
            ></vuejx-autocomplete>
            <template v-if="type == 'danh_muc'">
                <vuejx-menu-aggs-view :key="items"
                    :items="items"
                    :group_size="group_size"
                    type="danh_muc"
                    :multiple="multiple"
                    :conditionAggs='conditionAggs'
                    :textKey="textKey"
                    :valKey="valKey"
                    :group_by="group_by"
                    :skeleton="skeleton"
                    :keywords="keywords"
                    :re_calculator="re_calculator"
                ></vuejx-menu-aggs-view>
            </template>
            <template v-if="renderData">
                <div class="flex justify-start cursor-pointer text-gray-900 hover:text-blue-700 hover:bg-gray-200 px-2 py-1 relative border-b border-gray-200 " :class="{ 'text-blue-700 bg-gray-200':  activeArray.indexOf(index) >= 0 }" v-for="(subItem, index) in items"  v-bind:key="index" >
                    <i v-if="multiple && activeArray.indexOf(index) >= 0" class="mdi mdi-checkbox-marked absolute left-0 top-0 text-sm" style="margin-top: 8px; margin-left: 8px"  @click="menuToParMutiple(subItem, index)" ></i>
                    <i v-else-if="multiple" class="mdi mdi-checkbox-blank-outline absolute left-0 top-0 text-sm" style="margin-top: 8px; margin-left: 8px" @click="menuToParMutiple(subItem, index)" ></i>
                    <div class="text-sm w-full" :class="{ 'mr-1': noreport, 'mr-8': !noreport, 'ml-5': multiple }" @click="menuToPar(subItem, index)" > {{ subItem["name"] }}  </div>
                    <i v-if="!noreport" class="absolute right-0 top-0 not-italic text-blue-700 text-sm" style="margin-top: 6px; margin-right: 13px"  @click="menuToPar(subItem, index)" >{{ subItem["counter"] }}</i>
                </div>
                <div class="flex justify-between relative" v-if="(paggingShow && renderData && items.length >= group_size) || paggingAction">
                    <button aria-label="btn" :class="{ 'cursor-not-allowed': pageCount === 0 || pageCount === 1, 'text-blue-700': pageCount > 1 }" @click="backAggs" class=" font-semibold  px-3 py-2 leading-none focus:outline-none hover:bg-primary hover:text-white" tabindex="-1" > <i class="mdi mdi-backburger text-xs"></i> </button>
                    <button aria-label="btn" :class="{ 'cursor-not-allowed': pageCountNext === 0, 'text-blue-700': pageCountNext !== 0 }" @click="nextAggs" class=" font-semibold px-3 py-2 leading-none focus:outline-none hover:bg-primary hover:text-white " tabindex="-1" > <i class="mdi mdi-forwardburger text-xs"></i></button>
                </div>
            </template>
        </div>
    </div>
    `},VueJXMenuAggsView={methods:{async init(e,t){let r=this;console.log('vm.$parent._.props.group_by["keyAggs"]',r.$parent._.props.group_by.keyAggs);const a=await window.VueJX.aggs(r,"danh_muc",r.$parent._.props.group_by,1,1,r.$parent._.props.valKey,r.$parent._.props.textKey,r.$parent.excludeXXX,e,r.$parent._.props.re_calculator,r.$parent._.props.keywords,r.$parent._.props.queryParam,r.$parent._.props.publicData,r.$parent._.props.multiple,r.$parent._.props.pageCountNext,r.$parent._.props.range,r.$parent._.props.custom_label);if(a&&a.pageCount==0&&r.$parent._.data.collectionDM){let n={};n[r.$parent.valKey]=t;const l=await window.VueJX.search(r,r.$parent._.data.collectionDM,[],[],[{match:n}],r.$parent._.props.columns,null,null,1,!1,1);if(l&&l.totalRecord>0)try{r.detail={name:l.dataResults[0]._source[r.$parent.textKey]}}catch{}}else r.detail=a&&Array.isArray(a.items)&&a.items.length>0?a.items[0]:{}},menuToParMutiple(){let e=[{key:"typeView",value:""},{key:"_page",value:"1"}];e.push({key:this.$parent._.props.group_by.keyAggs,value:""}),window.Vue.redirect(e,!0)}},mounted:function(){let e=this;e.$nextTick(function(){setTimeout(async()=>{let t=!0,r=window.Vue.router.currentRoute.value.query[e.$parent.group_by.keyAggs];e.multiple=e.$parent._.props.multiple;for(const a of e.$parent.items)if(String(a.code)==String(r)){t=!1;break}if(t&&r){let a=JSON.parse(JSON.stringify(e.$parent._.props.conditionAggs));r&&Array.isArray(r);{let n={};n[e.$parent.group_by.keyAggs]=r,a.push({match:n})}await e.init(a,r)}},0)})},data:()=>({detail:{},multiple:!1}),template:`
    <div v-if="detail && detail.name" class="flex justify-start cursor-pointer hover:text-blue-700 hover:bg-gray-200 px-2 py-2 relative border-b border-gray-200 text-blue-700 bg-gray-200">
        <i @click="menuToParMutiple" class="mdi mdi-checkbox-marked absolute left-0 top-0 text-sm" style="margin-top: 12px; margin-left: 8px" ></i>
        <div @click="menuToParMutiple" class="text-sm w-full mr-8" :class="{'ml-5': multiple }"> {{ detail.name }}  </div>
        <i @click="menuToParMutiple" v-if="!noreport" class="absolute right-0 top-0 not-italic text-blue-700 text-sm" style="margin-top: 10px; margin-right: 13px" >
            {{ detail.counter ? detail.counter : 0 }}
        </i>
    </div>
    `},VueJXSubMenu={props:{api:{type:String,default:()=>""},api_report:{type:String,default:()=>""},groupId:{type:String,default:()=>""},token:{type:String,default:()=>""},classMenu:{type:String,default:()=>"text-xs font-semibold text-gray-700 leading-none focus:outline-none mb-2 border hover:bg-blue-100 hover:text-blue-500 flex"},classMenuStatic:{type:String,default:()=>"text-xs bg-white px-3 py-2 font-semibold text-gray-700 leading-none focus:outline-none mb-2 border hover:bg-blue-100 hover:text-blue-500 flex"},sort:{type:Array,default:()=>[{order:"asc"}]},columns:{type:Array,default:()=>["type","MaMuc","TenMuc","PageGroup","targetURL"]},db:{type:String,default:()=>localStorage.getItem("db")},collection:{type:String,default:()=>""},page_group:{type:String,default:()=>""}},methods:{async pullDataSourceAPI(){let e=this;const t=window.Vue.router.currentRoute.value;e.menu_group=t.query.menu_group?t.query.menu_group:"",e.menu_group_step=t.query.step?t.query.step:"",await window.Vue.$axios.post("/tbtv-service/post",{headers:{headers:{accept:"application/json",groupid:e.groupId,Authorization:"Bearer "+(e.token?e.token:localStorage.getItem("token"))}},api:e.api,body:null,method:"GET"},{headers:{"Content-Type":"application/json"}}).then(function(r){if(e.submenus=[],r.data&&Array.isArray(r.data.data))for(const a of r.data.data){let n=[];if(Array.isArray(a.steps))for(let l of a.steps)n.push({buttonConfig:l.buttonConfig,dossierStatus:l.dossierStatus,dossierSubStatus:l.dossierSubStatus,menuStepName:l.menuStepName,stepCode:l.stepCode,stepName:l.stepName,menuGroup:a.menuGroup});else n=[{buttonConfig:a.buttonConfig,dossierStatus:a.dossierStatus,dossierSubStatus:a.dossierSubStatus,menuStepName:a.menuStepName,stepCode:a.stepCode,stepName:a.stepName}];e.submenus.push({_source:{MaMuc:a.menuGroup,TenMuc:a.menuName,buttonConfig:a.buttonConfig,hasViewText:a.hasViewText,icon:a.icon,menuType:a.menuType,order:a.order,queryParams:a.queryParams,steps:n}})}}).catch(function(r){e.submenus=[]}),e.menu_group_report={},await window.Vue.$axios.post("/tbtv-service/post",{headers:{headers:{accept:"application/json",groupid:e.groupId,Authorization:"Bearer "+(e.token?e.token:localStorage.getItem("token"))}},api:e.api_report,body:null,method:"GET"},{headers:{"Content-Type":"application/json"}}).then(function(r){if(r.data&&Array.isArray(r.data.data)){let a={};for(let n of r.data.data)n.stepName&&(a[n.menuGroup]?a[n.menuGroup]+=n.totalCount:a[n.menuGroup]=n.totalCount,e.menu_group_report[n.stepCode]=n.totalCount);e.menu_group_report=he(he({},e.menu_group_report),a);for(let n of r.data.data)n.stepName||e.menu_group_report[n.menuGroup]||(e.menu_group_report[n.menuGroup]=n.totalCount)}}).catch(function(r){})},async pullDataSource(){let e=this;const t=window.Vue.router.currentRoute.value;let r=t.params.site?t.params.site:localStorage.getItem("site"),a=t.params.page;const n=`query search($token: String, $body: JSON, $db: String, $collection: String) {
              results: search(token: $token, body: $body, db: $db, collection: $collection )
          }`;let l={size:50,sort:e.sort,_source:{includes:e.columns},query:{bool:{filter:{match:{site:r}},must:[{match:{PageGroup:a}}]}}};return e.page_group&&(l.query.bool.must=[{match:{PageGroup:e.page_group}}]),await window.Vue.$root.dispatch("vuejx_manager/graphqlQuery",{query:n,variables:{body:l,db:localStorage.getItem("db"),collection:e.collection}}).then(f=>{f.results!==null?e.submenus=f.results.hits.hits:e.submenus=[]}).catch(f=>{e.submenus=[]}),e.$emit("preAction",e.submenus),e.submenus},toPage(e,t){if(e==null||e===""){const r=window.Vue.router.currentRoute.value;let a=r.params.site?r.params.site:localStorage.getItem("site");window.Vue.redirect([{key:"_id",value:""}],!0,"/"+r.params.visibility+"/"+a+"/"+t,!0)}else window.location.href=e},toPageFilter(e){let t=this;const r=e.queryParams.substring(e.queryParams.indexOf("?")+1);let a=/[?&]([^=#]+)=([^&#]*)/g,n={},l={};for(;n=a.exec("&"+r);)l[n[1]]=decodeURIComponent(n[2]);let f=[{key:"menu_group",value:e.MaMuc},{key:"_id",value:""}];for(let s in l)s!=="_id"&&f.push({key:s,value:l[s]});t.menu_group=e.MaMuc,t.menu_group_step="",window.Vue.redirect(f,!0,"",!0)},toPageFilterStep(e){let t=this,r=[{key:"menu_group",value:e.menuGroup},{key:"step",value:e.stepCode},{key:"_id",value:""}];t.menu_group_step=e.stepCode,window.Vue.redirect(r,!0,"",!0)}},watch:{$route:async function(e,t){let r=window.location.hash.split("/"),a="";if(Array.isArray(r)&&r.length>0&&r[r.length-1]&&(String(r[r.length-1]).indexOf("?")!=-1?a=String(r[r.length-1]).substring(0,String(r[r.length-1]).indexOf("?")):a=r[r.length-1]),t.params.page==a){let n=this;setTimeout(async()=>{const l=window.Vue.router.currentRoute.value;n.menu_group=l.query.menu_group?l.query.menu_group:window.Vue.router.currentRoute.value.params.page},0)}}},mounted:function(){let e=this;e.$nextTick(function(){setTimeout(async()=>{e.submenus=[],e.renderMenu=!1,e.api?await e.pullDataSourceAPI():await e.pullDataSource();const t=window.Vue.router.currentRoute.value;e.menu_group=t.query.menu_group?t.query.menu_group:window.Vue.router.currentRoute.value.params.page,e.renderMenu=!0},0)})},data:()=>({submenus:[],renderMenu:!1,menu_group:"",menu_group_step:"",menu_group_report:{}}),template:`
    <div>
        <div class="flex">
        <template v-if="api && renderMenu">
            <button aria-label="btn"
            v-bind:class="[{ 'border-r-0': index < submenus.length - 1, 'border-l-0': index > 0, 'bg-blue-200': item._source.MaMuc == menu_group && menu_group }, classMenu, item._source.MaMuc]"
            tabindex="-1"
            v-for="(item, index) in submenus" v-bind:key="index"
            @click="toPageFilter(item._source)"
            >
            <div class="px-3 py-2">{{ item._source.TenMuc }} </div>
            <div class="-ml-1 bg-red-700 px-2 py-1 text-white rounded-lg mt-1 mr-3 font-normal counter">{{ menu_group_report[item._source.MaMuc] ? menu_group_report[item._source.MaMuc] : 0 }}</div>
            <template v-if="item._source.menuType == 1">
                <teleport to="#steps_submenu">
                <template v-for="(itemStep, indexStep) in item._source.steps" >
                    <button aria-label="btn" v-if="itemStep.menuGroup == menu_group && menu_group"
                    v-bind:class="[{ 'border-r-0': indexStep < item._source.steps.length - 1, 'border-l-0': indexStep > 0, 'bg-blue-200': itemStep.stepCode == menu_group_step && menu_group_step }, classMenu]"
                    tabindex="-1"
                    v-bind:key="indexStep"
                    @click="toPageFilterStep(itemStep)"
                    >
                    <div class="px-3 py-2">{{ itemStep.stepName }} </div>
                    <div class="-ml-1 bg-red-700 px-2 py-1 text-white rounded-lg mt-1 mr-3 font-normal">{{ menu_group_report[itemStep.stepCode] ? menu_group_report[itemStep.stepCode] : 0 }}</div>
                    </button>   
                </template>
                </teleport>
            </template>
            </button>
        </template>
        <template v-else-if="renderMenu">
            <button aria-label="btn"
            v-bind:class="[{ 'border-r-0': (index < submenus.length - 1 && menu_group !== item._source.MaMuc), 'bg-blue-200 border-blue-700 border-r-1': menu_group === item._source.MaMuc }, classMenuStatic, item._source.MaMuc]"
            tabindex="-1"
            v-for="(item, index) in submenus" v-bind:key="index"
            @click="toPage(item._source.targetURL, item._source.MaMuc)"
            >
            {{ item._source.TenMuc }}  
            </button>
        </template>
        </div>
        <div id="steps_submenu" class="flex">

        </div>
    </div>
    `},QLVTFilter={props:{reportLoadingText:{type:String,default:"Vui l\xF2ng ch\u1EDD trong khi ch\u1ED1t s\u1ED1 li\u1EC7u."},placeholderKeyowrds:{type:String,default:"T\xECm ki\u1EBFm ..."},state_query:{type:Array,default:()=>[]},filter_options:{type:Array,default:()=>[]},breadcrumbs:{type:Object,default:{}},simple:{type:Boolean,default:!1},export_title:{type:String,default:""},site:{type:String,default:""},report:{type:Object,default:null},multiple:{type:Boolean,default:!0},keywords_state:{type:Boolean,default:!0},filter_type:{type:Array,default:[{typeCode:"df",typeName:"T\xECm kh\xF4ng d\u1EA5u"},{typeCode:"cf",typeName:"T\xECm c\xF3 d\u1EA5u"}]},customFilterData:{type:Object,default:null},openSearchTool:{type:Boolean,default:!1},inlineFilter:{type:Boolean,default:!1}},methods:{async getFilterMenu(e,t){let r=this;if(String(t).indexOf("-")>0){let[a,n]=String(t).split("-");r.breadcrumbsData.push({text:a.replace(".0","")+" \u0111\u1EBFn "+n.replace(".0",""),disabled:!1,href:"javascript:;"})}else if(t!=null&&t!==""){let a={shortName:t};e.hasOwnProperty("dictCollection")&&(a["dictCollection._source.shortName"]=e.dictCollection),await ctx.root.$store.dispatch("vuejx_manager/userOne",{db:localStorage.getItem("db"),collection:e.collection,filter:a,keys:{shortName:1,title:1}}).then(n=>{n!=null&&r.breadcrumbsData.push({text:n.title,disabled:!1,href:"javascript:;"})}).catch(n=>{})}},async getSearchItems(){let e=this;e.preRender=!1,e.itemsFilter=[],e.searchObj={};let t={};for(const a of e.keyFilterItems)t[a.keyCode]=a;let r={};for(let a of e.itemsFilter)r[a.keyName]=a.keyName;await e.pullDataSource(),e.itemsFilter.length>0&&(e.searchAdvanced=!0),e.preRender=!0,e.searchObjNONE={}},addSearchItem(){this.preRender=!1,this.itemsFilter.push(this.keyFilterItems[0]),this.preRender=!0},showSearchAdvanced(){let e=this;e.searchAdvanced=!e.searchAdvanced;let t=window.Vue.router.currentRoute.value.query;if(!e.searchAdvanced&&t.adv_filter){let r=[];for(let n in e.customadv)n!="_view"&&r.push({key:n,value:""});r.push({key:"adv_filter",value:""});let a=null;t._view&&(a={_view:t._view}),window.Vue.redirect(r,!0,null,!0,e.multiple,!0,a)}},getDataReSource(e){return new Promise((t,r)=>{window.Vue.$axios.get(e).then(a=>{a.data.data.search!==null?t(a.data.data.search.hits.hits):t([])}).catch(a=>{r()})})},submitSearch(e,t){this.customadv,(e&&e.keyCode===13||e.type==="click"||e===void 0||t==="cbx")&&this.rawSearc()},rawSearc(){let e=this,t=window.Vue.router.currentRoute.value.query,r=[];e.keywords!==void 0&&e.keywords!==""?r.push({key:"keywords",value:String(e.keywords).trim()}):r.push({key:"keywords",value:""}),e.itemsFilter.length>0?(r.push({key:"adv_filter",value:!0}),e.searchAdvanced=!0):(r.push({key:"adv_filter",value:""}),e.searchAdvanced=!1),r.push({key:"_page",value:"1"}),r.push({key:"typeView",value:""});let a=!0;for(let n of r)if(n.key!=="_page"&&n.key!=="t"&&n.key!=="_filterAction"&&n.value!==void 0&&n.value!==null&&n.value!==""){a=!1;break}if(a?r.push({key:"_filterAction",value:""}):r.push({key:"_filterAction",value:"search"}),Object.keys(e.customadv).length>0&&e.customadv.constructor===Object){r=[],e.keywords!==void 0&&e.keywords!==""?r.push({key:"keywords",value:String(e.keywords).trim()}):r.push({key:"keywords",value:""});let n=0;for(let f of e.filter_options)f.keyCode&&e.customadv[f.keyCode]&&(n=n+1),r.push({key:f.keyCode,value:e.customadv[f.keyCode]});!e.searchAdvanced&&n>0&&(r.push({key:"adv_filter",value:!0}),e.searchAdvanced=!0);let l=null;if(t._view&&(l={_view:t._view}),console.log("querySearchquerySearch",r,Array.isArray(e.state_query)),e.state_query&&Array.isArray(e.state_query))for(const f in e.state_query)r.push({key:e.state_query[f],value:t[e.state_query[f]]?t[e.state_query[f]]:""});console.log("querySearchquerySearch2",r,t),window.Vue.redirect(r,!0,null,!0,e.multiple,!0,l)}else{if(e.state_query&&Array.isArray(e.state_query))for(const n in e.state_query)r.push({key:e.state_query[n],value:t[e.state_query[n]]?t[e.state_query[n]]:""});window.Vue.redirect(r,!0,null,!1,e.multiple)}},collapseMenu(){this.collapse=!this.collapse,this.showBread=!this.showBread,this.$emit("collapseMenu")},toPage(){this.$emit("toPage")},async pullDataSource(){let e=this;e.renderData=!1,e.renderData=!0},exportData(){this.$emit("export")},pickKyBaoCao(e){var r,a,n;let t=this;t.customadv[t.dataKyBaoCao.TuNgay]=(r=e._source)==null?void 0:r.TuNgay,t.customadv[t.dataKyBaoCao.DenNgay]=(a=e._source)==null?void 0:a.DenNgay,t.customadv[t.dataKyBaoCao.TuNgay]=(n=e._source)==null?void 0:n.TuNgay;for(let l in t.dataKyBaoCao)String(l).endsWith("Key")&&(t.customadv[t.dataKyBaoCao[l]]=t.dataKyBaoCao[String(l).slice(0,-3)]);t.rawSearc()},exportDataBaoCao(){this.$emit("export",{MauBaoCao:this.dataKyBaoCao,KyBaoCao:this.pickKy.MaMuc._source})}},mounted:function(){let e=this;e.$nextTick(function(){setTimeout(async()=>{e.renderLoginComp=!1;const t=window.Vue.router.currentRoute.value;e.siteCur=localStorage.getItem("site"),t.query.hasOwnProperty("keywords")&&t.query.keywords!==""&&(e.keywords_state?e.keywords=t.query.keywords:e.keywords=""),await e.getSearchItems(),t.query.hasOwnProperty("adv_filter")&&t.query.adv_filter==="true"&&(e.searchAdvanced=!0);for(let r in t.query)r!=="_id"&&r!=="_page"&&r!=="adv_filter"&&r!=="t"&&r!=="_filterAction"&&(e.customadv[r]=t.query[r]);if(e.report){let r={size:1,query:{bool:{filter:{match:{MaDinhDanh:e.report.MaDinhDanh}}}}};const a=`query search($token: String, $body: JSON, $db: String, $collection: String) {
                      results: search(token: $token, body: $body, db: $db, collection: $collection )
                  }`;await window.Vue.$root.dispatch("vuejx_manager/graphqlQuery",{query:a,variables:{body:r,db:localStorage.getItem("db"),collection:e.report.collection}}).then(n=>{n.results!==null?e.dataKyBaoCao=n.results.hits.hits[0]._source:e.dataKyBaoCao={}}).catch(n=>{e.dataKyBaoCao={}})}setTimeout(()=>{e.renderLoginComp=!0,e.openSearchTool&&(e.searchAdvanced=!0)},200)},0)})},data:()=>({itemsFilter:[],searchAdvanced:!1,keyFilterItems:[],keyFilterItemsTemp:[],typeFilterItems:[],collapse:!1,breadcrumbsData:[],showBread:!0,preRender:!1,keywords:"",renderData:!1,searchObj:{},searchObjNONE:{},customadv:{},siteCur:"",renderLoginComp:!1,dataKyBaoCao:{},pickKy:{}}),template:`
    <div class="qlt_timkiem flex-1">
      <div class="toolbar-search">
        <header class="flex items-center">
          <div class="flex w-full">
              <div class="flex flex-wrap items-stretch w-full mb-0 relative">
                <div class="w-full">
                  <input
                    class=" w-full p-2 focus:outline-none focus:cursor-text w-full border border-gray-400 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400"
                    v-model="keywords"
                    v-on:keyup="submitSearch"
                    :placeholder="placeholderKeyowrds"
                  />
                </div>
              </div>
          </div>
          <div class="flex ml-auto flex-1 ext___filter_ml_search">
            <slot name="filter_button" v-bind:collapse="collapse"
              v-bind:submitSearch="submitSearch"
              v-bind:showSearchAdvanced="showSearchAdvanced">
              <button aria-label="btn"
                class="font-semibold rounded px-3 pb-1 leading-none focus:outline-none bg-primary text-white min-w-full ml-1"
                style="min-width: 85px;min-height: 32px;"
                tabindex="-1"
                @click="submitSearch"
                v-if="simple"
              >
                T\xECm ki\u1EBFm
              </button>
              <button aria-label="btn"
                class="font-semibold rounded px-3 py-2 leading-none focus:outline-none border border-primary text-primary min-w-full ml-1"
                style="min-width: 90px;min-height: 32px;"
                tabindex="-1"
                @click="showSearchAdvanced"
                v-else-if="!simple && !inlineFilter"
              >
                {{ searchAdvanced ? 'Xo\xE1 b\u1ED9 l\u1ECDc' : 'N\xE2ng cao'}}
              </button>
              <button aria-label="btn"
                class="font-semibold rounded px-3 py-2 leading-none focus:outline-none bg-primary text-white min-w-full ml-1"
                style="min-width: 90px;min-height: 32px;"
                tabindex="-1"
                @click="exportData"
                v-else-if="export_title !== '' && String(simple) !== 'true'"
              >
                {{ export_title }}
              </button>
              <button aria-label="btn"
                class="font-semibold rounded px-3 pb-1 leading-none focus:outline-none bg-primary text-white min-w-full ml-1"
                style="min-width: 115px;min-height: 32px;"
                tabindex="-1"
                @click="toPage"
                v-else-if="export_title === '' && String(simple) !== 'true'"
              >
                <i
                  class="mdi mdi-playlist-plus"
                  style="font-size: 14px;"
                ></i>
                Th\xEAm m\u1EDBi
              </button>
              <button aria-label="btn"
                class="font-semibold rounded px-3 py-2 leading-none focus:outline-none border border-primary text-primary min-w-full ml-1"
                style="min-width: 40px;min-height: 32px;"
                tabindex="-1"
                @click="toPage" v-if="!simple"
              >
                <i
                  class="mdi mdi-playlist-plus"
                  style="font-size: 14px;"
                ></i>
              </button>
              <button aria-label="btn"
                class="font-semibold rounded px-3 py-2 leading-none focus:outline-none border border-primary text-primary min-w-full ml-1"
                style="min-width: 40px;min-height: 32px;"
                tabindex="-1"
                @click="collapseMenu"
                v-if="!simple"
              >
                <i v-if="!collapse"
                  class="mdi mdi-arrow-collapse-all"
                  style="font-size: 14px;"
                ></i>
                <i v-else
                  class="mdi mdi-arrow-expand-all"
                  style="font-size: 14px;"
                ></i>
              </button>
            </slot>
            <slot name="tfilter_inline" v-bind:filter="customadv" v-bind:submitSearch="submitSearch">
              <template v-if="inlineFilter && filter_options.length > 0">
                <v-layout wrap class="-mr-2 flex-1">
                  <template  v-for="(item, index) in filter_options" :key="index">
                    <v-flex 
                      v-if="renderData"
                      :class="[{'xs12 sm3 px-2': !item.class}, item.class]"
                    >
                      <vuejx-autocomplete
                        class="vuejx_combobox_selection"
                        v-if="item['fields'].toLocaleLowerCase() === 'autocomplete'"
                        :config='{
                            re_pull: customadv[item.keyCode],
                            hidden_label: true,
                            object: false,
                            model: item["keyCode"],
                            itemText: item["itemText"] ? item["itemText"] : "_source.TenMuc",
                            itemValue: item["itemValue"] ? item["itemValue"] : "_source.MaMuc",
                            placeholder: item["placeholder"],
                            data: item["items"],
                            link: item["link"],
                            column: item["column"] ? item["column"] : ["MaMuc", "TenMuc", "type"],
                            sort: item["sort"],
                            advFilter: true
                        }'
                        v-model:data="customadv"
                        v-model='customadv[item.keyCode]'
                        @change_data="submitSearch($event, 'cbx')"
                      ></vuejx-autocomplete>
                      <input
                        class="w-full p-2 focus:outline-none focus:cursor-text w-full border border-gray-400 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
                        v-model='customadv[item.keyCode]'
                        v-if="item['fields'].toLocaleLowerCase() === 'input'"
                        v-on:keyup="submitSearch"
                      />
                      <div class="flex flex-wrap -mx-1" v-if="item['fields'].toLocaleLowerCase() === 'date_range'">
                        <vuejx-date-combobox class="xs12 sm6 px-1" v-model='customadv[item.keyCode + "_from"]' :data-value="customadv[item.keyCode + '_from']" v-model:data="customadv" :config="{
                            model: item.keyCode + '_from'
                          }">
                        </vuejx-date-combobox>
                        <vuejx-date-combobox class="xs12 sm6 px-1" v-model='customadv[item.keyCode + "_to"]' :data-value="customadv[item.keyCode + '_to']" v-model:data="customadv" :config="{
                            model: item.keyCode + '_to'
                          }">
                        </vuejx-date-combobox>
                      </div>
                      <template v-else-if="item['fields'].toLocaleLowerCase() === 'date'">
                        <vuejx-date-combobox v-model='customadv[item.keyCode]' :data-value="customadv[item.keyCode]" v-model:data="customadv" :config="{
                            model: item.keyCode
                          }">
                        </vuejx-date-combobox>
                      </template>
                    </v-flex>
                  </template>
                </v-layout>
              </template>
            </slot>
          </div>
        </header>
      </div>
    </div>
    <div class="searchAdvanced-content py-1">
      <v-flex class="xs12 px-0" v-if="searchAdvanced && !inlineFilter">
        <slot name="tfilter" v-bind:filter="customadv" v-bind:submitSearch="submitSearch">
          <template v-if="filter_options.length > 0">
            <v-layout wrap class="mb-1 -mx-2">
              <template  v-for="(item, index) in filter_options" :key="index">
                <v-flex 
                  v-if="renderData"
                  :class="[{'xs12 sm3 px-2': !item.class}, item.class]"
                >
                  <div class="block font-semibold leading-normal truncate">
                    {{ item.hasOwnProperty('keyName') ? item['keyName'] : item['keyCode'] }}
                  </div>
                  <vuejx-autocomplete
                    class="vuejx_combobox_selection"
                    v-if="item['fields'].toLocaleLowerCase() === 'autocomplete'"
                    :config='{
                        re_pull: customadv[item.keyCode],
                        hidden_label: true,
                        object: false,
                        model: item["keyCode"],
                        itemText: item["itemText"] ? item["itemText"] : "_source.TenMuc",
                        itemValue: item["itemValue"] ? item["itemValue"] : "_source.MaMuc",
                        placeholder: item["placeholder"],
                        data: item["items"],
                        link: item["link"],
                        column: item["column"] ? item["column"] : ["MaMuc", "TenMuc", "type"],
                        sort: item["sort"],
                        advFilter: true
                    }'
                    v-model:data="customadv"
                    v-model='customadv[item.keyCode]'
                    @change_data="submitSearch($event, 'cbx')"
                  ></vuejx-autocomplete>
                  <input
                    class="w-full p-2 focus:outline-none focus:cursor-text w-full border border-gray-400 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
                    v-model='customadv[item.keyCode]'
                    v-if="item['fields'].toLocaleLowerCase() === 'input'"
                    v-on:keyup="submitSearch"
                  />
                  <div class="flex flex-wrap -mx-1" v-if="item['fields'].toLocaleLowerCase() === 'date_range'">
                    <vuejx-date-combobox class="xs12 sm6 px-1" v-model='customadv[item.keyCode + "_from"]' :data-value="customadv[item.keyCode + '_from']" v-model:data="customadv" :config="{
                        model: item.keyCode + '_from'
                      }">
                    </vuejx-date-combobox>
                    <vuejx-date-combobox class="xs12 sm6 px-1" v-model='customadv[item.keyCode + "_to"]' :data-value="customadv[item.keyCode + '_to']" v-model:data="customadv" :config="{
                        model: item.keyCode + '_to'
                      }">
                    </vuejx-date-combobox>
                  </div>
                  <template v-else-if="item['fields'].toLocaleLowerCase() === 'date'">
                    <vuejx-date-combobox v-model='customadv[item.keyCode]' :data-value="customadv[item.keyCode]" v-model:data="customadv" :config="{
                        model: item.keyCode
                      }">
                    </vuejx-date-combobox>
                  </template>
                </v-flex>
              </template>
            </v-layout>
          </template>
        </slot>
      </v-flex>
    </div>
    <div class="top-content flex items-center bg-white rounded p-1 w-full" v-if="report">
      <div class="text-green-700 uppercase font-bold"> {{ report.title }}</div>
      <template v-if="renderLoginComp">
        <div class="bar mx-4"></div>
        <div class="text-gray-500 text-xs">{{ dataKyBaoCao.TenGoi }}</div>
        <header class="flex items-center ml-auto">
          <div class="flex w-full">
            
            <vuejx-autocomplete :dynamicAPI="true" :delay="800" :maxItem="20" :config="{
                placeholder: report.placeholder,
                hidden_label: true,
                model: 'MaMuc',
                object: true, itemText: '_source.TenMuc',
                itemValue: '_source.MaMuc',
                link: [{ db: report.db, collection: report.collection_ky, dynamicText: 'MaMuc, TenMuc.keyword, TenMuc'}],
                column: ['type', 'MaMuc', 'TenMuc', 'TuNgay', 'DenNgay', 'LoaiKyBaoCao', 'pdfData'],
                sort: [ {MaMuc: 'desc'} ],
                }" v-model="pickKy['MaMuc']" v-model:data="pickKy" :site="site" @change_data="pickKyBaoCao">
              </vuejx-autocomplete>

          </div>
          <div class="flex ml-auto flex-1 ext___filter_ml"><button aria-label="btn" class="ml-3" @click="exportDataBaoCao"><i class="mdi mdi-download-circle-outline text-green-700"></i></button></div>
        </header>
      </template>
    </div>
    `},VuejxCombobox={props:{prefix:{type:String,default:""},dynamicAPI:{type:Boolean,default:!1},id:{type:String,default:""},config:{type:Object,required:!0,default:()=>({})},text_style:{type:Boolean,default:!1},call_onload:{type:Boolean,default:!1},item:{type:Object,required:!0,default:()=>({})},items:{type:Array,required:!0,default:()=>[]},defaultVal:{type:Array,default:()=>null},maxItem:{type:Number,required:!1,default:100},delay:{type:Number,required:!1,default:0},data:{type:Array,required:!1,default:()=>[]},site:{type:String,default:()=>localStorage.getItem("site")},khac:{type:Object,default:()=>null}},methods:{objectView(e,t,r){return window.Vue.objectView(e,t,r)},async init(){let e=this;if(e.khac&&e.dataForm[e.khac.model]){let t={};t[e.khac.model]=e.dataForm[e.khac.model],t[e.config.model]="",e.$emit("update:data",he(he({},e.data),t)),e.valueKhac=e.dataForm[e.khac.model],e.stateKhac=!0}else{if(e.renderCBX=!1,e.renderCBXDynamic=!1,e.items&&e.items.length>0)if(typeof e.items[0]!="object"){e.options=[];for(let t of e.items)e.options.push({_source:{shortName:t,title:e.prefix?e.prefix+" "+t:t}})}else e.options=e.items;else e.config.data&&Array.isArray(e.config.data)&&e.config.data.length>0?e.options=e.config.data:e.config.object||e.config.re_pull&&(e.options=await e.pullDataSource(""));if(e.dataForm&&e.config.model&&Array.isArray(e.dataForm[e.config.model])&&e.dataForm[e.config.model].length>0)if(typeof e.dataForm[e.config.model][0]!="object"){e.value=[];for(let t of e.dataForm[e.config.model])e.value.push({_source:{shortName:t,title:e.prefix?e.prefix+" "+t:t}})}else e.value=e.dataForm[e.config.model];else if((String(e.config.model).match(/\./g)||[]).length>=2,e.dataForm[e.config.model]?e.value=e.dataForm[e.config.model]:e.value=e.objectViewObject(e.dataForm,e.config.model),!e.config.object){let t=e.options.filter(function(r){return e.objectView(r,e.config.itemValue)==e.data[e.config.model]});t&&Array.isArray(t)&&(e.value=t[0])}e.dataForm&&e.config.model&&e.config.multiple&&e.dataForm[e.config.model]&&!Array.isArray(e.dataForm[e.config.model])&&(e.dataForm[e.config.model]=[e.dataForm[e.config.model]]),e.config.multiple&&!Array.isArray(e.value)&&(e.value=[]),e.defaultVal&&!e.value&&(e.value=e.defaultVal,e.dataForm[e.config.model]=e.value),setTimeout(()=>{e.renderCBX=!0,e.renderCBXDynamic=!0},0),e.$emit("input",e.dataForm[e.config.model])}},async changeCBX(e){let t=this;if(t.dataForm=t.data,t.dataForm[t.config.model]=e,e&&!Array.isArray(e)){if(typeof e=="object"&&t.config.object)try{if(t.config.model&&String(t.config.model).indexOf("TinhThanh")!==-1)for(let r in t.dataForm)(String(r).startsWith(String(t.config.model).replace("TinhThanh","QuanHuyen"))||String(r).startsWith(String(t.config.model).replace("TinhThanh","PhuongXa")))&&(t.dataForm[r]=null);else if(t.config.model&&String(t.config.model).indexOf("QuanHuyen")!==-1)for(let r in t.dataForm)String(r).startsWith(String(t.config.model).replace("QuanHuyen","PhuongXa"))&&(t.dataForm[r]=null)}catch{}}else(Array.isArray(e)&&e.length===0||e===void 0||e===null)&&(t.dataForm[t.config.model]=null);t.bindSelectedData()},async bindSelectedData(){let e=this,t=[];if(Array.isArray(e.items)&&e.items.length>0&&Array.isArray(e.dataForm[e.config.model])&&typeof e.items[0]!="object")for(let r of e.dataForm[e.config.model])r&&r._source&&t.push(r._source.shortName);if(Array.isArray(t)&&t.length>0&&(e.dataForm[e.config.model]=t),e.dataForm[e.config.model]){let r={};r[e.config.model]=e.dataForm[e.config.model],!window.Vue&&!window.Vue.pickBy&&await window.sleep(500),r=window.dotize.dotize.convert(r),e.dataForm=he(he({},e.dataForm),r)}e.$emit("update:data",e.dataForm),e.config.object||e.config.multiple?(e.$emit("change",e.dataForm[e.config.model]),e.$emit("change_data",e.dataForm[e.config.model]),e.$emit("input",e.dataForm[e.config.model])):(e.dataForm[e.config.model]=e.objectView(e.dataForm[e.config.model],e.config.itemValue),e.$emit("change",e.objectView(e.dataForm[e.config.model],e.config.itemValue)),e.$emit("change_data",e.objectView(e.dataForm[e.config.model],e.config.itemValue)),e.$emit("input",e.objectView(e.dataForm[e.config.model],e.config.itemValue)))},async clearCBX(){let e=this;e.value=null,e.dataForm[this.config.model]=null;let t={};t[this.config.model]=e.dataForm[this.config.model];let r=window.dotize.dotize.backward(t);e.dataForm=he(he({},e.dataForm),r);try{for(let a in e.dataForm)String(a).startsWith(e.config.model+".")&&(e.dataForm[a]=null)}catch{}this.bindSelectedData()},objectViewObject(item,key,defaultVal){try{const data=item,result=eval("data."+key);return result==null?"":result}catch(e){return defaultVal!=null?defaultVal:""}},async openCBX(){let e=this;e.loading=!0,e.config.data&&Array.isArray(e.config.data)?e.options=e.config.data:(e.dynamicAPI||String(e.config.model).indexOf("QuanHuyen")!==-1||String(e.config.model).indexOf("PhuongXa")!==-1?e.options=await e.pullDataSource():Array.isArray(e.options)&&e.options.length===0&&(e.options=await e.pullDataSource("")),e.options&&e.options.length===0&&(e.noOptionsText="Kh\xF4ng t\xECm th\u1EA5y d\u1EEF li\u1EC7u.")),e.loading=!1},async pullDataSource(e){let t=this;if(t.renderCBXDynamic=!1,!t.dynamicAPI&&t.options&&t.options.length>0)return t.options;if(t.config.hasOwnProperty("link")){let r=t.dataForm.site;r||(r=t.site),localStorage.getItem("site")&&(r=localStorage.getItem("site")),window.Vue.router.currentRoute.value.params.site&&(r=window.Vue.router.currentRoute.value.params.site);for(const a of t.config.link){const n=`query search($token: String, $body: JSON, $db: String, $collection: String) {
                                  results: search(token: $token, body: $body, db: $db, collection: $collection )
                              }`;let l=localStorage.getItem("short_tinhthanh");a.collection=="C_TinhThanh"&&l=="1"&&(t.config.itemText="_source.TenMuc_RutGon");let f={size:1e4,sort:a.collection=="C_TinhThanh"&&l=="1"?[{"TenMuc_RutGon.keyword":"asc"}]:t.config.sort,_source:{includes:a.collection=="C_TinhThanh"&&l=="1"?["MaMuc","TenMuc","type","TenMuc_RutGon"]:t.config.column},query:{bool:{filter:{match:{site:r}},must:[{bool:{should:[]}}]}}};if((a.hasOwnProperty("dung_chung")&&a.dung_chung||!r)&&delete f.query.bool.filter,a.hasOwnProperty("depends_on")){let s={},h=String(a.depends_on).split("."),p=null;for(let d of h)p===null?p=t.dataForm[d]:p!==void 0&&typeof p=="object"&&(p=p[d]);s[a.depends_on_link]=p,f.query.bool.must.push({bool:{should:[{match:s}]}})}else(!a.hasOwnProperty("level")||a.hasOwnProperty("level")&&a.level)&&f.query.bool.must.push({bool:{should:[{match:{level:1}},{bool:{must_not:{exists:{field:"level"}}}}]}});if(a.hasOwnProperty("condition")&&a.condition.length>0)for(const s in a.condition)f.query.bool.must.push(a.condition[s]);if(a.hasOwnProperty("visibility")&&a.collection==="vuejx_page"&&(f.query.bool.must.push({match:{siteParent:t.dataForm.shortName}}),f.query.bool.must.push({match:{visibility:a.visibility}})),a.collection==="dict_item"){a.collection="dict_item";let s="";!a.hasOwnProperty("dictCollection")&&t.dataForm.dictCollection!==void 0?s=t.dataForm.dictCollection._source.shortName:s=a.dictCollection,s!=null&&s!==""&&f.query.bool.must.push({match:{"dictCollection._source.shortName":s}})}if(a.hasOwnProperty("storage")?a.hasOwnProperty("storage")&&f.query.bool.must.push({match:{storage:a.storage}}):f.query.bool.must.push({match:{storage:"regular"}}),e){let s=e.toLocaleLowerCase().replace(/,/g," ").replace(/\./g," ").replace(/-/g," ").replace(/–/g," ").replace(/:/g," ").replace(/\//g," ").replace(/  /g," ");const h=s.split(" ");let p={},d={bool:{must:[{match_phrase_prefix:p}]}};if(a.dynamicText&&a.dynamicText.indexOf(",")!==-1){d={bool:{should:[]}};for(let y of a.dynamicText.split(",")){let g={},k={bool:{must:[{match:g}]}};if(String(y).endsWith(".keyword"))g[String(y).trim()]=e,k={bool:{must:[{match:g}]}};else{g[String(y).trim()]=s;for(const A of h){let M={};M[String(y).trim()]=String(A).toLocaleLowerCase(),Object.keys(M).length>0&&k.bool.must.push({prefix:M})}}d.bool.should.push(k)}}else if(String(a.dynamicText).endsWith(".keyword"))p[a.dynamicText]=e,d={bool:{must:[{match:p}]}};else{p[a.dynamicText]=s,d={bool:{must:[{match_phrase_prefix:p}]}};for(const y of h){let g={};g[a.dynamicText]=String(y).toLocaleLowerCase(),Object.keys(g).length>0&&d.bool.must.push({prefix:g})}}f.query.bool.must.push(d)}t.dynamicAPI&&(f.size=t.maxItem),!window.Vue&&!window.Vue.pickBy&&await window.sleep(500),await window.Vue.$root.dispatch("vuejx_manager/graphqlQuery",{query:n,variables:{body:f,db:localStorage.getItem("db"),collection:a.collection}}).then(s=>{if(s.results!==null){if(t.options=s.results.hits.hits,a.hasOwnProperty("nullVal")&&a.nullVal!==void 0&&t.options.unshift(a.nullVal),t.config.itemTextLv1){let p=[];for(let d of t.options){var h=window.dotize.dotize.convert(d);h[t.config.itemText+"___raw"]=h[t.config.itemTextLv1]+" - "+h[t.config.itemText],d=window.dotize.dotize.backward(h),p.push(d)}t.options=p}}else t.options=[]}).catch(s=>{t.options=[]})}}else if(t.config.hasOwnProperty("link_mongo")&&t.config.link_mongo==="")await window.Vue.$root.dispatch("vuejx_manager/userDb",{}).then(r=>{r!==void 0&&r.hasOwnProperty("hits")&&r.hits.hasOwnProperty("hits")?(t.options=r.hits.hits,link.hasOwnProperty("nullVal")&&link.nullVal!==void 0&&t.options.unshift(link.nullVal)):t.options=[]}).catch(r=>{t.options=[]});else if(t.config.hasOwnProperty("link_mongo")&&t.config.link_mongo!==""){t.options=[];for(const r of t.config.link_mongo)await window.Vue.$root.dispatch("vuejx_manager/userMany",{db:localStorage.getItem("db"),collection:r.collection,filter:r.filter,limit:1e3,keys:r.hasOwnProperty("keys")?r.keys:{shortName:1,title:1,type:1}}).then(a=>{a!==void 0&&a.hasOwnProperty("hits")&&a.hits.hasOwnProperty("hits")&&(t.options=a.hits.hits,r.hasOwnProperty("nullVal")&&r.nullVal!==void 0&&t.options.unshift(r.nullVal))}).catch(a=>{})}return setTimeout(()=>{t.renderCBXDynamic=!0},0),t.$emit("preAction",t.options),t.options},doKhac(){let e=this;e.stateKhac=!e.stateKhac,e.stateKhac?e.clearCBX():confirm("D\u1EEF li\u1EC7u Kh\xE1c s\u1EBD b\u1ECB xo\xE1.")?(e.dataForm[e.config[e.khac.model]]="",e.valueKhac=""):e.stateKhac=!0}},watch:{valueKhac:async function(e){let t={};t[this.khac.model]=e,t[this.config.model]="",this.$emit("update:data",he(he({},this.data),t))}},mounted:function(){let e=this;e.$nextTick(function(){e.dataForm=e.data,setTimeout(async()=>{await e.init()},0)})},data:()=>({value:null,options:[],loading:!1,noOptionsText:"loading ...",renderCBX:!1,renderCBXDynamic:!1,dataForm:{},stateKhac:!1,valueKhac:""}),template:`
    <div class="relative vuejx_combobox_selection" :id="id">
        <div class="block font-semibold truncate" :class="config['label_class'] ? config['label_class'] : 'leading-normal'" v-if="!config['hidden_label'] || !config.hasOwnProperty('hidden_label')">{{ config.hasOwnProperty("label") ? config["label"] : config["model"] }}<span class="required__class" v-if="config['required']">*</span></div>
        <div :class="'flex flex-wrap items-stretch w-full mb-0 relative autocomplete bg-gray-200 rounded ' + ('vuejx_cbx___' + String(config['model']).replace(/./g, '____'))" style="min-height: 33px">
            <template v-if="!stateKhac">
                <Multiselect v-if="!dynamicAPI && renderCBX" :class="{'flex-1': khac}"
                    v-model="value"
                    :mode="config['multiple'] ? 'tags' : 'single'"
                    :placeholder="config['placeholder']"
                    :trackBy="config['itemText'] ? config['itemText'] : '_source.title'"
                    :label="config['itemText'] ? (config['itemTextLv1'] ? config['itemText'] + '___raw' : config['itemText']) : '_source.title'"
                    :valueProp="config['itemValue'] ? config['itemValue'] : '_source.shortName'"
                    :object="true" :search="true" :searchable="true" :options="options"
                    @change="changeCBX" @open="openCBX" @clear="clearCBX" :loading="loading"
                    :noOptionsText="config['noOptionsText'] ? config['noOptionsText'] : noOptionsText"
                    :noResultsText="config['noResultsText'] ? config['noResultsText'] : 'Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u.'"
                >
                    <template v-slot:singlelabel>
                    <div class="multiselect-single-label">
                        <slot name="custom_singlelabel"
                        :valData="value"
                        :config="config"
                        >
                        {{ (typeof value === 'string' ? value : objectView(value, config['itemText'] ? config['itemText'] : '_source.title')) === '' ? config['placeholder'] : typeof value === 'string' ? config['placeholder'] : objectView(value, config['itemText'] ? config['itemText'] : '_source.title') }}
                        </slot>
                    </div>
                    </template>
                    <template v-slot:tag="{ option, handleTagRemove, disabled }">
                    <div class="multiselect-tag is-user">
                        {{
                        objectView(
                            option,
                            config["itemText"] ? config["itemText"] : "_source.title"
                        )
                        }}
                        <i
                        v-if="!disabled"
                        @click.prevent
                        @mousedown.prevent.stop="handleTagRemove(option, $event)"
                        />
                    </div>
                    </template>
                    <template v-slot:option="{ option }">
                    <slot name="option" :option="option">
                        <span>{{ objectView(option, config["itemText"] ? config["itemText"] : "_source.title") }}</span>
                    </slot>
                    </template>
                </Multiselect>
                <Multiselect v-else-if="renderCBX" :class="{'flex-1': khac}"
                    v-model="value"
                    :mode="config['multiple'] ? 'tags' : 'single'"
                    :placeholder="config['placeholder']"
                    :trackBy="config['itemText'] ? config['itemText'] : '_source.title'"
                    :label="config['itemText'] ? config['itemText'] : '_source.title'"
                    :valueProp="
                    config['itemValue'] ? config['itemValue'] : '_source.shortName'
                    "
                    :object="true"
                    :filterResults="false"
                    :minChars="1"
                    :resolveOnLoad="true"
                    :delay="delay"
                    :searchable="true"
                    :options="async function(query) {
                        return await pullDataSource(query)
                    }"
                    @change="changeCBX"
                    @open="openCBX"
                    @clear="clearCBX"
                    :loading="loading"
                    :noOptionsText="
                    config['noOptionsText'] ? config['noOptionsText'] : noOptionsText
                    "
                    :noResultsText="
                    config['noResultsText']
                        ? config['noResultsText']
                        : 'Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u.'
                    "
                >
                    <template v-slot:singlelabel>
                    <div class="multiselect-single-label">
                        <slot name="custom_singlelabel"
                        :valData="value"
                        :config="config"
                        >
                        {{ (typeof value === 'string' ? value : objectView(value, config['itemText'] ? config['itemText'] : '_source.title')) === '' ? config['placeholder'] : typeof value === 'string' ? config['placeholder'] : objectView(value, config['itemText'] ? config['itemText'] : '_source.title') }}
                        </slot>
                    </div>
                    </template>
                    <template v-slot:tag="{ option, handleTagRemove, disabled }">
                    <div class="multiselect-tag is-user">
                        {{
                        objectView(
                            option,
                            config["itemText"] ? config["itemText"] : "_source.title"
                        )
                        }}
                        <i
                        v-if="!disabled"
                        @click.prevent
                        @mousedown.prevent.stop="handleTagRemove(option, $event)"
                        />
                    </div>
                    </template>
                    <template v-slot:option="{ option }">
                    <span>{{ objectView(option, config["itemText"] ? config["itemText"] : "_source.title") }}</span>
                    </template>
                </Multiselect>
            </template>
            <template v-else>
             <input v-model="valueKhac" class="bg-gray-200 text-gray-700 p-2 focus:cursor-text w-full border border-gray-200 focus:outline-none focus:bg-white focus:border-gray-400 rounded flex-1" type="text" />
            </template>
            <template v-if="khac">
                <button @click="doKhac" class="leading-none font-semibold bg-blue-700 text-white ml-2 rounded px-4 py-2 focus:outline-none whitespace-nowrap flex-2" tabindex="-1">{{ dataForm[config[khac.model]] || stateKhac ? 'Quay l\u1EA1i' : khac.title }}</button>
            </template>
        </div>
    </div>
    `},VuejxDataReport={props:{query:{type:Array,default:()=>[]}},methods:{async init(){let e=this,t=`
              query search($token: String, 
          `,r={},a=" ",n={};for(let l of e.query){let f=Object.keys(l)[0],s="false";l[f].publicData&&(s=String(l[f].publicData)),t=t+" $body"+f+": JSON, $db"+f+": String, $collection"+f+": String",l[f].type==="data"?a=a+" "+f+": search(token: $token, body: $body"+f+", db: $db"+f+", collection: $collection"+f+" ), ":a=a+" "+f+": aggs(token: $token, body: $body"+f+", db: $db"+f+", collection: $collection"+f+', publicData: "'+s+'" ), ',l[f].report?n[f]=!0:n[f]=!1,r["body"+f]=l[f].body,r["db"+f]=localStorage.getItem("db"),r["collection"+f]=l[f].collection}t=t+" ){ "+a+" } ",await window.Vue.$root.dispatch("vuejx_manager/graphqlQuery",{query:t,variables:r}).then(l=>{const f=JSON.parse(JSON.stringify(l));let s={};for(let h in l)if(n[h]&&l[h].aggregations!==void 0&&l[h].aggregations!==null&&l[h].aggregations.report!==void 0&&l[h].aggregations.report!==null&&l[h].aggregations.report.aggregations!==void 0&&l[h].aggregations.report.aggregations!==null&&l[h].aggregations.report.aggregations.buckets!==void 0&&l[h].aggregations.report.aggregations.buckets!==null){let p=l[h].aggregations.report.doc_count,d={},y=0;for(let g of l[h].aggregations.report.aggregations.buckets)Object.prototype.hasOwnProperty.call(g,"ext")?d[g.key]=g.ext.value:d[g.key]=g.doc_count,y=y+g.doc_count;s[h]=p-y,l[h]=d}e.$emit("report-unknown",s),e.$emit("report",l),e.$emit("report_raw",f)}).catch(l=>{})}},mounted:function(){let e=this;e.$nextTick(function(){setTimeout(async()=>{await e.init()},0)})},template:"<span></span>"},VuejxDateCBX={props:{onlyTime:{type:Boolean,default:!1,required:!1},time:{type:Boolean,default:!1,required:!1},length:{type:Number,required:!0,default:8},fontSize:{type:Number,default:14,required:!1},inputColor:{type:String,default:"#42b983",required:!1},fontColor:{type:String,default:"#444444",required:!1},allowPaste:{type:Boolean,default:!0,required:!1},onlyNumber:{type:Boolean,default:!0,required:!1},borderColor:{type:String,default:"#2b6cb0"},id:{type:String,default:()=>""},data:{type:Object,default:()=>({})},inputClass:{type:String,default:()=>""},config:{type:Object,default:()=>({})},currentDate:{type:Boolean,default:()=>!1},stringDate:{type:Boolean,default:()=>!1},iconView:{type:Boolean,default:()=>!0},readonly:{type:Boolean,default:()=>!1}},methods:{async initDate(){let e=this;e.reDoView=!1;let t="",r="",a="",n="",l="";if(e.dataForm[e.config.model]&&String(e.dataForm[e.config.model]).indexOf("/")==-1){const f=new Date(parseInt(e.dataForm[e.config.model]));let s=f.getMonth()+1,h=f.getDate();t=f.getFullYear(),e.dataForm[e.config.model+"___Ngay"]===-1||(a=h<10?"0"+h:h),r=s<10?"0"+s:s,e.time&&(n=e.dataForm[e.config.model+"___Gio"],n=n<10?"0"+n:n,l=e.dataForm[e.config.model+"___Phut"],l=l<10?"0"+l:l)}else if(e.dataForm[e.config.model]&&String(e.dataForm[e.config.model]).indexOf("/")!=-1){const[f,s,h]=String(e.dataForm[e.config.model]).split("/"),p=new Date(s+"/"+f+"/"+h);let d=p.getMonth()+1,y=p.getDate();t=p.getFullYear(),e.dataForm[e.config.model+"___Ngay"]===-1||(a=y<10?"0"+y:y),r=d<10?"0"+d:d,e.time&&(n=e.dataForm[e.config.model+"___Gio"],n=n<10?"0"+n:n,l=e.dataForm[e.config.model+"___Phut"],l=l<10?"0"+l:l)}else if(e.currentDate){const f=new Date;let s=f.getMonth()+1,h=f.getDate();e.dataForm[e.config.model+"___Ngay"]===-1?(r=s<10?"0"+s:s,t=f.getFullYear()):(a=h<10?"0"+h:h,r=s<10?"0"+s:s,t=f.getFullYear()),e.time&&(n=f.getHours(),n=n<10?"0"+n:n,l=f.getMinutes(),l=l<10?"0"+l:l,e.dataForm[e.config.model+"___Gio"]=parseInt(n),e.dataForm[e.config.model+"___Phut"]=parseInt(l)),e.dataForm[e.config.model]=f.getTime(),e.dataForm[e.config.model+"___Ngay"]=a,e.dataForm[e.config.model+"___Thang"]=r,e.dataForm[e.config.model+"___Nam"]=t}e.dateView=String(a+""+r+t),e.onlyTime&&(e.dateView=""),e.time&&(e.timeView=String(n+""+l)),e.reDoView=!0},async handlePastedValues(e){this.allowPaste,(e&&e.keyCode===13||e===void 0)&&this.$emit("changeDate",e)},async returnFullString(){let e=this;if(e.dataForm[e.config.model]){let t=new Date(parseInt(e.dataForm[e.config.model]));const r=t.getFullYear();let a=t.getMonth()-1,n=t.getDate();parseInt(n)<10&&(n="0"+parseInt(n)),parseInt(a)<10&&(a="0"+parseInt(a)),e.dateView=n+"/"+a+"/"+r,e.dataForm[e.config.model]=new Date(a+"/"+n+"/"+r).getTime(),e.dataForm[e.config.model+"___Ngay"]=parseInt(n),e.dataForm[e.config.model+"___Thang"]=parseInt(a),e.dataForm[e.config.model+"___Nam"]=parseInt(r)}else e.dateView="",e.dataForm[e.config.model]=null,e.dataForm[e.config.model+"___Ngay"]=null,e.dataForm[e.config.model+"___Thang"]=null,e.dataForm[e.config.model+"___Nam"]=null;e.onlyTime&&(e.dataForm[e.config.model]=new Date(1976,0,1,0,0,0,0).getTime()),console.log("model",e.config.model,e.dataForm[e.config.model]),e.$emit("input",e.dataForm[e.config.model]),e.$emit("changeDate",e.dataForm[e.config.model])},removeDatePick(){this.dateView="",this.dataForm[this.config.model]=null,this.dataForm[this.config.model+"___Ngay"]=null,this.dataForm[this.config.model+"___Thang"]=null,this.dataForm[this.config.model+"___Nam"]=null},removeTimePick(){this.timeView="",this.dataForm[this.config.model+"___Gio"]=null,this.dataForm[this.config.model+"___Phut"]=null},async returnFullStringTime(){let e=this;e.onlyTime&&(e.dataForm[e.config.model]=new Date(1976,0,1,0,0,0,0).getTime());let t=new Date(e.dataForm[e.config.model]);if(String(e.timeView).indexOf(":")!==-1){e.reDoView=!1;let[r,a]=String(e.timeView).split(":"),n=!1;if(parseInt(r)>=24&&(r=0,n=!0),parseInt(a)>=60&&(a=0,n=!0),n&&(e.timeView=String((parseInt(r)<10?"0"+parseInt(r):parseInt(r))+""+(parseInt(a)<10?"0"+parseInt(a):parseInt(a))),setTimeout(()=>{window.Maska.create(".masked")},100)),e.dataForm[e.config.model]){let l=new Date(t.getFullYear(),t.getMonth(),t.getDate(),parseInt(r),parseInt(a),new Date().getSeconds());e.dataForm[e.config.model]=l.getTime(),e.dataForm[e.config.model+"___Gio"]=parseInt(r),e.dataForm[e.config.model+"___Phut"]=parseInt(a)}}else{e.timeView="";let r=new Date(t.getFullYear(),t.getMonth(),t.getDate());e.dataForm[e.config.model]=r.getTime(),e.dataForm[e.config.model+"___Gio"]=null,e.dataForm[e.config.model+"___Phut"]=null}e.$emit("input",e.dataForm[e.config.model]),e.$emit("changeDate",e.dataForm[e.config.model])}},mounted:function(){let e=this;e.$nextTick(function(){setTimeout(async()=>{await e.initDate(),window.Maska.create(".masked")},0)})},data:()=>({dateView:"",timeView:"",delFouce:0,reDoView:!1,format:"dd/MM/yyyy"}),computed:{dataForm:function(){return this.data}},template:`
    <div class="relative vuejx_date_selection" v-if="!time">
      <div class="block font-semibold truncate" :class="config['label_class'] ? config['label_class'] : 'leading-normal'" v-if="config.hasOwnProperty('label')">
          {{ config.hasOwnProperty('label') ? config['label'] : config['model'] }}
          <span
            class="required__class"
            v-if="config['required']"
          >*</span>
      </div>
      <div class="relative focus:cursor-text w-full border border-gray-200 bg-gray-200 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
        style="height: 34px;"
      >
        <n-date-picker
          v-model:value="dataForm[config['model']]"
          type="date" clearable :format="format" :update-value-on-close="true"
          :placeholder="'dd/mm/yyy'"
          @update:value="returnFullString"
        ></n-date-picker>
      </div>
    </div>
    <div class="relative flex vuejx_date_selection" v-else>
      <div class="relative w-full" v-if="!onlyTime">
        <div class="block font-semibold truncate" :class="config['label_class'] ? config['label_class'] : 'leading-normal'" v-if="config.hasOwnProperty('label')">
            {{ config.hasOwnProperty('label') ? config['label'] : config['model'] }}
            <span
              class="required__class"
              v-if="config['required']"
            >*</span>
        </div>
        <div class="relative p-2 focus:outline-none focus:cursor-text w-full border border-gray-200 bg-gray-200 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded">
        
        <input v-bind:class="[{ 'pointer-events-none': readonly }, inputClass]" @change="returnFullString" style="background: transparent;" class="masked focus:cursor-text focus:outline-none" data-mask='##/##/####' placeholder="dd/mm/yyyy" v-model="dateView">
          <i v-if="iconView" :class="{'pointer-events-none': readonly}" class="mdi mdi-calendar-clock text-sm absolute right-0 pr-2 top-0 pt-2"></i>
          <i :class="{'mr-8': iconView, 'mr-4': !iconView, 'pointer-events-none': readonly}" class="mdi mdi-close text-sm absolute right-0 cursor-pointer top-0 pt-2" @click="removeDatePick"></i>
        </div>
      </div>
      <div class="relative" :class="{'w-full': onlyTime, 'ml-4': !onlyTime}">
        <div class="block font-semibold truncate" :class="config['label_class'] ? config['label_class'] : 'leading-normal'" v-if="config.hasOwnProperty('label')">
            {{ config.hasOwnProperty('label_time') ? config['label_time'] : 'Gi\u1EDD ph\xFAt:' }}
        </div>
        <div class="relative p-2 focus:outline-none focus:cursor-text w-full border border-gray-200 bg-gray-200 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
          style="height: 33px; line-height: 17px;padding-top: 6px;"
        >
          <input v-bind:class="[{ 'pointer-events-none': readonly }, inputClass]" @change="returnFullStringTime" style="background: transparent;" class="masked focus:cursor-text focus:outline-none w-full" data-mask='##:##' placeholder="hh:mm" v-model="timeView">
          <i v-if="iconView" :class="{'pointer-events-none': readonly}" class="mdi mdi-calendar-clock text-sm absolute right-0 pr-2 top-0 pt-2"></i>
          <i :class="{'mr-8': iconView, 'mr-4': !iconView, 'pointer-events-none': readonly}" class="mdi mdi-close text-sm absolute right-0 cursor-pointer top-0 pt-2" @click="removeTimePick"></i>
        </div>
      </div>
    </div>
    `},VuejxUpload={props:{config:{type:Object,default:()=>({})},data:{type:Object,default:()=>({})},site:{type:String,default:localStorage.getItem("site")},text_style:{type:Boolean,default:!1},call_onload:{type:Boolean,default:!1},helpText:{type:String,default:"T\u1EA3i file \u0111\xEDnh k\xE8m"},uploadUrl:{type:String,default:""},multiple:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},maxFiles:{type:Number,default:20},metadata:{type:Object,default:{}},accept:{type:String,default:"*"},id:{type:String,default:"file___"+new Date().getTime()},auto_upload:{type:Boolean,default:!0}},methods:{async clean(){this.formData={}},async init(){},async change_data(e){this.$emit("input",e)},async doUploadFile(e){let t=this;if(t.multiple||(t.files=[]),Array.isArray(t.files)&&t.files.length===0)t.files=Array.from(e.target.files);else{const r=Array.from(e.target.files);for(const a of r)t.files.push(a)}},async removeFile(e){this.files.splice(e,1)},async removeFileData(e,t){let r=this;r.data[r.config.model].splice(e,1),r.$emit("update:dataForm",r.data),r.confirmDeleteFile=!0,r.idFileToRemoves.push({id:t.id,bucketName:t.bucketName})},async autoUpload(){this.auto_upload&&this.doUploadFileAPIAuto()},async doUploadFileAPIAuto(){let e=this,t=new FormData;e.renderUploadFile=!0;let r=document.getElementById(e.id);for(const n of r.files)t.append("files",n,n.name);let a={headers:{}};a.headers["Content-Type"]="multipart/form-data",a.headers.token=localStorage.getItem("token"),a.headers.metadata=encodeURIComponent(JSON.stringify(e.metadata)),await window.Vue.$axios.post(e.uploadUrl.replace("security","security/file"),t,a).then(function(n){n?(e.data[e.config.model]=n.data,e.$emit("update:dataForm",e.data),e.$emit("done_upload",n.data),window.Vue.toastr.success("Th\xE0nh c\xF4ng.")):window.Vue.toastr.error("Error.")}).catch(n=>{window.Vue.toastr.error(n)}),e.renderUploadFile=!1},async doUploadFileAPI(){let e=this;if(confirm("X\xE1c nh\u1EADn t\u1EA3i file.")==!0){let r=new FormData,a=document.getElementById(e.id);for(const l of a.files)r.append("files",l,l.name);let n={headers:{}};n.headers["Content-Type"]="multipart/form-data",n.headers.token=localStorage.getItem("token"),n.headers.metadata=encodeURIComponent(JSON.stringify(e.metadata)),await window.Vue.$axios.post(API.security+e.uploadUrl.replace("security","security/file"),r,n).then(function(l){l?(e.data[e.config.model]=l.data,e.$emit("update:dataForm",e.data),e.$emit("done_upload",l.data),window.Vue.toastr.success("Th\xE0nh c\xF4ng.")):window.Vue.toastr.error("Error.")}).catch(l=>{window.Vue.toastr.error(error)})}},async doRemoveFile(){let e=this;if(confirm("X\xE1c nh\u1EADn xo\xE1 file.")==!0){for(let r of e.idFileToRemoves)await window.Vue.$axios.post("/security/file/upload_remove/"+r.bucketName+"/"+r.filename,{},{headers:{}}).then(function(a){let n=0;for(let l of e.data[e.config.model]){l.id===r.id&&e.data[e.config.model].splice(n,1),n=n+1;break}e.$emit("update:dataForm",e.data),e.$emit("done_upload",a.data)}).catch(a=>{});e.confirmDeleteFile=!1}},previewFile(e,t){window.open("/security/file/convert_fs/"+e+"/"+t)}},mounted:function(){let e=this;e.$nextTick(function(){setTimeout(async()=>{await e.clean(),await e.init()},0)})},data:()=>({formData:{},files:[],loadingAction:!1,confirmDeleteFile:!1,idFileToRemoves:[],renderUploadFile:!0}),template:`
    <div>
      <label class="cursor-pointer flex" @change="doUploadFile">
        <div class="flex block font-semibold leading-normal truncate upload___comp">
          <span v-html="helpText.replace('*', '<span>*</span>')"></span> &nbsp;
          <svg v-if="editable"
            class="w-4 h-4 mt-2"
            fill="currentColor"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 20 20"
          >
            <path
              d="M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z"
            />
          </svg>
          <input :id="id" type="file" class="hidden" :multiple="multiple" :accept="accept" @change="autoUpload"/>
        </div>
        <button aria-label="btn"
          v-if="files.length > 0 && !auto_upload && editable"
          class="flex items-center px-4 py-0 text-xs font-semibold leading-none focus:outline-none bg-white text-blue-700 hover:bg-button border-blue-700"
          tabindex="-1"
          :class="{'opacity-50 cursor-not-allowed pointer-events-none bg-gray-300': loadingAction}"
          @click="doUploadFileAPI"
        >
          T\u1EA3i l\xEAn
          <i
            class="mdi cursor-pointer text-blue-700 ml-1"
            :class="{'mdi-loading mdi-spin': loadingAction, 'mdi-check-all': !loadingAction}"
            style="font-size: 14px;"
          ></i>
        </button>
        <button aria-label="btn"
          v-if="confirmDeleteFile && editable"
          class="flex items-center px-4 py-0 text-xs font-semibold leading-none focus:outline-none bg-white text-blue-700 hover:bg-button border-blue-700"
          tabindex="-1"
          :class="{'opacity-50 cursor-not-allowed pointer-events-none bg-gray-300': loadingAction}"
          @click="doRemoveFile"
        >
          Xo\xE1 file
          <i
            class="mdi cursor-pointer text-blue-700 ml-1"
            :class="{'mdi-loading mdi-spin': loadingAction, 'mdi-check-all': !loadingAction}"
            style="font-size: 14px;"
          ></i>
        </button>
      </label>
      <div
        class="flex flex-wrap items-stretch w-full mb-0 relative"
        style="min-height: 34px;"
        v-if="files.length > 0 && renderUploadFile"
      >
        <div
          class="p-0 focus:outline-none focus:cursor-text w-full border border-gray-200 bg-gray-200 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
        >
          <span
            class="file___wrap text-xs bg-white py-1 px-2 text-primary align-middle inline-block m-1 relative"
            style="margin: 4px;padding: 4px 26px 2px 2px;overflow: hidden;border-radius: 4px;"
            v-for="(item, index) in files"
            v-bind:key="index"
          >
            <i
              class="mdi text-xs text-blue-700 absolute"
              :class='{"mdi-file-image": item["type"].indexOf("image") !== -1,
              "mdi-file-word": item["type"].indexOf(".document") !== -1,
              "mdi-file-excel": item["type"].indexOf(".sheet") !== -1,
              "mdi-zip-box-outline": item["type"].indexOf(".zip") !== -1}'
            ></i>
            <span class="mx-1">{{ item['name'] }}</span>
            <i v-if="editable" class="mdi mdi-close text-xs cursor-pointer text-red-700 absolute" @click="removeFile(index)"></i>
          </span>
        </div>
      </div>
      <div
        class="flex flex-wrap items-stretch w-full mb-0 relative"
        style="min-height: 34px;"
        v-if="Array.isArray(data[config.model]) && data[config.model].length > 0"
      >
        <div
          class="p-0 focus:outline-none focus:cursor-text w-full border border-gray-200 bg-gray-200 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
        >
          <span
            class="file___wrap text-xs bg-white py-1 px-2 text-primary align-middle inline-block m-1 relative"
            style="margin: 4px;padding: 4px 26px 2px 2px;overflow: hidden;border-radius: 4px;"
            v-for="(item, index) in data[config.model]"
            v-bind:key="index"
          >
            <a :href="'/security/file/' + item['bucketName'] + '/' + item['filename']" target="_blank" class="append___icons">
              <i
                class="mdi text-xs text-blue-700 absolute"
                :class='{"mdi-file-image": item["mimetype"].indexOf("image") !== -1,
                "mdi-file-word": item["mimetype"].indexOf(".document") !== -1,
                "mdi-file-excel": item["mimetype"].indexOf(".sheet") !== -1,
                "mdi-zip-box-outline": item["mimetype"].indexOf(".zip") !== -1}'
              ></i>
            </a>
            <span class="mx-1 cursor-pointer" @click="previewFile(item['bucketName'], item['filename'])">{{ item['originalname'] }}</span>
            <i v-if="editable" class="mdi mdi-close text-xs cursor-pointer text-red-700 absolute" @click="removeFileData(index, item)"></i>
          </span>
        </div>
      </div>
    </div>
    `},VuejxUpload2={props:{config:{type:Object,default:()=>({})},data:{type:Object,default:()=>({})},site:{type:String,default:localStorage.getItem("site")},text_style:{type:Boolean,default:!1},call_onload:{type:Boolean,default:!1},helpText:{type:String,default:"T\u1EA3i file \u0111\xEDnh k\xE8m"},uploadUrl:{type:String,default:""},multiple:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},maxFiles:{type:Number,default:20},metadata:{type:Object,default:{}},accept:{type:String,default:"*"},id:{type:String,default:"file___"+new Date().getTime()},auto_upload:{type:Boolean,default:!0}},methods:{async clean(){this.formData={}},async init(){},async change_data(e){this.$emit("input",e)},async doUploadFile(e){let t=this;if(t.multiple||(t.files=[]),Array.isArray(t.files)&&t.files.length===0)t.files=Array.from(e.target.files);else{const r=Array.from(e.target.files);for(const a of r)t.files.push(a)}},async removeFile(e){this.files.splice(e,1)},async removeFileData(e,t){let r=this;r.data[r.config.model].splice(e,1),r.$emit("update:dataForm",r.data),r.confirmDeleteFile=!0,r.idFileToRemoves.push({id:t.id,bucketName:t.bucketName})},async autoUpload(){this.auto_upload&&this.doUploadFileAPIAuto()},async doUploadFileAPIAuto(){let e=this,t=new FormData;e.renderUploadFile=!0;let r=document.getElementById(e.id);for(const n of r.files)t.append("files",n,n.name);let a={headers:{}};a.headers["Content-Type"]="multipart/form-data",a.headers.token=localStorage.getItem("token"),a.headers.metadata=encodeURIComponent(JSON.stringify(e.metadata)),await window.Vue.$axios.post(e.uploadUrl.replace("security","security/file"),t,a).then(function(n){n?(e.data[e.config.model]=n.data,e.$emit("update:dataForm",e.data),e.$emit("done_upload",n.data),window.Vue.toastr.success("Th\xE0nh c\xF4ng.")):window.Vue.toastr.error("Error.")}).catch(n=>{window.Vue.toastr.error(n)}),e.renderUploadFile=!1},async doUploadFileAPI(){let e=this;if(confirm("X\xE1c nh\u1EADn t\u1EA3i file.")==!0){let r=new FormData,a=document.getElementById(e.id);for(const l of a.files)r.append("files",l,l.name);let n={headers:{}};n.headers["Content-Type"]="multipart/form-data",n.headers.token=localStorage.getItem("token"),n.headers.metadata=encodeURIComponent(JSON.stringify(e.metadata)),await window.Vue.$axios.post(API.security+e.uploadUrl.replace("security","security/file"),r,n).then(function(l){l?(e.data[e.config.model]=l.data,e.$emit("update:dataForm",e.data),e.$emit("done_upload",l.data),window.Vue.toastr.success("Th\xE0nh c\xF4ng.")):window.Vue.toastr.error("Error.")}).catch(l=>{window.Vue.toastr.error(error)})}},async doRemoveFile(){let e=this;if(confirm("X\xE1c nh\u1EADn xo\xE1 file.")==!0){for(let r of e.idFileToRemoves)await window.Vue.$axios.post("/security/file/upload_remove/"+r.bucketName+"/"+r.filename,{},{headers:{}}).then(function(a){let n=0;for(let l of e.data[e.config.model]){l.id===r.id&&e.data[e.config.model].splice(n,1),n=n+1;break}e.$emit("update:dataForm",e.data),e.$emit("done_upload",a.data)}).catch(a=>{});e.confirmDeleteFile=!1}},previewFile(e,t){window.open("/security/file/convert_fs/"+e+"/"+t)}},mounted:function(){let e=this;e.$nextTick(function(){setTimeout(async()=>{await e.clean(),await e.init()},0)})},data:()=>({formData:{},files:[],loadingAction:!1,confirmDeleteFile:!1,idFileToRemoves:[],renderUploadFile:!0}),template:`
    <div class="relative">
    <label class="cursor-pointer" @change="doUploadFile">
      <div class="block font-semibold leading-normal truncate upload___comp ">
        <svg v-if="editable"
          class="w-4 h-4 mt-2 mr-2 absolute"
          fill="currentColor"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 20 20"
        >
          <path
            d="M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z"
          />
        </svg>
        <span class="ml-6" v-html="helpText.replace('*', '<span>*</span>')"></span> &nbsp;
        <input :id="id" type="file" class="hidden" :multiple="multiple" :accept="accept" @change="autoUpload"/>
      </div>
      <button aria-label="btn"
        v-if="files.length > 0 && !auto_upload && editable"
        class="flex items-center px-4 py-0 text-xs font-semibold leading-none focus:outline-none bg-white text-blue-700 hover:bg-button border-blue-700"
        tabindex="-1"
        :class="{'opacity-50 cursor-not-allowed pointer-events-none bg-gray-300': loadingAction}"
        @click="doUploadFileAPI"
      >
        T\u1EA3i l\xEAn
        <i
          class="mdi cursor-pointer text-blue-700 ml-1"
          :class="{'mdi-loading mdi-spin': loadingAction, 'mdi-check-all': !loadingAction}"
          style="font-size: 14px;"
        ></i>
      </button>
      <button aria-label="btn"
        v-if="confirmDeleteFile && editable"
        class="flex items-center px-4 py-0 text-xs font-semibold leading-none focus:outline-none bg-red-700 text-white hover:bg-button border-blue-700"
        tabindex="-1"
        :class="{'opacity-50 cursor-not-allowed pointer-events-none bg-gray-300': loadingAction}"
        @click="doRemoveFile"
        style="
          position: absolute;
          top: 0;
          right: 0;
          padding: 10px 8px 8px 12px;
        "
      >
        Xo\xE1 file
        <i
          class="mdi cursor-pointer text-blue-700 ml-1"
          :class="{'mdi-loading mdi-spin': loadingAction, 'mdi-check-all': !loadingAction}"
          style="font-size: 14px;"
        ></i>
      </button>
    </label>
    <div
      class="flex flex-wrap items-stretch w-full mb-0 relative"
      style="min-height: 34px;"
      v-if="files.length > 0 && renderUploadFile"
    >
      <div
        class="p-0 focus:outline-none focus:cursor-text w-full border border-gray-200 bg-gray-200 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
      >
        <span
          class="file___wrap text-xs bg-white py-1 px-2 text-primary align-middle inline-block m-1 relative"
          style="margin: 4px;padding: 4px 26px 2px 2px;overflow: hidden;border-radius: 4px;"
          v-for="(item, index) in files"
          v-bind:key="index"
        >
          <i
            class="mdi text-xs text-blue-700 absolute"
            :class='{"mdi-file-image": item["type"].indexOf("image") !== -1,
            "mdi-file-word": item["type"].indexOf(".document") !== -1,
            "mdi-file-excel": item["type"].indexOf(".sheet") !== -1,
            "mdi-zip-box-outline": item["type"].indexOf(".zip") !== -1}'
          ></i>
          <span class="mx-1">{{ item['name'] }}</span>
          <i v-if="editable" class="mdi mdi-close text-xs cursor-pointer text-red-700 absolute" @click="removeFile(index)"></i>
        </span>
      </div>
    </div>
    <div
      class="flex flex-wrap items-stretch w-full mb-0 relative"
      style="min-height: 34px;"
      v-if="Array.isArray(data[config.model]) && data[config.model].length > 0"
    >
      <div
        class="p-0 focus:outline-none focus:cursor-text w-full border border-gray-200 bg-gray-200 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
      >
        <span
          class="file___wrap text-xs bg-white py-1 px-2 text-primary align-middle inline-block m-1 relative"
          style="margin: 4px;padding: 4px 26px 2px 2px;overflow: hidden;border-radius: 4px;"
          v-for="(item, index) in data[config.model]"
          v-bind:key="index"
        >
          <a :href="'/security/file/' + item['bucketName'] + '/' + item['filename']" target="_blank" class="append___icons">
            <i
              class="mdi text-xs text-blue-700 absolute"
              :class='{"mdi-file-image": item["mimetype"].indexOf("image") !== -1,
              "mdi-file-word": item["mimetype"].indexOf(".document") !== -1,
              "mdi-file-excel": item["mimetype"].indexOf(".sheet") !== -1,
              "mdi-zip-box-outline": item["mimetype"].indexOf(".zip") !== -1}'
            ></i>
          </a>
          <span class="mx-1 cursor-pointer" @click="previewFile(item['bucketName'], item['filename'])">{{ item['originalname'] }}</span>
          <i v-if="editable" class="mdi mdi-close text-xs cursor-pointer text-red-700 absolute" @click="removeFileData(index, item)"></i>
        </span>
      </div>
    </div>
  </div>
    `},VuejxCMS={props:{crud:{type:Boolean,default:()=>!1},remove:{type:Boolean,default:()=>!0},import_data:{type:Boolean,default:()=>!0},export_data:{type:Boolean,default:()=>!0},tags:{type:Array,default:()=>[]},mode:{type:String,default:()=>"edit"}},methods:{async init(){let vm=this;vm.tableConfig=null;const newRoute=window.Vue.router.currentRoute.value;let condition={bool:{should:[]}};for(const e of vm.tags)condition.bool.should.push({match:{tag:e}});newRoute.query._collection&&(vm.collection=newRoute.query._collection,condition.bool.should.push({match:{shortName:{query:vm.collection,boost:10}}})),newRoute.query._id&&(vm.id=newRoute.query._id);const searchData=await window.VueJX.search(vm,"vuejx_collection",[],[],[condition],null,[{_score:"desc"},{order:"asc"}],"regular",1e4,!1,1e4);if(searchData&&Array.isArray(searchData.dataResults)&&searchData.dataResults.length>0)if(vm.collections=searchData.dataResults,Array.isArray(vm.collections)&&vm.collections.length>0)if(vm.detail=vm.collections[0]._source,vm.detail.tableConfig&&String(vm.detail.tableConfig).length>20&&(vm.tableConfig=eval("( "+vm.detail.tableConfig+" )")),vm.detail.metadataConfig&&String(vm.detail.metadataConfig).length>20&&(vm.metadataConfig=eval("( "+vm.detail.metadataConfig+" )"),vm.metadataConfig.form.push({type:"done"})),vm.tableConfig&&Array.isArray(vm.tableConfig.config_columns))for(let e of vm.tableConfig.config_columns)e.value=e.field,e.title=e.headerText,e.width=e.width,e.class||(e.class="text-left");else vm.tableConfig={title:"Danh s\xE1ch",columns:["MaMuc","TenMuc"],config_columns:[{field:"_source.MaMuc",field_query:"MaMuc",field_sort:"MaMuc",headerText:"MaMuc",class:"text-left",width:350,minWidth:350,value:"_source.MaMuc",title:"MaMuc"},{field:"_source.TenMuc",field_query:"TenMuc",field_sort:"TenMuc",headerText:"TenMuc",class:"text-left",value:"_source.TenMuc",title:"TenMuc"}],sort:[{createdAt:"asc"}]};else vm.detail=null,vm.tableConfig=null,vm.metadataConfig=null;else vm.collections=[],vm.detail=null,vm.tableConfig=null,vm.metadataConfig=null},backCol(){let e=[];e.push({key:"_id",value:""}),e.push({key:"_t",value:new Date().getTime()}),window.Vue.redirect(e)},pickColl(e,t){let r=[];r.push({key:"_collection",value:e}),r.push({key:"_idCol",value:t}),r.push({key:"_id",value:""}),r.push({key:"_pagging",value:""}),r.push({key:"_page",value:"1"}),r.push({key:"_s_n",value:""}),r.push({key:"_s_b",value:""}),r.push({key:"keywords",value:""}),r.push({key:"_t",value:new Date().getTime()}),window.Vue.redirect(r)},afterSubmit(){const e=window.Vue.router.currentRoute.value;let t=[];t.push({key:"_collection",value:e.query._collection}),t.push({key:"_idCol",value:e.query._idCol}),t.push({key:"_id",value:""}),setTimeout(()=>{window.Vue.redirect(t)},500)}},watch:{$route:async function(e,t){if(t.query._collection!=e.query._collection||t.query._id!=e.query._id){let r=this;r.id="",r.detail=null,await r.init()}}},mounted:function(){let e=this;e.$nextTick(function(){setTimeout(async()=>{await e.init()},0)})},data:()=>({collections:[],collection:"",detail:null,tableConfig:null,metadataConfig:null,id:"",site:localStorage.getItem("site"),vuejxData:{},searchCol:""}),template:`
    <div class="flex-grow flex min-h-0 container grid-list-md">
        <section class="flex flex-col w-full max-w-xs flex-none bg-gray-100 min-h-0 overflow-auto h-screen">
            <div class="flex flex-wrap py-1 mb-0 px-4 pl-0 relative">
                <div class="w-full"><input v-model="searchCol" class="appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-2 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-400" placeholder="T\xECm ki\u1EBFm \u0111\u1ED1i t\u01B0\u1EE3ng ..."><button tabindex="-1" class="absolute inset-y-0 right-0 px-2 flex items-center focus:outline-none tooltip" style="right: 12px;"><i class="mdi text-gray-600 hover:text-primary mdi-home-search-outline" style="font-size: 22px;"></i><span class="tooltip-text mt-8">T\xECm ki\u1EBFm n\xE2ng cao</span></button></div>
                <article tabindex="-1" v-if="detail"
                    class="border-primary w-full mt-3 cursor-pointer border rounded-md p-3 bg-white flex text-gray-700 hover:border-primary focus:outline-none focus:border-primar"><span class="flex-none pt-0 pr-2">1.</span>
                    <div class="flex-1">
                    <header class="mb-1">
                        <h4 class="inline text-blue-700">{{ detail.shortName }}</h4>
                    </header>
                    <header class="mb-1"><span class="font-semibold">{{ detail.title }}</span></header>
                    </div>
                </article>
            </div>
            <div class="scrollbar p-4 pl-0 pt-1 pb-32">
            <ul>
                <li v-for="(item, index) of collections" v-bind:key="index" @click="pickColl(item?._source?.shortName, item?._id)"
                    :class="[{'hidden': !String(item?._source?.shortName).toLocaleLowerCase().includes(String(searchCol).toLocaleLowerCase())}, item?._source?.shortName]"
                >
                    <article v-if="index > 0" tabindex="-1" class="cursor-pointer border rounded-md p-3 bg-white flex text-gray-700 mb-2 hover:border-primary focus:outline-none focus:border-primar">
                        <span class="flex-none pt-0 pr-2">{{ index + 1 }}.</span>
                        <div class="flex-1">
                        <header class="mb-1">
                            <h4 class="inline text-blue-700">{{ item?._source?.shortName }}</h4>
                        </header>
                        <header class="mb-1"><span class="font-semibold">{{ item?._source?.title }}</span></header>
                        </div>
                    </article>
                </li>
            </ul>
            </div>
        </section>
        <section class="flex min-h-0 flex-col flex-auto border bg-white" v-if="detail">
            <div class="mirror__form" v-if="tableConfig && !id">
                <vuejx-table-simple-khcn class="m-2" :keywords="['MaMuc', 'TenMuc', 'shortName', 'title', 'TenMuc.raw', 'title.raw', 'TenMuc.keyword', 'title.keyword']"
                    :crud="!crud" :remove="remove" :import_data="import_data" :export_data="export_data"
                    :pagesize="15" :db="detail.storeDb" :collection="detail.shortName" :sort="tableConfig.sort"
                    :title="detail.title"
                    :table_config="tableConfig.config_columns"
                    :state_query="['_collection', '_idCol']"
                >
                </vuejx-table-simple-khcn>
            </div>
            <div class="mirror__form m-2" v-if="tableConfig && id">
            <div class="top-content flex items-center bg-white rounded p-1 cursor-pointer"><div @click="backCol" class="text-green-700 uppercase font-bold"><i class="mdi mdi-backburger text-xs mr-1"></i> {{ detail.title }} </div></div>
                <vuejx-screen
                    ref="uploadFile"
                    grid_class="flex flex-wrap cms_form"
                    :site="$site"
                    :db="detail.storeDb"
                    :collection="detail.shortName"
                    :config="metadataConfig"
                    v-model="vuejxData"
                    :customRedirect="true"
                    @afterSubmit="afterSubmit"
                ></vuejx-screen>
            </div>
        </section>
        <section class="flex min-h-0 flex-col flex-auto border bg-white" v-else>
            <div class="font-bold text-center p-4 pt-64">
                Qu\u1EA3n l\xFD d\u1EEF li\u1EC7u danh m\u1EE5c
            </div> 
        </section>
    </div>
    `},VuejxScreen={props:{detailPage:{type:String,default:""},db:{type:String,default:()=>localStorage.getItem("db")},collection:{type:String,default:()=>""},action_guest:{type:Boolean,default:()=>!1},demoaction:{type:Array,default:()=>[{action:"L\u01B0u",dest:{TrangThai:{_source:{MaMuc:"01",TenMuc:"Hi\u1EC7u l\u1EF1c",type:"C_TrangThaiQuyTrinh"}}}},{action:"Tho\xE1t",class:"back__btn",url:"back"}]},grid_class:{type:String,default:()=>"grid grid-cols-3 gap-2"},backPage:{type:String,default:()=>""},codemirrors:{type:Array,default:()=>[]},site:{type:String,default:()=>localStorage.getItem("site")},config:{type:Object,default:()=>({})},data:{type:Object,default:()=>null},id:{type:String,default:"NULL"},customRedirect:{type:Boolean,default:()=>!1}},methods:{async checkNumber(e){return!!/^-?[0-9]+$/.test(e)},async flattenObject(e){const t=["_index","_score","_type","_doc","sort"],r=["_id","_source","sort"],a=(n,l)=>Object.keys(n).reduce((f,s)=>{const h=l&&l.length?l+".":"",p=t.indexOf(s)>=0&&h||s.indexOf(".")>=0;if(isNaN(s))if(!p&&typeof n[s]=="object"&&!Array.isArray(n[s])&&n[s]!==null&&Object.keys(n[s]).length>0){let d={};r.indexOf(s)<0&&(d={[h+s]:(N=>{var S=N,{_index:y,_score:g,_type:k,_doc:A}=S,M=Ve(S,["_index","_score","_type","_doc"]);return M})(n[s])}),Object.assign(f,d,a(n[s],h+s))}else p||(f[h+s]=n[s]);return f},{});return a(e)},objectView(e,t,r){return window.Vue.objectView(e,t,r)},dateView(e,t,r,a){return window.Vue.dateView(e,t,r,a)},async pingDone(e){this.$emit("pingDone",this.dataForm)},async changeData(){this.$emit("changeData",this.dataForm)},async submitData(e,t){let r=this;r.afterSubmit=!0,setTimeout(async()=>{if(window.document.getElementsByClassName("error___form").length>0)window.Vue.toastr.error("Ki\u1EC3m tra c\xE1c tr\u01B0\u1EDDng th\xF4ng tin b\u1EAFt bu\u1ED9c.");else if(r.detailActin={},r.ext_form_popup=!1,e.ext_field&&!t)r.ext_form_popup=!0,r.detailActin=e;else{if(e.url){e.url=="back"?r.backURL():window.location.href=e.url;return}else if(e.del){if(confirm("B\u1EA1n mu\u1ED1n xo\xE1 b\u1EA3n ghi n\xE0y?")!=!0)return;r.dataForm.storage="trash"}e.dest&&(r.dataForm=he(he({},r.dataForm),await r.flattenObject(e.dest))),r.extData&&(r.dataForm=he(he({},r.dataForm),r.extData)),r.dataForm.PostDB=r.db,r.dataForm.PostCollection=r.collection,window.Vue.router.currentRoute.value.query.referenceUid&&(r.dataForm.referenceUid=window.Vue.router.currentRoute.value.query.referenceUid),await r.submitDataAction(r.dataForm,r.customRedirect),r.$emit("submitData",r.dataForm)}},100)},async submitDataAction(e,t){let r=this,a=e;a.site||(a.site=r.site);let n="vuejx_manager/userCreate";a._id&&(n="vuejx_manager/userUpdateById");let l=a.PostDB,f=a.PostCollection,s=a.actionCode;delete a.actionCode,delete a.PostCollection,delete a.PostDB,l!=null&&l!==""&&await window.Vue.$root.dispatch(n,{db:localStorage.getItem("db"),collection:f,body:a,actionCode:s}).then(h=>{h.data!==void 0&&h.data.insertedId!==void 0?(e._id=h.data.insertedId,t?r.$emit("afterSubmit",{insertedId:h.data.insertedId}):window.Vue.redirect([{key:"_id",value:h.data.insertedId},{key:"t",value:new Date().getTime()}],!0)):t?r.$emit("afterSubmit",{modifiedCount:1}):window.Vue.redirect([{key:"t",value:new Date().getTime()}],!0),f==="vuejx_page"&&window.Vue.$axios.post("/vuejx/reindex",{token:localStorage.getItem("token"),db:localStorage.getItem("db"),collection:"vuejx_page"}).catch(p=>{}),window.Vue.toastr.success("Th\xE0nh c\xF4ng.")}).catch(h=>{window.Vue.toastr.error("Error.")})},numberProcess(e,t){isNaN(this.dataForm[t])&&(this.dataForm[t]=0),e==="-"?this.dataForm[t]=this.dataForm[t]-1:this.dataForm[t]=this.dataForm[t]+1},async init(){let e=this,t={};if(e.data)return e.data;{window.Vue.router.currentRoute.value.query._id&&window.Vue.router.currentRoute.value.query._id!=="NULL"?(window.Vue.router.currentRoute.value.query.menu,await window.Vue.$root.dispatch("vuejx_manager/userById",{db:localStorage.getItem("db"),collection:e.collection,id:window.Vue.router.currentRoute.value.query._id,keys:e.keys}).then(a=>{a&&(t=a)}).catch(()=>{e.dataForm={}})):window.Vue.router.currentRoute.value.query.referenceUid&&window.Vue.router.currentRoute.value.query.referenceUid!=="NULL"&&await window.Vue.$root.dispatch("vuejx_manager/userOne",{db:localStorage.getItem("db"),collection:e.collection,keys:null,filter:{referenceUid:window.Vue.router.currentRoute.value.query.referenceUid},skip:0}).then(a=>{a&&(t=a)}).catch(()=>{e.dataForm={}});let r=window.dotize.dotize.convert(t);for(let a in r)(r[a]===void 0||r[a]===null)&&delete r[a];return he(he({},t),r)}},async dataChange(e){this.$emit("dataChange",{data:this.dataForm,key:e})},backURL(){window.Vue.router.go(-1)},async processArrayDelete(e,t){confirm("B\u1EA1n mu\u1ED1n xo\xE1 b\u1EA3n ghi n\xE0y?")&&this.dataForm[t].splice(e,1)},async processArray(e,t){let r=window.dotize.dotize.backward(e);for(let a in r)String(a).indexOf(".")!=-1&&delete r[a];r=he(he({},r),e),Array.isArray(this.dataForm[t])?this.dataForm[t].push(r):this.dataForm[t]=[r],this.dataForm[t+"___data"]={}},async changeBoolean(e){this.dataForm[e]=!this.dataForm[e]},editArray(e,t){this.dataForm[t+"___data"]=e},removeArray(e,t){confirm("B\u1EA1n c\xF3 mu\u1ED1n xo\xE1 b\u1EA3n ghi n\xE0y.")&&this.dataForm[t].splice(e,1)},changeRole(){let e=[];if(Array.isArray(this.vuejxData.viewRole))for(const t of this.vuejxData.viewRole)e.push({shortName:t._source.MaMuc,title:t._source.TenMuc,permission:1});if(Array.isArray(this.vuejxData.ignoreRole))for(const t of this.vuejxData.ignoreRole)e.push({shortName:t._source.MaMuc,title:t._source.TenMuc,permission:5});this.dataForm.accessRoles=e}},watch:{dataForm:async function(e){this.$emit("update:dataForm",e)}},mounted:function(){let e=this;e.renderRole=!1,e.$nextTick(async function(){localStorage.getItem("user")&&(e.user=JSON.parse(localStorage.getItem("user")),e.user.token=localStorage.getItem("token"),e.role=e.user.role),e.formJSON=[],e.loadingForm=!0;let t=e.config;if(t==null&&(t={type:0,form:[{model:"MaMuc",type:"text",class:"xs12 sm4",label:"M\xE3 m\u1EE5c"},{model:"TenMuc",type:"text",class:"xs12 sm8",label:"T\xEAn m\u1EE5c"},{type:"done"}]}),e.extForm=t.ext_form,e.typeForm=t.type,e.formJSON=Array.isArray(t.form)?t.form:[],e.dataForm=await e.init(),e.itemRole={},e.formJSON.reduce(function(r,a){if(a.type==="text"||a.type==="role")if(a.type==="role"){let n="{}";(a.model==="accessRoles"||a.model==="accessUsers"||a.model==="accessEmails")&&(e.itemRole[a.model]=a,n=[],Array.isArray(e.dataForm[a.model])||(e.dataForm[a.model]=[])),e.dataForm[a.model]=e.dataForm[a.model]!==void 0&&e.dataForm[a.model]!==null?e.dataForm[a.model]:n}else e.dataForm[a.model]=e.dataForm[a.model]!==void 0&&e.dataForm[a.model]!==null?e.dataForm[a.model]:"";else a.type==="number"?e.dataForm[a.model]=e.dataForm[a.model]!==void 0&&e.dataForm[a.model]!==null?e.dataForm[a.model]:0:a.type==="autocomplete"?a.object?a.multiple?e.dataForm[a.model]=e.dataForm[a.model]!==void 0&&e.dataForm[a.model]!==null?e.dataForm[a.model]:[]:e.dataForm[a.model]=e.dataForm[a.model]!==void 0&&e.dataForm[a.model]!==null?e.dataForm[a.model]:{}:e.dataForm[a.model]=e.dataForm[a.model]!==void 0&&e.dataForm[a.model]!==null?e.dataForm[a.model]:"":a.type==="region"&&(e.dbCol=a.db,e.dataForm[a.model+"."+a.model_tinhthanh+"._source.MaMuc"]&&(codeTT=e.dataForm[a.model+"."+a.model_tinhthanh+"._source.MaMuc"]),e.dataForm[a.model+"."+a.model_quanhuyen+"._source.MaMuc"]&&(codeQH=e.dataForm[a.model+"."+a.model_quanhuyen+"._source.MaMuc"]));return r},{}),e.vuejxData={viewRole:[],ignoreRole:[]},Array.isArray(e.dataForm.accessRoles)){const r=e.dataForm.accessRoles.reduce((a,n)=>a.find(f=>f.shortName===n.shortName)?a:a.concat([n]),[]);for(const a of r)a&&a.permission==1?e.vuejxData.viewRole.push({_source:{MaMuc:a.shortName,TenMuc:a.title?a.title:a.shortName}}):a&&a.permission==5&&e.vuejxData.ignoreRole.push({_source:{MaMuc:a.shortName,TenMuc:a.title?a.title:a.shortName}})}e.loadingForm=!1,e.$emit("update:dataForm",e.dataForm),e.$emit("update:itemRole",e.itemRole),setTimeout(()=>{e.renderRole=!0},100)})},data:()=>({detailActin:{},ext_form_popup:!1,user:{},role:[],renderRole:!1,afterSubmit:!1,typeForm:0,formJSON:[],dataForm:{},loadingForm:!0,itemRole:{},extForm:{},region:{TinhThanh:[],QuanHuyen:[],XaPhuong:[]},renderTT:!1,renderQH:!1,renderPX:!1,dbCol:"",vuejxData:{},extData:null}),template:`
  <div>
      <div v-if="loadingForm"> </div>
      <div v-else :class="grid_class">
      <slot name="top" v-bind:dataForm="dataForm"></slot>
      <template v-for="(item, index) in formJSON" v-bind:key="index">
          <div :class="item['class']"
            v-if="
            item['type'] === 'label' ||
            item['type'] === 'view' ||
            item['type'] === 'text' ||
            item['type'] === 'textarea' ||
            item['type'] === 'number' ||
            item['type'] === 'autocomplete' ||
            item['type'] === 'region' ||
            item['type'] === 'account' ||
            item['type'] === 'date' ||
            item['type'] === 'file' ||
            item['type'] === 'teleport' ||
            item['type'] === 'done' ||
            item['type'] === 'array' ||
            item['type'] === 'avatar' ||
            item['type'] === 'role' ||
            item['type'] === 'logs' ||
            item['type'] === 'boolean'"
          >
          <div v-if="item['type'] === 'array' && Array.isArray(item.form)">
              <vuejx-screen ref="formInputArray" :grid_class="item.grid_class" :config="item" :data="dataForm[item.model+'___data']" :key="dataForm[item.model+'___data']">
                  <template v-slot:action="{ modelx, dataFormX }" >
                    <div class="my-2 text-right">
                      <button @click="processArray(dataFormX, item.model)"
                        class="leading-none font-semibold bg-blue-700 text-white mx-2 rounded px-4 py-2 focus:outline-none" tabindex="-1">
                        Th\xEAm m\u1EDBi
                      </button>
                    </div>
                  </template>
              </vuejx-screen>
              <table v-if="Array.isArray(dataForm[item.model]) && item['view_form'] != 'simple'" class="w-full bg-white border table___screen___info" style="border-right: 0; border-top: 0;">
                <thead class="w-full">
                  <tr>
                    <th width="50">STT</th>
                    <th :class="itemTH.col_css ? itemTH.col_css : 'text-left'" v-for="(itemTH, index) in item.form">
                      {{itemTH.label}}
                    </th>
                    <th class="text-center" width="80">#</th>
                  </tr>
                </thead>
                <tbody class="border-b w-full bg-white">
                  <tr v-for="(itemDataArray, indexAr) in dataForm[item.model]" :key="dataForm[item.model]">
                    <td width="50" align="center">{{ indexAr + 1 }}</td>
                    <td :class="itemTH.col_css ? itemTH.col_css : 'text-left'" v-for="(itemTH, index) in item.form">
                      <template v-if="itemTH.type == 'date'">
                        {{ dateView(itemDataArray, itemTH.model) }}
                      </template>
                      <template v-else-if="itemTH.type == 'autocomplete'">
                        {{ objectView(itemDataArray[itemTH.model], itemTH.itemText) }}
                      </template>
                      <template v-else-if="itemTH.type == 'file'">
                        <a v-if="Array.isArray(itemDataArray[itemTH.model]) && itemDataArray[itemTH.model].length > 0"
                          :href="'/security/file/' + itemDataArray[itemTH.model][0]['bucketName'] + '/' + itemDataArray[itemTH.model][0]['filename']" target="_blank">
                            <i class="mdi mdi-download"></i>
                        </a>
                      </template>
                      <template v-else>
                        {{ itemDataArray[itemTH.model] }}
                      </template>
                    </td>
                    <td width="80" align="center">
                      <i @click="editArray(itemDataArray, item.model)" class="mdi mdi-save cursor-pointer mx-1"></i>
                      <i @click="removeArray(indexAr, item.model)" class="mdi mdi-delete text-red-700 cursor-pointer mx-1"></i>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div v-else v-for="(itemDataArray, indexAr) in dataForm[item.model]" :key="dataForm[item.model]">
                <div class="block font-semibold leading-tight pb-1 truncate text-lg text-blue-700">
                  {{ indexAr + 1 }}. {{ item.label }}
                </div>
                <vuejx-screen ref="formInputArray" :grid_class="item.grid_class" :config="item" :data="itemDataArray" :key="itemDataArray">
                    <template v-slot:action="{ modelx, dataFormX }" >
                      <div class="my-2 text-right">
                        <button @click="processArrayDelete(indexAr, item.model)"
                          class="leading-none font-semibold text-red-700 mx-2 rounded px-4 py-2 focus:outline-none border border-red-700 hover:bg-red-100" tabindex="-1">
                          Xo\xE1 d\u1EEF li\u1EC7u
                        </button>
                      </div>
                    </template>
                </vuejx-screen>
              </div>
          </div>
          <div v-if="item['type'] === 'role'">
            <div class="col-span-4 text-green-700 uppercase font-bold mt-4">
              <div class="vuejx_comp___undefined">
                <div class="block font-semibold leading-tight pb-1 truncate">{{ item.label }}</div>
              </div>
            </div>
            <vuejx-autocomplete :config="{
              modelView: 'object', itemText: '_source.TenMuc', itemValue: '_source.MaMuc',
              model: 'viewRole', multiple: true,
              label: 'Quy\u1EC1n \u0111\u1ECDc d\u1EEF li\u1EC7u', object: true,
              link: [{ collection: 'C_ROLE' }],
              column: ['MaMuc', 'TenMuc', 'type'],
            }" :data="vuejxData" v-model="vuejxData['viewRole']"
              @change="changeRole"
            ></vuejx-autocomplete>
            <vuejx-autocomplete :config="{
              modelView: 'object', itemText: '_source.TenMuc', itemValue: '_source.MaMuc',
              model: 'ignoreRole', multiple: true,
              label: 'Quy\u1EC1n kh\xF4ng nh\xECn d\u1EEF li\u1EC7u', object: true,
              link: [{ collection: 'C_ROLE' }],
              column: ['MaMuc', 'TenMuc', 'type'],
            }" :data="vuejxData" v-model="vuejxData['ignoreRole']"
              @change="changeRole"
            ></vuejx-autocomplete>
          </div>
          <div v-if="item['type'] === 'logs'">
            <vuejx-table-simple-khcn class="table___logs"
                :pagesize="15" :db="db" :collection="item['collection']" :sort="item['sort'] ? item['sort'] : [{createdAt:'desc'}]"
                :title="item['label']" :noHeader="true"
                :table_config="[
                  { value: '_source.createdAt', title: 'Ng\xE0y t\u1EA1o', width: '120', class: 'text-center', date: true },
                  { value: '_source.lastusername', title: 'Ng\u01B0\u1EDDi c\u1EADp nh\u1EADt d\u1EEF li\u1EC7u', width: '300', class: 'text-left' },
                  { value: '_source.updatedFields', title: 'D\u1EEF li\u1EC7u thay \u0111\u1ED5i', class: 'text-left' },
                  { value: '_source.removedFields', title: 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1ECB xo\xE1', width: '200', class: 'text-left' }
                ]"
            >
              <template v-slot:cell_2="{ celldata }" >
                {{ celldata?._source?.updatedFields }}
              </template>
              <template v-slot:cell_3="{ celldata }" >
                {{ celldata?._source?.removedFields }}
              </template>
            </vuejx-table-simple-khcn>
          </div>
          <div v-if="item['type'] === 'done' || (index + 1) >= formJSON.length">
              <vuejx-done @pingDone="pingDone"></vuejx-done>
          </div>
          <div v-if="item['type'] === 'teleport'" :class="'vuejx_comp___' + item['model']" :id="item['model']">
              <!--<vuejx-input-i18n :config="item" :data="dataForm" v-model="dataForm[item.model]"></vuejx-input-i18n>-->
          </div>
          <div v-if="item['type'] === 'String_i18n'" :class="'vuejx_comp___' + item['model']">
              <!--<vuejx-input-i18n :config="item" :data="dataForm" v-model="dataForm[item.model]"></vuejx-input-i18n>-->
          </div>
          <div v-if="item['type'] === 'hidden'" :class="'vuejx_comp___' + item['model']">
          </div>
          <div v-if="item['type'] === 'label'" :class="'vuejx_comp___' + item['model']">
              <div class="block font-semibold leading-tight pb-1 truncate" :class="item['class__label']">
              {{ item['label'] }}
              </div>
          </div>
          <div v-if="item['type'] === 'view'" :class="'vuejx_comp___' + item['model']">
              <div class="block font-semibold leading-tight pb-1 truncate">
              {{ item.hasOwnProperty('label') ? item['label'] : item['model'] }}
              <span
                  class="required__class"
                  v-if="item['required']"
              >*</span>
              </div>
              <div
              class="block leading-normal truncate"
              >{{ objectView(dataForm, item.model) }}</div>
          </div>
          <div v-if="item['type'] === 'boolean'" :class="'vuejx_comp___' + item['model']">
              <div class="block font-semibold leading-tight pb-1 truncate">
              {{ item.hasOwnProperty('label') ? item['label'] : item['model'] }}
              <span
                  class="required__class"
                  v-if="item['required']"
              >*</span>
              </div>
              <div class="flex items-center" @click="changeBoolean(item.model)">
                <span class="mr-2 font-bold" :class="dataForm[item.model] ? 'text-gray-500' : 'text-blue-700'">{{ item['label_false'] }}</span>
                <div class="relative inline-block w-12 align-middle select-none transition duration-200 ease-in cursor-pointer">
                  <input :checked="String(dataForm[item.model]) == 'true'"
                    type="checkbox" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none focus:outline-none pointer-events-none" style="margin:0px; appearance: none;" />
                  <label class="block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                </div>
                <span class="ml-2 font-bold" :class="dataForm[item.model] ? 'text-blue-700' : 'text-gray-500'">{{ item['label_true'] }}</span>
              </div>
              <div v-if="afterSubmit && item['required'] && !dataForm[item.model]" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
          </div>
          <div v-if="item['type'] === 'region'" :class="'vuejx_comp___' + item['model']">
            <template v-if="item.label_diachi">
              <div class="block font-semibold leading-tight pb-1 truncate">
                {{ item.label_diachi }}
              </div>
              <input
                v-model="dataForm[item.model + '.SoNhaChiTiet']"
                class="p-2 focus:outline-none focus:cursor-text w-full border border-gray-200 focus:bg-white focus:border-gray-400 rounded"
                :class="{'bg-gray-500 text-white pointer-events-none': item.disable, 'bg-gray-200 text-gray-700': !item.disable}"
                type="text"
                :placeholder="item['placeholder_diachi']"
                @input="changeData"
              />
            </template>
            <template v-if="item.label_tinh">
              <div class="flex flex-wrap -mx-2">
                <div class="xs12 sm4 px-2">
                  <vuejx-autocomplete  :config="{
                    placeholder: item['placeholder_tinh'],
                    modelView: 'object', label_class: item['css_tinh'], multiple: false,
                    model: item['model'] + '.TinhThanh', chips: false, required: false,
                    label: item['label_tinh'], object: true, itemText: item['itemText'] ? item['itemText'] : '_source.TenMuc', itemValue: item['itemValue'] ? item['itemValue'] : '_source.MaMuc',
                    link: [ { db: db, collection: 'C_TinhThanh', condition: [] } ],
                    column: ['MaMuc', 'TenMuc', 'type'], sort: item['sort'] ? item['sort'] : [ '_score' ]
                  }" v-model:data="dataForm" v-model="dataForm[item.model + '.TinhThanh']" :site="site"
                  @change_data="changeData"
                  ></vuejx-autocomplete>
                </div>
                <div class="xs12 sm4 px-2" :key="dataForm[item.model + '.TinhThanh']">
                  <vuejx-autocomplete :config="{
                    placeholder: item['placeholder_huyen'],
                    modelView: 'object', label_class: item['css_huyen'], multiple: false,
                    model: item['model'] + '.QuanHuyen', chips: false, required: false,
                    label: item['label_huyen'], object: true, itemText: item['itemText'] ? item['itemText'] : '_source.TenMuc', itemValue: item['itemValue'] ? item['itemValue'] : '_source.MaMuc',
                    link: [ 
                      { 
                        db: db, 
                        collection: 'C_QuanHuyen', 
                        condition: [
                          {
                            bool: {
                              should: [
                                { 
                                  match: {
                                    'TinhThanh._source.MaMuc': objectView(dataForm[item.model + '.TinhThanh'], '_source.MaMuc')
                                  }
                                },
                                { 
                                  match: {
                                    'MaMuc': objectView(dataForm[item.model + '.QuanHuyen'], '_source.MaMuc')
                                  }
                                }
                              ]
                            }
                          }
                        ] 
                      } 
                    ],
                    column: ['MaMuc', 'TenMuc', 'type'], sort: item['sort'] ? item['sort'] : [ '_score' ]
                  }" v-model:data="dataForm" v-model="dataForm[item.model + '.QuanHuyen']" :site="site"
                  @change_data="changeData"
                  ></vuejx-autocomplete>
                </div>
                <div class="xs12 sm4 px-2">
                  <vuejx-autocomplete :key="dataForm[item.model + '.QuanHuyen']" :config="{
                    placeholder: item['placeholder_xa'],
                    modelView: 'object', label_class: item['css_xa'], multiple: false,
                    model: item['model'] + '.PhuongXa', chips: false, required: false,
                    label: item['label_xa'], object: true, itemText: item['itemText'] ? item['itemText'] : '_source.TenMuc', itemValue: item['itemValue'] ? item['itemValue'] : '_source.MaMuc',
                    link: [ 
                      { 
                        db: db, 
                        collection: 'C_PhuongXa', 
                        condition: [
                          {
                            bool: {
                              should: [
                                {
                                  match: {
                                    'QuanHuyen._source.MaMuc': objectView(dataForm[item.model + '.QuanHuyen'], '_source.MaMuc')
                                  }
                                },
                                { 
                                  match: {
                                    'MaMuc': objectView(dataForm[item.model + '.PhuongXa'], '_source.MaMuc')
                                  }
                                }
                              ]
                            }
                          }
                        ]
                      } 
                    ],
                    column: ['MaMuc', 'TenMuc', 'type'], sort: item['sort'] ? item['sort'] : [ '_score' ]
                  }" v-model:data="dataForm" v-model="dataForm[item.model + '.PhuongXa']" :site="site"
                  @change_data="changeData"
                  ></vuejx-autocomplete>
                </div>
              </div>
            </template>
          </div>
          <div v-if="item['type'] === 'text'" :class="'vuejx_comp___' + item['model']">
              <div class="block font-semibold leading-tight pb-1 truncate">
              {{ item.hasOwnProperty('label') ? item['label'] : item['model'] }}
              <span
                  class="required__class"
                  v-if="item['required']"
              >*</span>
              </div>
              <input
              v-model="dataForm[item.model]"
              class="p-2 focus:outline-none focus:cursor-text w-full border border-gray-200 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
              :class="{'bg-gray-500 text-white pointer-events-none': item.disable, 'bg-gray-200 text-gray-700': !item.disable}"
              type="text"
              :placeholder="item['placeholder']"
              @input="changeData"
              :disabled="item.disable"
              />
              <div v-if="afterSubmit && item['required'] && !dataForm[item.model]" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
          </div>
          <div v-if="item['type'] === 'textarea'" :class="'vuejx_comp___' + item['model']">
              <div class="block font-semibold leading-tight pb-1 truncate">
              {{ item.hasOwnProperty('label') ? item['label'] : item['model'] }}
              <span
                  class="required__class"
                  v-if="item['required']"
              >*</span>
              </div>
              <textarea
              v-model="dataForm[item.model]"
              class="resize-none p-2 focus:outline-none focus:cursor-text w-full border border-gray-200 bg-gray-200 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
              :class="item['classCss']"
              :placeholder="item['placeholder']"
              @change="dataChange(item['model'])"
              />
              <div v-if="afterSubmit && item['required'] && !dataForm[item.model]" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
          </div>
          <div v-if="item['type'] === 'number'" :class="'vuejx_comp___' + item['model']">
              <div class="block font-semibold leading-tight pb-1 truncate">
              {{ item.hasOwnProperty('label') ? item['label'] : item['model'] }}
              <span
                  class="required__class"
                  v-if="item['required']"
              >*</span>
              </div>
              <input
              v-model="dataForm[item.model]"
              class="p-2 focus:outline-none focus:cursor-text w-full border border-gray-200 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
              :class="{'bg-gray-500 text-white pointer-events-none': item.disable, 'bg-gray-200 text-gray-700': !item.disable}"
              type="text"
              :placeholder="item['placeholder']"
              @input="changeData"
              :disabled="item.disable"
              />
              <div v-if="afterSubmit && item['required'] && !checkNumber(dataForm[item.model])" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
          </div>
          <div v-if="item['type'] === 'autocomplete'" :class="'vuejx_comp___' + item['model']">
              <vuejx-autocomplete v-if="!item['dynamicAPI']" :khac="item['khac']" :config="{
                data: item['items'],
                placeholder: item['placeholder'],
                modelView: 'object', label_class: item['label_class'], multiple: item['multiple'],
                model: item['model'], chips: false, required: false,
                label: item['label'], object: true, itemText: item['itemText'] ? item['itemText'] : '_source.TenMuc', itemValue: item['itemValue'] ? item['itemValue'] : '_source.MaMuc',
                link: [ { db: item['db'] ? item['db'] : db, collection: item['collection'], condition: item['condition'] ? item['condition'] : [] } ],
                column: item['column'] ? item['column'] : ['MaMuc', 'TenMuc', 'type'], sort: item['sort'] ? item['sort'] : [ '_score' ]
                }" v-model:data="dataForm" v-model="dataForm[item.model]" :site="site"
                :defaultVal="item['defaultVal']"
                @change_data="changeData"
              ></vuejx-autocomplete>
              <vuejx-autocomplete v-else :dynamicAPI="true" :delay="800" :maxItem="20" :khac="item['khac']" :config="{
                placeholder: item['placeholder'],
                label: item['label'],
                model: item['model'],
                object: true, itemText: item['itemText'] ? item['itemText'] : '_source.TenMuc', itemValue: item['itemValue'] ? item['itemValue'] : '_source.MaMuc',
                link: [{ db: item['db'] ? item['db'] : db, collection: item['collection'], dynamicText: item['dynamicText']}],
                column: item['column'] ? item['column'] : ['MaMuc', 'TenMuc', 'type'],
                sort: item['sort'] ? item['sort'] : [ '_score' ]
                }" v-model:data="dataForm" v-model="dataForm[item.model]" :site="site"
                @change_data="changeData">
              </vuejx-autocomplete>
              <div v-if="afterSubmit && item['required'] && !dataForm[item.model]" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
          </div>
          <div v-if="item['type'] === 'date'" :class="'vuejx_comp___' + item['model']">
              <vuejx-date-combobox v-model="dataForm[item.model]" :data-value="dataForm[item.model]" :data="dataForm" :config="item"
              @changeDate="changeData"
              >
              </vuejx-date-combobox>
              <div v-if="afterSubmit && item['required'] && !dataForm[item.model]" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
          </div>
          <div v-if="item['type'] === 'file'" :class="'vuejx_comp___' + item['model']">
              <div class="block font-semibold leading-tight pb-1 truncate text-left" v-if="item['label']">
              {{ item['label'] }}
              <span
                  class="required__class"
                  v-if="item['required']"
              >*</span>
              </div>
              <vuejx-upload-2 :id="item['model']" :class="item['upload_class']"
              :uploadUrl="item['uploadUrl']" :multiple="!item['multiple'] ? true : false" 
              :maxFiles="item['maxFiles']" 
              :accept="item['accept'] ? item['accept'] : '.jpeg, .jpg, .png, .pdf, .doc, .docx'" 
              :helpText="item['helpText'] ? item['helpText'] : '\u0110\xEDnh k\xE8m'" 
              v-model:data="dataForm" 
              :config="{
                  model: item['model']
              }
              ">
              </vuejx-upload-2>
              <div v-if="afterSubmit && item['required'] && !dataForm[item.model]" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
          </div>
        </div>
      </template>
      <slot name="bottom" v-bind:dataFormX="dataForm"></slot>
      </div>

      <slot name="action" v-bind:submitData="submitData" v-bind:dataFormX="dataForm">
          <div class="btn-group flex mt-8 action___buttons" v-if="renderRole && !action_guest">
              <template v-for="(item, index) of demoaction">
              <button aria-label="btn" v-if="role.some(r=> (item.access && item.access.indexOf(r) >= 0 || !item.access)) && (!item.input || (item.input && item.input.value.indexOf(objectView(dataForm, item.input.key, 'null')) != -1 ))" v-bind:key="index"
                  :class="[{'leading-none font-semibold bg-blue-700 text-white mx-2 rounded px-4 py-2': !item.class && item.url !== 'back', 'leading-none font-semibold border border-blue-700 text-blue-700 mx-2 rounded px-4 py-2': item.url == 'back'}, item.class]"
                  class="focus:outline-none" tabindex="-1" @click="submitData(item)">
                  {{ item.action }}
              </button>
              </template>
          </div>
          <div class="btn-group flex mt-8 action___buttons" v-else>
              <template v-for="(item, index) of demoaction">
                <button aria-label="btn" v-bind:key="index"
                  v-if="item && item.access && item.access.indexOf('GUEST') != -1"
                  :class="[{'leading-none font-semibold bg-blue-700 text-white mx-2 rounded px-4 py-2': !item.class && item.url !== 'back', 'leading-none font-semibold border border-blue-700 text-blue-700 mx-2 rounded px-4 py-2': item.url == 'back'}, item.class]"
                  class="focus:outline-none" tabindex="-1" @click="submitData(item)">
                  {{ item.action }}
                </button>
              </template>
              
          </div>

      </slot>

      <div v-if="ext_form_popup" class="fixed rounded shadow-lg bg-white border border-blue-700 z-50 overflow-hidden" style="padding: initial; top: 50%; left:50%; min-width: 500px;max-width: 90vw;z-index: 9999;border-radius: 20px; transform: translate(-50%, -50%);">
      <div class="flex justify-between items-center bg-gray-300">
          <p class="text-lg font-bold text-white py-2 px-6 bg-blue-500 uppercase" style="border-radius: 20px 0;"> {{ detailActin.ext_field.title }}</p>
          <div class="cursor-pointer z-50 px-6" @click="ext_form_popup = false">
          <i class="mdi mdi-close"></i>
          </div>
      </div>
      <div class="overflow-y-auto" style="max-height: 70vh;">
          <v-layout class="px-4 py-2">
          <div :class="detailActin.ext_field.class" v-if="Array.isArray(detailActin.ext_field.value)">
              <template v-for="(item, index) in detailActin.ext_field.value" v-bind:key="index">
              <div :class="item['class']"
                  v-if="
                  item['type'] === 'label' ||
                  item['type'] === 'view' ||
                  item['type'] === 'text' ||
                  item['type'] === 'textarea' ||
                  item['type'] === 'number' ||
                  item['type'] === 'autocomplete' ||
                  item['type'] === 'region' ||
                  item['type'] === 'account' ||
                  item['type'] === 'date' ||
                  item['type'] === 'file' ||
                  item['type'] === 'teleport' ||
                  item['type'] === 'done' ||
                  item['type'] === 'avatar'"
              >
                  <div v-if="item['type'] === 'done' || (index + 1) >= detailActin.ext_field.value.length">
                  <vuejx-done @pingDone="pingDone"></vuejx-done>
                  </div>
                  <div :class="'vuejx_comp___' + item['model']" v-if="item['type'] === 'teleport'" :id="item['model']">
                  <!--<vuejx-input-i18n :config="item" :data="dataForm" v-model="dataForm[item.model]"></vuejx-input-i18n>-->
                  </div>
                  <div :class="'vuejx_comp___' + item['model']" v-if="item['type'] === 'String_i18n'">
                  <!--<vuejx-input-i18n :config="item" :data="dataForm" v-model="dataForm[item.model]"></vuejx-input-i18n>-->
                  </div>
                  <div :class="'vuejx_comp___' + item['model']" v-if="item['type'] === 'hidden'">
                  </div>
                  <div :class="'vuejx_comp___' + item['model']" v-if="item['type'] === 'label'">
                  <div class="block font-semibold leading-tight pb-1 truncate" :class="item['class__label']">
                      {{ item['label'] }}
                  </div>
                  </div>
                  <div :class="'vuejx_comp___' + item['model']" v-if="item['type'] === 'view'">
                  <div class="block font-semibold leading-tight pb-1 truncate">
                      {{ item.hasOwnProperty('label') ? item['label'] : item['model'] }}
                      <span
                      class="required__class"
                      v-if="item['required']"
                      >*</span>
                  </div>
                  <div
                      class="block leading-normal truncate"
                  >{{ dataForm[item.model] === undefined ? new Date().toLocaleString() : new Date(parseInt(dataForm[item.model])).toLocaleString('vi-VN') }}</div>
                  </div>
                  <div :class="'vuejx_comp___' + item['model']" v-if="item['type'] === 'text'">
                  <div class="block font-semibold leading-tight pb-1 truncate">
                      {{ item.hasOwnProperty('label') ? item['label'] : item['model'] }}
                      <span
                      class="required__class"
                      v-if="item['required']"
                      >*</span>
                  </div>
                  <input
                      v-model="dataForm[item.model]"
                      class="p-2 focus:outline-none focus:cursor-text w-full border border-gray-200 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
                      :class="{'bg-gray-500 text-white pointer-events-none': item.disable, 'bg-gray-200 text-gray-700': !item.disable}"
                      type="text"
                      :placeholder="item['placeholder']"
                      @input="changeData"
                      :disabled="item.disable"
                  />
                  <div v-if="afterSubmit && item['required'] && !dataForm[item.model]" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
                  </div>
                  <div :class="'vuejx_comp___' + item['model']" v-if="item['type'] === 'textarea'">
                  <div class="block font-semibold leading-tight pb-1 truncate">
                      {{ item.hasOwnProperty('label') ? item['label'] : item['model'] }}
                      <span
                      class="required__class"
                      v-if="item['required']"
                      >*</span>
                  </div>
                  <textarea
                      v-model="dataForm[item.model]"
                      class="resize-none p-2 focus:outline-none focus:cursor-text w-full border border-gray-200 bg-gray-200 text-gray-700 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
                      :class="item['classCss']"
                      :placeholder="item['placeholder']"
                      @change="dataChange(item['model'])"
                  />
                  <div v-if="afterSubmit && item['required'] && !dataForm[item.model]" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
                  </div>
                  <div :class="'vuejx_comp___' + item['model']" v-if="item['type'] === 'number'">
                  <div class="block font-semibold leading-tight pb-1 truncate">
                      {{ item.hasOwnProperty('label') ? item['label'] : item['model'] }}
                      <span
                      class="required__class"
                      v-if="item['required']"
                      >*</span>
                  </div>
                  <input
                      v-model="dataForm[item.model]"
                      class="p-2 focus:outline-none focus:cursor-text w-full border border-gray-200 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
                      :class="{'bg-gray-500 text-white pointer-events-none': item.disable, 'bg-gray-200 text-gray-700': !item.disable}"
                      type="text"
                      :placeholder="item['placeholder']"
                      @input="changeData"
                      :disabled="item.disable"
                  />
                  <div v-if="afterSubmit && item['required'] && !checkNumber(dataForm[item.model])" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
                  </div>
                  <div :class="'vuejx_comp___' + item['model']" v-if="item['type'] === 'autocomplete'">
                    <vuejx-autocomplete v-if="!item['dynamicAPI']" :config="{
                        data: item['items'],
                        placeholder: item['placeholder'],
                        modelView: 'object', label_class: item['label_class'], multiple: item['multiple'],
                        model: item['model'], chips: false, required: false,
                        label: item['label'], object: true, itemText: item['itemText'] ? item['itemText'] : '_source.TenMuc', itemValue: item['itemValue'] ? item['itemValue'] : '_source.MaMuc',
                        link: [ { db: item['db'] ? item['db'] : db, collection: item['collection'], condition: item['condition'] ? item['condition'] : [] } ],
                        column: item['column'] ? item['column'] : ['MaMuc', 'TenMuc', 'type'], sort: item['sort'] ? item['sort'] : [ '_score' ]
                    }" v-model:data="dataForm" v-model="dataForm[item.model]" :site="site"
                    @change_data="changeData"
                    ></vuejx-autocomplete>
                    <vuejx-autocomplete v-else :dynamicAPI="true" :delay="800" :maxItem="20" :config="{
                        placeholder: item['placeholder'],
                        label: item['label'],
                        model: item['model'],
                        object: true, itemText: item['itemText'] ? item['itemText'] : '_source.TenMuc', itemValue: item['itemValue'] ? item['itemValue'] : '_source.MaMuc',
                        link: [{ db: item['db'] ? item['db'] : db, collection: item['collection'], dynamicText: item['dynamicText']}],
                        column: item['column'] ? item['column'] : ['MaMuc', 'TenMuc', 'type'],
                        sort: item['sort'] ? item['sort'] : [ '_score' ]
                        }" v-model:data="dataForm" v-model="dataForm[item.model]" :site="site"
                        @change_data="changeData">
                    </vuejx-autocomplete>
                    <div v-if="afterSubmit && item['required'] && !dataForm[item.model]" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
                    </div>
                  <div :class="'vuejx_comp___' + item['model']" v-if="item['type'] === 'date'">
                  <vuejx-date-combobox v-model="dataForm[item.model]" :data-value="dataForm[item.model]" :data="dataForm" :config="item"
                      @changeDate="changeData"
                  >
                  </vuejx-date-combobox>
                  <div v-if="afterSubmit && item['required'] && !dataForm[item.model]" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
                  </div>
                  <div :class="'vuejx_comp___' + item['model']" v-if="item['type'] === 'file'">
                  <div class="block font-semibold leading-tight pb-1 truncate text-left" v-if="item['label']">
                      {{ item['label'] }}
                      <span
                      class="required__class"
                      v-if="item['required']"
                      >*</span>
                  </div>
                  <vuejx-upload-2 :id="item['model']" :class="item['upload_class']"
                      :uploadUrl="item['uploadUrl']" :multiple="!item['multiple'] ? true : false" 
                      :maxFiles="item['maxFiles']" 
                      :accept="item['accept'] ? item['accept'] : '.jpeg, .jpg, .png, .pdf, .doc, .docx'" 
                      :helpText="item['helpText'] ? item['helpText'] : '\u0110\xEDnh k\xE8m'" 
                      v-model:data="dataForm" 
                      :config="{
                      model: item['model']
                      }
                  ">
                  </vuejx-upload-2>
                  <div v-if="afterSubmit && item['required'] && !dataForm[item.model]" class="text-red-600 mt-2 italic error___form"> {{ item.required_title ? item.required_title : 'Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u b\u1EAFt bu\u1ED9c' }}</div>
                  </div>
              </div>
              </template>
          </div>
          <v-flex xs12 class="px-2 my-2">
              <button aria-label="btn" @click="submitData(detailActin, true)" class="font-semibold bg-blue-7000 px-4 py-2 leading-none rounded focus:outline-none whitespace-no-wrap" tabindex="-1">
              X\xE1c nh\u1EADn
              </button>
          </v-flex>
          </v-layout>
      </div>
      </div>
      
  </div>
  `},VuejxDone={mounted:function(){let e=this;e.$nextTick(function(){e.$emit("pingDone","OK")})},template:"<span></span>"},MTQuanTrac={props:{ChiTieuQuanTrac:{type:String,default:()=>""},collection:{type:String,default:()=>""},db:{type:String,default:()=>localStorage.getItem("db")},condition:{type:Array,default:()=>[]}},mounted:function(){let e=this;e.$nextTick(function(){if(e.table_config=[{title:"\u0110\u1EE3t quan tr\u1EAFc",class:"text-center",value:"_source.DotQuanTrac"},{title:"N\u0103m quan tr\u1EAFc",class:"text-center",value:"_source.NamQuanTrac"}],e.renderTable=!1,e.renderF=!1,e.ChiTieuQuanTrac){let t=String(e.ChiTieuQuanTrac).split(",");for(const r of t)e.formConfig.form.push({model:"KetQuaQuanTrac."+String(r).trim(),label:String(r).trim(),type:"text"}),e.table_config.push({title:String(r).trim(),class:"text-center",value:"_source.KetQuaQuanTrac."+String(r).trim()})}e.renderF=!0,e.renderTable=!0})},methods:{afterSubmit(){let e=this;e.vuejxData={},e.renderTable=!1,setTimeout(()=>{e.renderTable=!0},400)}},data:()=>({formConfig:{type:0,form:[]},vuejxData:{},table_config:[],renderF:!1,renderTable:!1}),template:`<div v-if="renderF">
        <div class="flex border-b mb-4">
            <ol class="inline-flex items-center space-x-1 md:space-x-3 flex-1 breadcrumb breadcrumb_crud pl-0" style="padding-left: 0;"><li aria-current="page"><div class="flex items-center"><span class="text-sm font-medium text-gray-400 md:ml-2 dark:text-gray-500"><div class="top-content flex items-center bg-white rounded py-1"><div class="text-green-700 font-bold">C\u1EADp nh\u1EADt k\u1EBFt qu\u1EA3 quan tr\u1EAFc</div></div></span></div></li></ol>
        </div>
        <vuejx-screen v-if="formConfig && formConfig.form"
            grid_class="grid grid-cols-4 gap-2"
            :collection="collection"
            :config="formConfig"
            v-model="vuejxData"
            :customRedirect="true"
            @afterSubmit="afterSubmit"
        >
            <template v-slot:action="{ submitData, dataFormX}">
                <div class="grid grid-cols-4 gap-2 mt-4">
                    <div></div>
                    <div>
                        <div class="block font-semibold leading-tight pb-1 truncate">
                            \u0110\u1EE3t quan tr\u1EAFc
                        </div>
                        <input v-model="dataFormX['DotQuanTrac']"
                            class="bg-gray-200 text-gray-700 p-2 focus:cursor-text w-full border border-gray-200 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
                            type="text" :placeholder="'\u0110\u1EE3t quan tr\u1EAFc...'"
                        />
                    </div>
                    <div>
                        <div class="block font-semibold leading-tight pb-1 truncate">
                            N\u0103m quan tr\u1EAFc
                        </div>
                        <input v-model="dataFormX['NamQuanTrac']"
                            class="bg-gray-200 text-gray-700 p-2 focus:cursor-text w-full border border-gray-200 focus:outline-none focus:bg-white focus:border-gray-400 rounded"
                            type="text" :placeholder="'N\u0103m quan tr\u1EAFc...'"
                        />
                    </div>
                    <div class="relative"><button @click="submitData" class=" w-full leading-none font-semibold bg-blue-700 text-white rounded px-4 py-2 focus:outline-none absolute" tabindex="-1" style="height: 32px;bottom: 1px;"> Th\xEAm k\u1EBFt qu\u1EA3 quan tr\u1EAFc </button></div>
                </div>
            </template>
        </vuejx-screen>
        <template v-if="renderTable">
            <vuejx-table-simple-khcn class="mt-4" :noHeader="true" :pagesize="15" :db="db" :collection="collection"
                :condition="condition" :table_config="table_config">
            </vuejx-table-simple-khcn>
        </template>
    </div>`},dotize={valTypes:{none:"NONE",primitive:"PRIM",object:"OBJECT",array:"ARRAY"},getValType:function(e){if((!e||typeof e!="object")&&!Array.isArray(e))return dotize.valTypes.primitive;if(Array.isArray(e))return dotize.valTypes.array;if(typeof e=="object")return dotize.valTypes.object},getPathType:function(e){var t=[];for(var r in e){var a=e[r];a?dotize.isNumber(a)?t.push(dotize.valTypes.array):t.push(dotize.valTypes.object):t.push(dotize.valTypes.none)}return t},isUndefined:function(e){return typeof e=="undefined"},isNumber:function(e){return!isNaN(parseInt(e))},isEmptyObj:function(e){for(var t in e)if(Object.hasOwnProperty.call(e,t))return!1;return JSON.stringify(e)===JSON.stringify({})},isNotObject:function(e){return!e||typeof e!="object"},isEmptyArray:function(e){return Array.isArray(e)&&e.length==0},isNotArray:function(e){return Array.isArray(e)==!1},removeEmptyArrayItem:function(e){return e.filter(function(t){return t!=null&&t!=""})},getFieldName:function(e,t,r,a,n){return n?(t||"")+(dotize.isNumber(e)?"["+e+"]":(r&&!t?"":".")+e):a?(t||"")+"["+e+"]":(t?t+".":"")+e},startsWith:function(e,t){return e.indexOf(t)==0},clearAudit:function(e,t){return!!(t.endsWith("_index")||t.endsWith("_score")||t.endsWith("_source")||t.endsWith("_type")||t.endsWith("_doc")||t.endsWith("sort"))},convert:function(e,t,r){var a={};return dotize.isNotObject(e)&&dotize.isNotArray(e)?t?(a[t]=e,a):e:function n(l,f,s){var h=Array.isArray(l),p="";for(var d in l){var y=l[d];if(y&&typeof y=="object"&&!Array.isArray(y)){if(Array.isArray(y))if(dotize.isEmptyArray(y)){const g=dotize.getFieldName(d,f,s,!1,!0);a[g]=y,dotize.clearAudit(a,g)&&(p=g),delete a[p]}else{const g=dotize.getFieldName(d,f,s,!1,!0);a=n(y,g,h),dotize.clearAudit(a,g)&&(p=g),delete a[p]}else if(h&&dotize.isEmptyObj(y)==!1){const g=dotize.getFieldName(d,f,s,!0);a=n(y,g),dotize.clearAudit(a,g)&&(p=g),delete a[p]}else if(dotize.isEmptyObj(y)==!1){const g=dotize.getFieldName(d,f,s);if(r?r&&(y=window.Vue.pickBy(y)):a[dotize.getFieldName(d,f,s)]=y,a=n(y,g),typeof y=="object"){let k={};k[g]=y,a=he(he({},a),k)}dotize.clearAudit(a,g)&&(p=g),delete a[p]}else if(dotize.isEmptyObj(y)){const g=dotize.getFieldName(d,f,s,h);a[g]=y,dotize.clearAudit(a,g)&&(p=g),delete a[p]}}else if(h||dotize.isNumber(d)){const g=dotize.getFieldName(d,f,s,!0);a[g]=y,dotize.clearAudit(a,g)&&(p=g),delete a[p]}else if(r){if(y){const g=dotize.getFieldName(d,f,s);a[g]=y,dotize.clearAudit(a,g)&&(p=g),delete a[p]}}else{const g=dotize.getFieldName(d,f,s);a[g]=y,dotize.clearAudit(a,g)&&(p=g),delete a[p]}}return delete a._index,delete a._score,delete a._type,delete a[p],a}(e,t,!0)},sortObjectKeys:function(e){return Object.keys(e).sort().reduce((t,r)=>(t[r]=e[r],t),{})},backward:function(e,t){var r={},a=/\[(\d+)\]/g;if(dotize.isNotObject(e)&&dotize.isNotArray(e))return t?e[t]:e;e=dotize.sortObjectKeys(e);for(var n in e){var l=e[n];if(t){var f=new RegExp("^"+t);n=n.replace(f,"")}n=n.replace(a,".$1"),dotize.startsWith(n,".")&&(n=n.replace(/^\./,""));var s=n.split("."),h=dotize.getPathType(s);!dotize.isUndefined(h)&&h[0]==dotize.valTypes.array&&Array.isArray(r)==!1&&(r=[]),function p(d,y,g,k){var A=s.shift(),M=h.shift();if(typeof A=="undefined"||A==""){r=d;return}var N=M==dotize.valTypes.array;if(dotize.isNumber(A)&&(A=parseInt(A)),s.length>0){typeof y[A]=="undefined"&&(N?y[A]=[]:y[A]={}),p(d,y[A],A,y);return}M==dotize.valTypes.array&&g&&k?(Array.isArray(k[g])==!1&&(k[g]=[]),k[g].push(d)):y[A]=d}(l,r)}return r}},dotize$1={dotize};window.decompressSync=decompressSync,window.strToU8=strToU8,window.strFromU8=strFromU8,window.compressSync=gzipSync,window.saveToIndexedDB=saveToIndexedDB,window.sleep=sleep,window.dotize=dotize$1,window.VueJX={initPagePull:async function(e,t){return await initPage(e,t)},pageURL:function(){let e=window.location.hash.split("/");return window.location.hash.indexOf("?")!=-1&&(e=window.location.hash.substring(0,window.location.hash.indexOf("?")).split("/")),e},page:function(){let e=window.VueJX.pageURL(),t="";return Array.isArray(e)&&e.length>0&&e[e.length-1]&&(t=e[e.length-1]),t},search:async function(e,t,r,a,n,l,f,s,h,p,d,y,g){return await search(e,t,r,a,n,l,f,s,h,p,d,y)},aggs:async function(e,t,r,a,n,l,f,s,h,p,d,y,g,k,A,M,N,S){return await aggsData(e,t,r,a,n,l,f,s,h,p,d,y,g,k,A,M,N,S)},dispatch:async function(e,t){let r=null,a=t.variables,n=t.query;return e==="vuejx_manager/graphqlQuery"?(a.token=localStorage.getItem("token"),a.db=localStorage.getItem("db"),r=await graphqlQuery(n,a)):e==="vuejx_manager/userById"?r=await userById(t):e==="vuejx_manager/userUpdateMany"?r=await userUpdateMany(t):e==="vuejx_manager/userOne"?r=await userOne(t):e==="vuejx_manager/userCreate"||e==="vuejx_manager/userUpdateById"?r=await processData(t):e==="vuejx_manager/xlsxtemplate"?r=await xlsxtemplate(t):e==="vuejx_manager/topdf"?r=await htmlToPdf(t):e==="vuejx_manager/docxtemplate"&&(r=await docxtemplate(t)),r}},window.worker&&worker.addEventListener("message",e=>{e.data.id==="appversion"?localStorage.setItem("appversion",e.data.appversion):saveToIndexedDB("screens",e.data)});const buildSite=async data=>{do console.log("waiting instant"),await sleep(50);while(!window.Vue);if(data.guestHeaderConfig&&data.guestHeaderConfig.length>50){let vueSiteGuest=eval("( "+data.guestHeaderConfig+" )");vueSiteGuest&&(vueSiteGuest.props={siteCss:{type:String,default:'<style type="text/css">'+data.cssConfig+"</style>"}},vueSiteGuest.template='<div v-html="siteCss"></div> '+vueSiteGuest.template,window.Vue.component(data.shortName+"___web_header",vueSiteGuest))}if(data.groupHeaderConfig&&data.groupHeaderConfig.length>50){let vueSiteGroup=eval("( "+data.groupHeaderConfig+" )");vueSiteGroup&&(vueSiteGroup.props={siteCss:{type:String,default:'<style type="text/css">'+data.cssConfig+"</style>"}},vueSiteGroup.template='<div v-html="siteCss"></div> '+vueSiteGroup.template,window.Vue.component(data.shortName+"___group_header",vueSiteGroup))}if(data.guestFooterConfig&&data.guestFooterConfig.length>50){let guestFooterConfig=eval("( "+data.guestFooterConfig+" )");window.Vue.component(data.shortName+"___web_footer",guestFooterConfig)}if(data.groupFooterConfig&&data.groupFooterConfig.length>50){let groupFooterConfig=eval("( "+data.groupFooterConfig+" )");window.Vue.component(data.shortName+"___group_footer",groupFooterConfig)}},buildPage=async data=>{do console.log("waiting instant"),await sleep(50);while(!window.Vue);let vueForm=eval("( "+data.pageConfig+" )");if(vueForm&&(vueForm.props={siteCss:{type:String,default:'<style type="text/css">'+data.cssConfig+"</style>"}},vueForm.template=vueForm.template+' <div v-html="siteCss"></div> ',window.Vue.component(data.shortName,vueForm)),data.pageFooterConfig&&data.pageFooterConfig.length>50){let vueFormHeader=eval("( "+data.pageHeaderConfig+" )");window.Vue.component(data.shortName+"___header",vueFormHeader)}if(data.pageFooterConfig&&data.pageFooterConfig.length>50){let vueFormFooter=eval("( "+data.pageFooterConfig+" )");window.Vue.component(data.shortName+"___footer",vueFormFooter)}},initPage=async(e,t)=>{let r=[],a=localStorage.getItem("site");do console.log("waiting instant"),a=localStorage.getItem("site"),await sleep(50);while(!a);let n="web",l=window.location.hash.split("/");window.location.hash.indexOf("?")!=-1&&(l=window.location.hash.substring(0,window.location.hash.indexOf("?")).split("/")),Array.isArray(l)&&l.length>=3&&(l[1]=="group"||l[1]=="web")?n=l[1]:e&&(n=e);let f={size:1e3,sort:[{_score:"desc"},{order:"asc"}],_source:{includes:["shortName","title","hiddenNav","isSub","pageParent","hidden","targetURL","targetMode","activePage","accessRoles","order"]},script_fields:{pageView:{script:{source:"if (doc['shortName'] == ['"+t+"']) { doc['dataApp'] } else { '' }"}}},query:{bool:{filter:{match:{siteParent:a}},must:{bool:{should:[{match:{visibility:n}},{match:{visibility:"both"}},{match:{visibility:"login"}}]}}}}};t?f.query.bool.must.bool.should.push({match:{shortName:{query:t,boost:10}}}):delete f.script_fields;let s={size:1,_source:{includes:["shortName","app_view","dataApp","webGroupData","webNavData"]},query:{bool:{filter:{match:{shortName:localStorage.getItem("site")}}}}};var h=new Headers;h.append("Content-Type","application/json;charset=UTF-8"),h.append("Accept","application/json, text/plain, */*");var p={method:"POST",headers:h,body:JSON.stringify({query:`
                query search($token: String, $bodyPage: JSON, $bodySite: JSON) {
                    pages: search(token: $token, body: $bodyPage, db: "`+localStorage.getItem("db")+`", collection: "vuejx_page"),
                    sites: search(token: $token, body: $bodySite, db: "`+localStorage.getItem("db")+`", collection: "vuejx_site")
                }
            `,variables:{token:localStorage.getItem("token"),bodyPage:f,bodySite:s}}),redirect:"follow"};let d="",y="";if(await fetch("/vuejx/",p).then(g=>g.json()).then(async g=>{const k=g.data;if(Array.isArray(k.sites.hits.hits)&&k.sites.hits.hits.length>0){const A=JSON.parse(k.sites.hits.hits[0]._source.webNavData);Array.isArray(A)&&A.length>0&&(d=Object.values(A[0])[0].shortName,await saveToIndexedDB("screens",{page:A,id:"webNav"}));const M=JSON.parse(k.sites.hits.hits[0]._source.webGroupData);Array.isArray(M)&&M.length>0&&(y=Object.values(M[0])[0].shortName,await saveToIndexedDB("screens",{page:M,id:"groupNav"})),await saveToIndexedDB("screens",{page:k.sites.hits.hits[0]._source.dataApp,app_view:k.sites.hits.hits[0]._source.app_view,id:k.sites.hits.hits[0]._source.shortName+"___site"}),await initBuildSite()}Array.isArray(k.pages.hits.hits)&&k.pages.hits.hits.length>0&&k.pages.hits.hits[0].fields&&k.pages.hits.hits[0].fields.pageView[0]&&(await saveToIndexedDB("screens",{page:k.pages.hits.hits[0].fields.pageView[0],id:k.pages.hits.hits[0]._source.shortName}),console.log("pagepagepage",t),await initBuildPage(t,0))}).catch(g=>{console.log("error",g)}),Array.isArray(l)&&l.length==3&&(l[1]=="group"||l[1]=="web")){let g="";l[1]=="group"?g="/group/"+localStorage.getItem("site")+"/"+y:l[1]=="web"&&(g="/web/"+localStorage.getItem("site")+"/"+d),window.Vue.redirect(null,!0,g,!0)}return r};window.initPage=async function(e){return await initPage(e)};let index=0,indexSite=0;async function initBuildPage(e,t){return new Promise(async function(r,a){t++,await window.db.collection("screens").doc(e).get().then(async n=>{if(n){const l=window.decompressSync(window.strToU8(n.page,!0));let f=JSON.parse(window.strFromU8(l));f.shortName=e,await buildPage(f),t=9999}else await sleep(50),t<100&&await initBuildPage(e,t)}).catch(n=>{}),r(t)})}async function initBuildSite(){indexSite++,await window.db.collection("screens").doc(localStorage.getItem("site")+"___site").get().then(async e=>{if(e){const t=window.decompressSync(window.strToU8(e.page,!0));let r=JSON.parse(window.strFromU8(t));r.shortName=localStorage.getItem("site")+"___site",buildSite(r)}else await sleep(50),indexSite<100&&initBuildSite()})}async function startUI(){window.Vue?(window.Vue.doneInit=!1,window.Vue.initBuild={page:async function(e,t){return await initBuildPage(e,t)},initPageProcess:async function(e,t){return await initPage(e,t)}},window.Vue.decompressSync=decompressSync,window.Vue.compressSync=gzipSync,window.Vue.strToU8=strToU8,window.Vue.strFromU8=strFromU8,window.Vue.router.currentRoute.value.params.page,window.Vue.router.currentRoute.value.params.visibility==="login",window.Vue.$root={$store:{dispatch:async function(e,t){let r=null,a=t.variables,n=t.query;return e==="vuejx_manager/graphqlQuery"?(a.token=localStorage.getItem("token"),a.db=localStorage.getItem("db"),r=await graphqlQuery(n,a)):e==="vuejx_manager/userById"?r=await userById(t):e==="vuejx_manager/userUpdateMany"?r=await userUpdateMany(t):e==="vuejx_manager/userOne"?r=await userOne(t):e==="vuejx_manager/userCreate"||e==="vuejx_manager/userUpdateById"?r=await processData(t):e==="vuejx_manager/xlsxtemplate"?r=await xlsxtemplate(t):e==="vuejx_manager/topdf"?r=await htmlToPdf(t):e==="vuejx_manager/docxtemplate"&&(r=await docxtemplate(t)),r}},dispatch:async function(e,t){let r=null,a=t.variables,n=t.query;return e==="vuejx_manager/graphqlQuery"?(a.token=localStorage.getItem("token"),a.db=localStorage.getItem("db"),r=await graphqlQuery(n,a)):e==="vuejx_manager/userById"?r=await userById(t):e==="vuejx_manager/userUpdateMany"?r=await userUpdateMany(t):e==="vuejx_manager/userOne"?r=await userOne(t):e==="vuejx_manager/userCreate"||e==="vuejx_manager/userUpdateById"?r=await processData(t):e==="vuejx_manager/xlsxtemplate"?r=await xlsxtemplate(t):e==="vuejx_manager/topdf"?r=await htmlToPdf(t):e==="vuejx_manager/docxtemplate"&&(r=await docxtemplate(t)),r}},window.Vue.component("vuejx-header",VueJXHeader),window.Vue.component("vuejx-header-simple",VueJXHeaderSimple),window.Vue.component("vuejx-footer",{template:`
                <footer class="absolute_footer">
                    <slot name="footer"></slot>
                </footer>
            `}),window.Vue.component("v-layout",{template:`
            <div class="flex flex-wrap">
                <slot></slot>
            </div>
            `}),window.Vue.component("v-form",{template:"<div><slot></slot></div>"}),window.Vue.component("v-sheet",{template:"<div><slot></slot></div>"}),window.Vue.component("v-subheader",{template:'<div class="block font-semibold leading-normal truncate"><slot></slot></div>'}),window.Vue.component("v-flex",{props:{sm1:{type:Boolean,default:()=>!1},sm2:{type:Boolean,default:()=>!1},sm3:{type:Boolean,default:()=>!1},sm4:{type:Boolean,default:()=>!1},sm5:{type:Boolean,default:()=>!1},sm6:{type:Boolean,default:()=>!1},sm7:{type:Boolean,default:()=>!1},sm8:{type:Boolean,default:()=>!1},sm9:{type:Boolean,default:()=>!1},sm10:{type:Boolean,default:()=>!1},sm11:{type:Boolean,default:()=>!1},sm12:{type:Boolean,default:()=>!1},xs1:{type:Boolean,default:()=>!1},xs2:{type:Boolean,default:()=>!1},xs3:{type:Boolean,default:()=>!1},xs4:{type:Boolean,default:()=>!1},xs5:{type:Boolean,default:()=>!1},xs6:{type:Boolean,default:()=>!1},xs7:{type:Boolean,default:()=>!1},xs8:{type:Boolean,default:()=>!1},xs9:{type:Boolean,default:()=>!1},xs10:{type:Boolean,default:()=>!1},xs11:{type:Boolean,default:()=>!1},xs12:{type:Boolean,default:()=>!1}},template:`
            <div :class="{'xs1': xs1, 'xs2': xs2, 'xs3': xs3, 'xs4': xs4, 'xs5': xs5, 'xs6': xs6, 'xs7': xs7, 'xs8': xs8, 'xs9': xs9, 'xs10': xs10, 'xs11': xs11, 'xs12': xs12, 'sm1': sm1, 'sm2': sm2, 'sm3': sm3, 'sm4': sm4, 'sm5': sm5, 'sm6': sm6, 'sm7': sm7, 'sm8': sm8, 'sm9': sm9, 'sm10': sm10, 'sm11': sm11, 'sm12': sm12 }">
                <slot></slot>
            </div>
            `}),window.Vue.component("vuejx-table-simple",Table),window.Vue.component("vuejx-table-simple-khcn",tableSimpleKhcn),window.Vue.component("vuejx-table-simple-khcn-guest",tableSimpleKhcn),window.Vue.component("vuejx-view-khcn",tableViewKhcn),window.Vue.component("vuejx-table-pagging",tableSimplePagging),window.Vue.component("vuejx-table-simple-khcn-top",tableSimpleTop),window.Vue.component("vuejx-menu-aggs",VueJXMenuAggs),window.Vue.component("vuejx-menu-aggs-view",VueJXMenuAggsView),window.Vue.component("vuejx-sub-menu",VueJXSubMenu),window.Vue.component("qlvt-filter",QLVTFilter),window.Vue.component("vuejx-autocomplete",VuejxCombobox),window.Vue.component("vuejx-data-report",VuejxDataReport),window.Vue.component("vuejx-date-combobox",VuejxDateCBX),window.Vue.component("vuejx-upload",VuejxUpload),window.Vue.component("vuejx-upload-2",VuejxUpload2),window.Vue.component("vn-data-cms",VuejxCMS),window.Vue.component("vuejx-screen",VuejxScreen),window.Vue.component("vuejx-done",VuejxDone),window.Vue.component("mt-quan-trac",MTQuanTrac),window.Vue.initVueData=async function(e,t,r){let a=window.Vue.router.currentRoute.value.query,n=[];for(const l in r)typeof r[l]=="object"?(n.push(l),e[l]=r[l]):a.hasOwnProperty(r[l])&&(e[l]=a[r[l]],n.push(l));for(const l in t)n.indexOf(l)==-1&&(e[l]=t[l]);e.db=localStorage.getItem("db"),e.site=localStorage.getItem("site"),e.renderPage=!0},window.Vue.redirect_page=async function(e,t){let r=window.Vue.router.currentRoute.value.query;if(t.length>0){let a=[];for(const n in r)t.indexOf(n)==-1&&n!="_t"&&n!="t"?a.push({key:n,value:r[n]}):a.push({key:n,value:""});window.Vue.redirect(a,!0,e)}},window.Vue.redirect=async function(e,t,r,a,n,l,f){let s=window.location.hash;window.location.hash&&window.location.hash.indexOf("?")!=-1&&(s=window.location.hash.substring(window.location.hash.indexOf("?")+1));let h="";if(window.location.hash.startsWith("#/")){const[g,k]=window.location.hash.split("?");h=g}else h=window.location.pathname;r!==""&&r!==void 0&&r!==null&&(h=r);let p={},d=window.Vue.router.currentRoute.value.query;for(const g in d)if(Array.isArray(d[g])){n=!0;break}if(n)p=d;else{let g=/[?&]([^=#]+)=([^&#]*)/g,k={};for(;k=g.exec("&"+s);)p[k[1]]=decodeURIComponent(k[2])}if(l)if(h&&h.indexOf("?")!==-1){let g=/[?&]([^=#]+)=([^&#]*)/g,k={},A={};for(;k=g.exec("&"+h.substring(h.indexOf("?")+1));)A[k[1]]=decodeURIComponent(k[2]);h=h.substring(0,h.indexOf("?")+1);for(let M in A)M!=="t"&&M!=="_filter"&&(p[M]=A[M])}else h+="?";else h+="?";a&&(p={}),f&&(p=f),e==null&&(e=[]);let y={};if(n){let g={},k={};for(let A=e.length-1;A>=0;A--)Array.isArray(e[A].value)?g.hasOwnProperty(e[A].key)?e.splice(A,1):g[e[A].key]=e[A].value:(k.hasOwnProperty(e[A].key)||(k[e[A].key]=[]),k[e[A].key].push(e[A].value),g.hasOwnProperty(e[A].key)?g[e[A].key]&&Array.isArray(g[e[A].key])&&g[e[A].key].indexOf(e[A].value)>=0&&e.splice(A,1):g.hasOwnProperty(e[A].key+"___"+e[A].value)?e.splice(A,1):g[e[A].key+"___"+e[A].value]=e[A].value);for(const A of e)if(A.key!=="t"&&A.value!==""&&A.value!==void 0&&A.value!==null)if(y[A.key]=1,Array.isArray(A.value))for(let M of A.value)k[A.key]&&k[A.key].indexOf(M)>=0&&(h+=A.key+"="+M+"&");else h+=A.key+"="+A.value+"&";else A.value===""&&(p[A.key]="",y[A.key]=1)}else for(const g of e)Array.isArray(d[g.key])?p[g.key]=d[g.key]:p[g.key]=g.value;delete p.undefined,delete p.null;for(let g in p)if(g!=="t"&&p[g]!==""&&p[g]!==void 0&&p[g]!==null&&!y.hasOwnProperty(g))if(Array.isArray(p[g]))for(let k of p[g])h+=g+"="+k+"&";else h+=g+"="+p[g]+"&";h=h.replace(/&$/,"").replace(/\?$/,""),t&&(h&&h.indexOf("?")>0?h+="&t="+new Date().getTime():h+="?t="+new Date().getTime()),window.Vue.router.push(h.replace(/#/,""))},window.Vue.toastr={success:function(e){document.getElementById("toastr___success")&&document.getElementById("toastr___success").classList.contains("hidden")&&(document.getElementById("toastr___success").classList.remove("hidden"),setTimeout(()=>{document.getElementById("toastr___success").classList.add("hidden")},2e3))},error:function(e){document.getElementById("toastr___error")&&document.getElementById("toastr___error").classList.contains("hidden")&&(document.getElementById("toastr___error").classList.remove("hidden"),setTimeout(()=>{document.getElementById("toastr___error").classList.add("hidden")},2e3))}},window.Vue.dateViewYear=function(item,key,defaultVal){try{const data=item,datetime=eval("data."+key);return datetime!=null&&String(datetime)!=="0"?new Date(parseInt(datetime)).getFullYear():defaultVal}catch(e){return defaultVal!=null?defaultVal:""}},window.Vue.dateViewMonthYear=function(item,key,defaultVal){try{const data=item,datetime=eval("data."+key);return datetime!=null&&String(datetime)!=="0"?new Date(parseInt(datetime)).getMonth()+1+"/"+new Date(parseInt(datetime)).getFullYear():defaultVal}catch(e){return defaultVal!=null?defaultVal:""}},window.Vue.dateView=function(item,key,defaultVal,dateFormat){try{const data=item,datetime=eval("data."+key);if(String(datetime)!=="0"&&datetime!==void 0&&datetime!==null){if((dateFormat==null||dateFormat==="")&&(dateFormat="vi-VN"),new Date(parseInt(datetime))=="Invalid Date")return defaultVal;{let e=new Date(parseInt(datetime)),t=e.getMonth()+1;return(e.getDate()<10?"0"+e.getDate():e.getDate())+"/"+(t<10?"0"+t:t)+"/"+e.getFullYear()}}else return defaultVal}catch(e){return defaultVal!=null?defaultVal:""}},window.Vue.objectView=function(item,key,defaultVal){try{const data=item,result=eval("data."+key);return result==null?"":String(result).replace(/\n/g,"<br/>")}catch(e){return defaultVal!=null?defaultVal:""}},window.Vue.doneInit=!0):(index++,await sleep(50),index<200&&await startUI())}startUI()});
